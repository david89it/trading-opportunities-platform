var _h=Object.defineProperty;var wh=(s,t,e)=>t in s?_h(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var T=(s,t,e)=>wh(s,typeof t!="symbol"?t+"":t,e);import{j as u,u as Fs,a as Sh,Q as kh,b as Mh}from"./query-BKOrCa5C.js";import{a as Ph,r as R,b as Os}from"./vendor-Gm9i_4Ku.js";import{L as Wt,u as Ch,a as jh,R as Rh,b as Ve,B as zh}from"./router-BoStund0.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();var vs={},sn=Ph;vs.createRoot=sn.createRoot,vs.hydrateRoot=sn.hydrateRoot;const Vi=[{id:"fd0e6c4e-1b53-49c5-8b1b-c1abfa97e5a7",symbol:"SQ",timestamp:"2025-08-04T12:15:07.046838Z",signal_score:9.9,scores:{price:9.8,volume:10,volatility:10,overall:9.9},setup:{entry:78.96,stop:73.03,target1:101.46,target2:112.71,position_size_usd:631.68,position_size_shares:8,rr_ratio:3.79},risk:{p_target:.746,net_expected_r:2.475,costs_r:.102,slippage_bps:14.1},features:{rvol:2.39,atr_pct:5.7,vwap_distance:1.236,ema_20_slope:-.078,volume_20d_avg:49814512,regime:"trending",earnings_days:44},guardrail_status:"review",guardrail_reason:"High volatility",version:"1.0.0"},{id:"a1b2c3d4-5e6f-7890-abcd-ef1234567890",symbol:"AAPL",timestamp:"2025-08-04T12:10:00.000Z",signal_score:8.5,scores:{price:8.2,volume:8.8,volatility:8.5,overall:8.5},setup:{entry:185.5,stop:180,target1:195,target2:205,position_size_usd:1100,position_size_shares:6,rr_ratio:1.73},risk:{p_target:.65,net_expected_r:.45,costs_r:.08,slippage_bps:12},features:{rvol:1.8,atr_pct:3.2,vwap_distance:.8,ema_20_slope:.045,volume_20d_avg:58e6,regime:"consolidating",earnings_days:21},guardrail_status:"approved",version:"1.0.0"},{id:"xyz789-abc123-def456-ghi789",symbol:"TSLA",timestamp:"2025-08-04T12:05:00.000Z",signal_score:7.2,scores:{price:7,volume:7.5,volatility:7.1,overall:7.2},setup:{entry:245,stop:235,target1:265,target2:280,position_size_usd:800,position_size_shares:3,rr_ratio:2},risk:{p_target:.55,net_expected_r:.25,costs_r:.12,slippage_bps:18},features:{rvol:2.1,atr_pct:4.8,vwap_distance:-.5,ema_20_slope:-.025,volume_20d_avg:92e6,regime:"volatile",earnings_days:35},guardrail_status:"blocked",guardrail_reason:"Earnings approaching",version:"1.0.0"}],Ye={getOpportunities:async s=>{await new Promise(r=>setTimeout(r,500));let t=[...Vi];s!=null&&s.min_score&&(t=t.filter(r=>r.signal_score>=s.min_score)),s!=null&&s.status&&(t=t.filter(r=>r.guardrail_status===s.status));const e=(s==null?void 0:s.offset)||0,i=(s==null?void 0:s.limit)||50;return{opportunities:t.slice(e,e+i),total:t.length,limit:i,offset:e,timestamp:new Date().toISOString()}},getOpportunity:async s=>{await new Promise(e=>setTimeout(e,300));const t=Vi.find(e=>e.symbol===s);if(!t)throw new Error(`Opportunity not found for symbol: ${s}`);return t},scanPreview:async s=>{await new Promise(n=>setTimeout(n,800));let t=[...Vi];s!=null&&s.min_score&&(t=t.filter(n=>n.signal_score>=s.min_score));const e=(s==null?void 0:s.limit)||10;return{opportunities:t.slice(0,e),total:t.length,limit:e,offset:0,timestamp:new Date().toISOString()}},getHealth:async()=>({status:"healthy",timestamp:new Date().toISOString()})},xi={getOpportunities:async s=>Ye.getOpportunities(s),getOpportunity:async s=>Ye.getOpportunity(s),scanPreview:async s=>Ye.scanPreview(s),getHealth:async()=>Ye.getHealth()};async function Dh(){return xi.getOpportunities()}async function Th(s){return xi.getOpportunity(s)}function uo({opportunities:s}){const t=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(o),e=(o,h=2)=>`${(o*100).toFixed(h)}%`,i=(o,h=2)=>`${o>=0?"+":""}${o.toFixed(h)}R`,n=(o,h)=>{const a={approved:{backgroundColor:"var(--color-success)",color:"white"},review:{backgroundColor:"var(--color-warning)",color:"black"},blocked:{backgroundColor:"var(--color-danger)",color:"white"}},l=a[o]||a.approved;return u.jsx("span",{style:{padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"bold",...l},title:h,children:o.toUpperCase()})},r=(o,h=10)=>{const a=o/h*100,l=o>=8?"var(--color-success)":o>=6?"var(--color-warning)":"var(--color-danger)";return u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("div",{style:{width:"60px",height:"8px",backgroundColor:"var(--color-border)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${a}%`,height:"100%",backgroundColor:l,transition:"width 0.3s ease"}})}),u.jsx("span",{style:{fontSize:"0.8rem",minWidth:"3rem"},children:o.toFixed(1)})]})};return u.jsx("div",{style:{backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)",overflow:"hidden"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"var(--color-background)"},children:[u.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid var(--color-border)"},children:"Symbol"}),u.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid var(--color-border)"},children:"Signal Score"}),u.jsx("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:"Entry / Stop / Target"}),u.jsx("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:"R:R Ratio"}),u.jsx("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:"P(Target)"}),u.jsx("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:"Net Exp. R"}),u.jsx("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:"Position Size"}),u.jsx("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:"Status"}),u.jsx("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:"Actions"})]})}),u.jsx("tbody",{children:s.map(o=>u.jsxs("tr",{style:{borderBottom:"1px solid var(--color-border)",transition:"background-color 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="var(--color-background)"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor="transparent"},children:[u.jsx("td",{style:{padding:"1rem"},children:u.jsxs("div",{children:[u.jsx("strong",{style:{fontSize:"1.1rem",color:"var(--color-primary)"},children:o.symbol}),u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-muted)"},children:new Date(o.timestamp).toLocaleTimeString()})]})}),u.jsx("td",{style:{padding:"1rem"},children:r(o.signal_score)}),u.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:u.jsxs("div",{style:{fontSize:"0.9rem"},children:[u.jsx("div",{children:t(o.setup.entry)}),u.jsx("div",{style:{color:"var(--color-danger)"},children:t(o.setup.stop)}),u.jsx("div",{style:{color:"var(--color-success)"},children:t(o.setup.target1)}),o.setup.target2&&u.jsx("div",{style:{color:"var(--color-success)",opacity:.7},children:t(o.setup.target2)})]})}),u.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:u.jsxs("span",{style:{fontSize:"1.1rem",fontWeight:"bold",color:o.setup.rr_ratio>=3?"var(--color-success)":"var(--color-warning)"},children:[o.setup.rr_ratio.toFixed(1),":1"]})}),u.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:u.jsx("span",{style:{fontSize:"0.9rem"},children:e(o.risk.p_target)})}),u.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:u.jsx("span",{style:{fontSize:"0.9rem",fontWeight:"bold",color:o.risk.net_expected_r>0?"var(--color-success)":"var(--color-danger)"},children:i(o.risk.net_expected_r)})}),u.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:u.jsxs("div",{style:{fontSize:"0.9rem"},children:[u.jsx("div",{children:t(o.setup.position_size_usd)}),u.jsxs("div",{style:{color:"var(--color-text-muted)",fontSize:"0.8rem"},children:[o.setup.position_size_shares," shares"]})]})}),u.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:n(o.guardrail_status,o.guardrail_reason)}),u.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:u.jsx(Wt,{to:`/opportunity/${o.symbol}`,style:{padding:"0.5rem 1rem",backgroundColor:"var(--color-primary)",color:"white",textDecoration:"none",borderRadius:"4px",fontSize:"0.9rem",transition:"background-color 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="var(--color-secondary)"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor="var(--color-primary)"},children:"View Details"})})]},o.id))})]})})}const zi=({size:s=40,color:t="var(--color-primary)",message:e})=>u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"1rem"},children:[u.jsx("div",{style:{width:`${s}px`,height:`${s}px`,border:"3px solid var(--color-border)",borderTop:`3px solid ${t}`,borderRadius:"50%",animation:"spin 1s linear infinite"}}),e&&u.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"0.9rem",margin:0},children:e}),u.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]});function Di({message:s,details:t,onRetry:e}){return u.jsxs("div",{style:{padding:"2rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-danger)",borderRadius:"8px",textAlign:"center",maxWidth:"500px",margin:"0 auto"},children:[u.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"⚠️"}),u.jsx("h3",{style:{color:"var(--color-danger)",margin:"0 0 1rem 0"},children:s}),t&&u.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"0.9rem",margin:"0 0 1.5rem 0",lineHeight:1.5},children:t}),e&&u.jsx("button",{onClick:e,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--color-primary)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"1rem",transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--color-secondary)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor="var(--color-primary)"},children:"Try Again"})]})}function Eh(){const{data:s,isLoading:t,error:e,refetch:i}=Fs({queryKey:["opportunities"],queryFn:()=>Dh(),refetchInterval:3e4});return t?u.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[u.jsx(zi,{}),u.jsx("p",{children:"Loading trading opportunities..."})]}):e?u.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:u.jsx(Di,{message:"Failed to load trading opportunities",onRetry:()=>i()})}):u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"2rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[u.jsx("h1",{style:{margin:0,color:"var(--color-text-primary)"},children:"Trading Opportunities"}),u.jsx("button",{onClick:()=>i(),style:{padding:"0.5rem 1rem"},children:"🔄 Refresh"})]}),u.jsxs("div",{style:{display:"flex",gap:"2rem",color:"var(--color-text-secondary)"},children:[u.jsxs("div",{children:[u.jsx("strong",{children:(s==null?void 0:s.total)||0})," opportunities found"]}),u.jsxs("div",{children:["Last updated: ",new Date().toLocaleTimeString()]})]})]}),s&&s.opportunities.length>0?u.jsx(uo,{opportunities:s.opportunities}):u.jsxs("div",{style:{textAlign:"center",padding:"3rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h3",{style:{color:"var(--color-text-secondary)"},children:"No opportunities found"}),u.jsxs("p",{style:{color:"var(--color-text-muted)"},children:["The scanner hasn't identified any trading opportunities that meet the current criteria.",u.jsx("br",{}),"Market conditions may not be favorable, or all signals may be filtered by risk management rules."]}),u.jsx("button",{onClick:()=>i(),style:{marginTop:"1rem"},children:"Check Again"})]}),s&&s.opportunities.length>0&&u.jsxs("div",{style:{marginTop:"2rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-secondary)"},children:"Avg Signal Score"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--color-info)"},children:(s.opportunities.reduce((n,r)=>n+r.signal_score,0)/s.opportunities.length).toFixed(1)})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-secondary)"},children:"Avg R:R Ratio"}),u.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--color-success)"},children:[(s.opportunities.reduce((n,r)=>n+r.setup.rr_ratio,0)/s.opportunities.length).toFixed(1),":1"]})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-secondary)"},children:"Blocked Signals"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--color-danger)"},children:s.opportunities.filter(n=>n.guardrail_status==="blocked").length})]})]})]})}function Lh(){const{symbol:s}=Ch(),{data:t,isLoading:e,error:i,refetch:n}=Fs({queryKey:["opportunity",s],queryFn:()=>Th(s),enabled:!!s});if(e)return u.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[u.jsx(zi,{}),u.jsx("p",{children:"Loading opportunity details..."})]});if(i||!t)return u.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[u.jsx(Di,{message:`Failed to load opportunity for ${s}`,onRetry:()=>n()}),u.jsx(Wt,{to:"/",style:{display:"inline-block",marginTop:"1rem",padding:"0.5rem 1rem",backgroundColor:"var(--color-secondary)",color:"white",textDecoration:"none",borderRadius:"4px"},children:"← Back to Dashboard"})]});const r=h=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(h),o=h=>`${(h*100).toFixed(2)}%`;return u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"2rem"},children:[u.jsx(Wt,{to:"/",style:{color:"var(--color-primary)",textDecoration:"none",marginBottom:"1rem",display:"inline-block"},children:"← Back to Dashboard"}),u.jsxs("h1",{style:{margin:0,color:"var(--color-text-primary)"},children:[t.symbol," - Trading Opportunity"]}),u.jsxs("p",{style:{color:"var(--color-text-muted)",margin:"0.5rem 0"},children:["Signal generated: ",new Date(t.timestamp).toLocaleString()]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"2rem"},children:[u.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h2",{style:{margin:"0 0 1rem 0",color:"var(--color-text-primary)"},children:"Trade Setup"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Entry Price:"}),u.jsx("strong",{children:r(t.setup.entry)})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Stop Loss:"}),u.jsx("strong",{style:{color:"var(--color-danger)"},children:r(t.setup.stop)})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Target 1:"}),u.jsx("strong",{style:{color:"var(--color-success)"},children:r(t.setup.target1)})]}),t.setup.target2&&u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Target 2:"}),u.jsx("strong",{style:{color:"var(--color-success)"},children:r(t.setup.target2)})]}),u.jsx("hr",{style:{border:"none",borderTop:"1px solid var(--color-border)"}}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Risk/Reward:"}),u.jsxs("strong",{style:{color:"var(--color-info)"},children:[t.setup.rr_ratio.toFixed(1),":1"]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Position Size:"}),u.jsxs("div",{style:{textAlign:"right"},children:[u.jsx("div",{children:u.jsx("strong",{children:r(t.setup.position_size_usd)})}),u.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--color-text-muted)"},children:[t.setup.position_size_shares," shares"]})]})]})]})]}),u.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h2",{style:{margin:"0 0 1rem 0",color:"var(--color-text-primary)"},children:"Risk Metrics"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"P(Target):"}),u.jsx("strong",{children:o(t.risk.p_target)})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Net Expected R:"}),u.jsxs("strong",{style:{color:t.risk.net_expected_r>0?"var(--color-success)":"var(--color-danger)"},children:[t.risk.net_expected_r>0?"+":"",t.risk.net_expected_r.toFixed(3),"R"]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Costs (R):"}),u.jsxs("span",{children:[t.risk.costs_r.toFixed(3),"R"]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{children:"Slippage:"}),u.jsxs("span",{children:[t.risk.slippage_bps.toFixed(1)," bps"]})]})]})]})]}),u.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)",marginBottom:"2rem"},children:[u.jsx("h2",{style:{margin:"0 0 1rem 0",color:"var(--color-text-primary)"},children:"Signal Scores"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:["Overall Score: ",u.jsxs("strong",{children:[t.signal_score.toFixed(1),"/100"]})]}),u.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"var(--color-border)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${t.signal_score}%`,height:"100%",backgroundColor:"var(--color-info)"}})})]}),u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:["Price Score: ",u.jsxs("strong",{children:[t.scores.price.toFixed(1),"/100"]})]}),u.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"var(--color-border)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${t.scores.price}%`,height:"100%",backgroundColor:"var(--color-primary)"}})})]}),u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:["Volume Score: ",u.jsxs("strong",{children:[t.scores.volume.toFixed(1),"/100"]})]}),u.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"var(--color-border)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${t.scores.volume}%`,height:"100%",backgroundColor:"var(--color-success)"}})})]}),u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:["Volatility Score: ",u.jsxs("strong",{children:[t.scores.volatility.toFixed(1),"/100"]})]}),u.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"var(--color-border)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${t.scores.volatility}%`,height:"100%",backgroundColor:"var(--color-warning)"}})})]})]})]}),u.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h2",{style:{margin:"0 0 1rem 0",color:"var(--color-text-primary)"},children:"Status"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[u.jsx("span",{style:{padding:"0.5rem 1rem",borderRadius:"4px",fontWeight:"bold",backgroundColor:t.guardrail_status==="approved"?"var(--color-success)":t.guardrail_status==="review"?"var(--color-warning)":"var(--color-danger)",color:t.guardrail_status==="review"?"black":"white"},children:t.guardrail_status.toUpperCase()}),t.guardrail_reason&&u.jsx("span",{style:{color:"var(--color-text-muted)"},children:t.guardrail_reason})]})]})]})}const Fh=({label:s,value:t,min:e,max:i,step:n,onChange:r,formatValue:o,description:h,disabled:a=!1})=>{const l=d=>{r(parseFloat(d.target.value))},c=(t-e)/(i-e)*100;return u.jsxs("div",{style:{marginBottom:"1.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[u.jsx("label",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"var(--color-text-primary)"},children:s}),u.jsx("span",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"var(--color-primary)",minWidth:"4rem",textAlign:"right"},children:o(t)})]}),u.jsxs("div",{style:{position:"relative",marginBottom:"0.25rem"},children:[u.jsx("input",{type:"range",min:e,max:i,step:n,value:t,onChange:l,disabled:a,style:{width:"100%",height:"8px",background:`linear-gradient(to right, 
              var(--color-primary) 0%,
              var(--color-primary) ${c}%,
              var(--color-border) ${c}%,
              var(--color-border) 100%)`,borderRadius:"4px",outline:"none",border:"none",cursor:a?"not-allowed":"pointer",opacity:a?.5:1,WebkitAppearance:"none"}}),u.jsx("style",{children:`
          input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-primary);
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            cursor: ${a?"not-allowed":"pointer"};
          }
          
          input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-primary);
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            cursor: ${a?"not-allowed":"pointer"};
          }
          
          input[type="range"]:disabled::-webkit-slider-thumb {
            background: var(--color-text-muted);
          }
          
          input[type="range"]:disabled::-moz-range-thumb {
            background: var(--color-text-muted);
          }
        `})]}),h&&u.jsx("p",{style:{fontSize:"0.75rem",color:"var(--color-text-muted)",margin:0,lineHeight:1.3},children:h})]})};function O(s){var t=s.width,e=s.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function Yt(s,t){return s.width===t.width&&s.height===t.height}var Oh=function(){function s(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return s.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(s.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),s.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(n){return n!==i})}}},s.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},s.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},s.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},s.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},s}();function Ah(s){return new Oh(s)}var Nh=function(){function s(t,e,i){var n;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=O({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??function(r){return r},this._allowResizeObserver=(n=i==null?void 0:i.allowResizeObserver)!==null&&n!==void 0?n:!0,this._chooseAndInitObserver()}return s.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(s.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"bitmapSize",{get:function(){return O({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),s.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=O(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},s.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},s.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(s.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),s.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},s.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},s.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},s.prototype._resizeBitmap=function(t){var e=this.bitmapSize;Yt(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},s.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(n){return n.call(i,t,e)})},s.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=O(this._transformBitmapSize(t,this._canvasElementClientSize)),n=Yt(this.bitmapSize,i)?null:i;e===null&&n===null||e!==null&&n!==null&&Yt(e,n)||(this._suggestedBitmapSize=n,this._emitSuggestedBitmapSizeChanged(e,n))},s.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(n){return n.call(i,t,e)})},s.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}Ih().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},s.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=nn(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=Ah(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},s.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var i=nn(this._canvasElement);if(i!==null){var n=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:i.devicePixelRatio,r=this._canvasElement.getClientRects(),o=r[0]!==void 0?Wh(r[0],n):O({width:this._canvasElementClientSize.width*n,height:this._canvasElementClientSize.height*n});this._suggestNewBitmapSize(o)}}},s.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(o){return o.target===t._canvasElement});if(!(!i||!i.devicePixelContentBoxSize||!i.devicePixelContentBoxSize[0])){var n=i.devicePixelContentBoxSize[0],r=O({width:n.inlineSize,height:n.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},s}();function Bh(s,t){return new Nh(s,t.transform,t.options)}function nn(s){return s.ownerDocument.defaultView}function Ih(){return new Promise(function(s){var t=new ResizeObserver(function(e){s(e.every(function(i){return"devicePixelContentBoxSize"in i})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function Wh(s,t){return O({width:Math.round(s.left*t+s.width*t)-Math.round(s.left*t),height:Math.round(s.top*t+s.height*t)-Math.round(s.top*t)})}var Vh=function(){function s(t,e,i){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,i.width===0||i.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return s.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},s.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(s.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),s}();function Ht(s,t){var e=s.canvasElementClientSize;if(e.width===0||e.height===0)return null;var i=s.bitmapSize;if(i.width===0||i.height===0)return null;var n=s.canvasElement.getContext("2d",t);return n===null?null:new Vh(n,e,i)}/*!
 * @license
 * TradingView Lightweight Charts™ v5.0.8
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const fo={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var rn,on;function se(s,t){const e={0:[],1:[s.lineWidth,s.lineWidth],2:[2*s.lineWidth,2*s.lineWidth],3:[6*s.lineWidth,6*s.lineWidth],4:[s.lineWidth,4*s.lineWidth]}[t];s.setLineDash(e)}function go(s,t,e,i){s.beginPath();const n=s.lineWidth%2?.5:0;s.moveTo(e,t+n),s.lineTo(i,t+n),s.stroke()}function U(s,t){if(!s)throw new Error("Assertion failed"+(t?": "+t:""))}function tt(s){if(s===void 0)throw new Error("Value is undefined");return s}function _(s){if(s===null)throw new Error("Value is null");return s}function Mt(s){return _(tt(s))}(function(s){s[s.Simple=0]="Simple",s[s.WithSteps=1]="WithSteps",s[s.Curved=2]="Curved"})(rn||(rn={})),function(s){s[s.Solid=0]="Solid",s[s.Dotted=1]="Dotted",s[s.Dashed=2]="Dashed",s[s.LargeDashed=3]="LargeDashed",s[s.SparseDotted=4]="SparseDotted"}(on||(on={}));class W{constructor(){this.t=[]}i(t,e,i){const n={h:t,l:e,o:i===!0};this.t.push(n)}_(t){const e=this.t.findIndex(i=>t===i.h);e>-1&&this.t.splice(e,1)}u(t){this.t=this.t.filter(e=>e.l!==t)}p(t,e,i){const n=[...this.t];this.t=this.t.filter(r=>!r.o),n.forEach(r=>r.h(t,e,i))}v(){return this.t.length>0}m(){this.t=[]}}function it(s,...t){for(const e of t)for(const i in e)e[i]!==void 0&&Object.prototype.hasOwnProperty.call(e,i)&&!["__proto__","constructor","prototype"].includes(i)&&(typeof e[i]!="object"||s[i]===void 0||Array.isArray(e[i])?s[i]=e[i]:it(s[i],e[i]));return s}function ne(s){return typeof s=="number"&&isFinite(s)}function Ee(s){return typeof s=="number"&&s%1==0}function Be(s){return typeof s=="string"}function $e(s){return typeof s=="boolean"}function vt(s){const t=s;if(!t||typeof t!="object")return t;let e,i,n;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(n=t[i],e[i]=n&&typeof n=="object"?vt(n):n);return e}function Yh(s){return s!==null}function ys(s){return s===null?void 0:s}const po="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function bi(s,t,e){return t===void 0&&(t=po),`${e=e!==void 0?`${e} `:""}${s}px ${t}`}class $h{constructor(t){this.M={S:1,C:5,P:NaN,k:"",T:"",R:"",D:"",V:0,I:0,B:0,A:0,L:0},this.O=t}N(){const t=this.M,e=this.F(),i=this.W();return t.P===e&&t.T===i||(t.P=e,t.T=i,t.k=bi(e,i),t.A=2.5/12*e,t.V=t.A,t.I=e/12*t.C,t.B=e/12*t.C,t.L=0),t.R=this.H(),t.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}F(){return this.O.N().layout.fontSize}W(){return this.O.N().layout.fontFamily}}function Yi(s){return s<0?0:s>255?255:Math.round(s)||0}function hn(s){return .199*s[0]+.687*s[1]+.114*s[2]}class Hh{constructor(t,e){this.q=new Map,this.Y=t,e&&(this.q=e)}j(t,e){if(t==="transparent")return t;const i=this.K(t),n=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${e*n})`}X(t){const e=this.K(t);return{Z:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,G:hn(e)>160?"black":"white"}}J(t){return hn(this.K(t))}tt(t,e,i){const[n,r,o,h]=this.K(t),[a,l,c,d]=this.K(e),f=[Yi(n+i*(a-n)),Yi(r+i*(l-r)),Yi(o+i*(c-o)),(g=h+i*(d-h),g<=0||g>1?Math.min(Math.max(g,0),1):Math.round(1e4*g)/1e4)];var g;return`rgba(${f[0]}, ${f[1]}, ${f[2]}, ${f[3]})`}K(t){const e=this.q.get(t);if(e)return e;const i=function(o){const h=document.createElement("div");h.style.display="none",document.body.appendChild(h),h.style.color=o;const a=window.getComputedStyle(h).color;return document.body.removeChild(h),a}(t),n=i.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!n){if(this.Y.length)for(const o of this.Y){const h=o(t);if(h)return this.q.set(t,h),h}throw new Error(`Failed to parse color: ${t}`)}const r=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return this.q.set(t,r),r}}class qh{constructor(){this.it=[]}st(t){this.it=t}nt(t,e,i){this.it.forEach(n=>{n.nt(t,e,i)})}}class le{nt(t,e,i){t.useBitmapCoordinateSpace(n=>this.et(n,e,i))}}class Uh extends le{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.rt===null||this.rt.lt===null)return;const n=this.rt.lt,r=this.rt,o=Math.max(1,Math.floor(e))%2/2,h=a=>{t.beginPath();for(let l=n.to-1;l>=n.from;--l){const c=r.ot[l],d=Math.round(c._t*e)+o,f=c.ut*i,g=a*i+o;t.moveTo(d,f),t.arc(d,f,g,0,2*Math.PI)}t.fill()};r.ct>0&&(t.fillStyle=r.dt,h(r.ft+r.ct)),t.fillStyle=r.vt,h(r.ft)}}function Xh(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}const Qh={from:0,to:1};class Kh{constructor(t,e,i){this.Mt=new qh,this.bt=[],this.St=[],this.xt=!0,this.O=t,this.Ct=e,this.Pt=i,this.Mt.st(this.bt)}kt(t){this.yt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}yt(){const t=this.Pt.Dt();t.length!==this.bt.length&&(this.St=t.map(Xh),this.bt=this.St.map(e=>{const i=new Uh;return i.ht(e),i}),this.Mt.st(this.bt))}Rt(){const t=this.Ct.N().mode===2||!this.Ct.Vt(),e=this.Pt.It(),i=this.Ct.Bt(),n=this.O.Et();this.yt(),e.forEach((r,o)=>{const h=this.St[o],a=r.At(i),l=r.zt();!t&&a!==null&&r.Vt()&&l!==null?(h.vt=a.Lt,h.ft=a.ft,h.ct=a.Ot,h.ot[0].gt=a.gt,h.ot[0].ut=r.Ft().Nt(a.gt,l.Wt),h.dt=a.Ht??this.O.Ut(h.ot[0].ut/r.Ft().$t()),h.ot[0].wt=i,h.ot[0]._t=n.qt(i),h.lt=Qh):h.lt=null})}}class Gh extends le{constructor(t){super(),this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Yt===null)return;const r=this.Yt.jt.Vt,o=this.Yt.Kt.Vt;if(!r&&!o)return;const h=Math.round(this.Yt._t*i),a=Math.round(this.Yt.ut*n);t.lineCap="butt",r&&h>=0&&(t.lineWidth=Math.floor(this.Yt.jt.ct*i),t.strokeStyle=this.Yt.jt.R,t.fillStyle=this.Yt.jt.R,se(t,this.Yt.jt.Xt),function(l,c,d,f){l.beginPath();const g=l.lineWidth%2?.5:0;l.moveTo(c+g,d),l.lineTo(c+g,f),l.stroke()}(t,h,0,e.height)),o&&a>=0&&(t.lineWidth=Math.floor(this.Yt.Kt.ct*n),t.strokeStyle=this.Yt.Kt.R,t.fillStyle=this.Yt.Kt.R,se(t,this.Yt.Kt.Xt),go(t,a,0,e.width))}}class Zh{constructor(t,e){this.xt=!0,this.Zt={jt:{ct:1,Xt:0,R:"",Vt:!1},Kt:{ct:1,Xt:0,R:"",Vt:!1},_t:0,ut:0},this.Gt=new Gh(this.Zt),this.Jt=t,this.Pt=e}kt(){this.xt=!0}Tt(t){return this.xt&&(this.Rt(),this.xt=!1),this.Gt}Rt(){const t=this.Jt.Vt(),e=this.Pt.Qt().N().crosshair,i=this.Zt;if(e.mode===2)return i.Kt.Vt=!1,void(i.jt.Vt=!1);i.Kt.Vt=t&&this.Jt.ti(this.Pt),i.jt.Vt=t&&this.Jt.ii(),i.Kt.ct=e.horzLine.width,i.Kt.Xt=e.horzLine.style,i.Kt.R=e.horzLine.color,i.jt.ct=e.vertLine.width,i.jt.Xt=e.vertLine.style,i.jt.R=e.vertLine.color,i._t=this.Jt.si(),i.ut=this.Jt.ni()}}function Ti(s,t,e,i,n,r){s.save(),s.globalCompositeOperation="copy",s.fillStyle=r,s.fillRect(t,e,i,n),s.restore()}function an(s,t,e,i,n,r){s.beginPath(),s.roundRect?s.roundRect(t,e,i,n,r):(s.lineTo(t+i-r[1],e),r[1]!==0&&s.arcTo(t+i,e,t+i,e+r[1],r[1]),s.lineTo(t+i,e+n-r[2]),r[2]!==0&&s.arcTo(t+i,e+n,t+i-r[2],e+n,r[2]),s.lineTo(t+r[3],e+n),r[3]!==0&&s.arcTo(t,e+n,t,e+n-r[3],r[3]),s.lineTo(t,e+r[0]),r[0]!==0&&s.arcTo(t,e,t+r[0],e,r[0]))}function ln(s,t,e,i,n,r,o=0,h=[0,0,0,0],a=""){if(s.save(),!o||!a||a===r)return an(s,t,e,i,n,h),s.fillStyle=r,s.fill(),void s.restore();const l=o/2;var c;an(s,t+l,e+l,i-o,n-o,(c=-l,h.map(d=>d===0?d:d+c))),r!=="transparent"&&(s.fillStyle=r,s.fill()),a!=="transparent"&&(s.lineWidth=o,s.strokeStyle=a,s.closePath(),s.stroke()),s.restore()}function mo(s,t,e,i,n,r,o){s.save(),s.globalCompositeOperation="copy";const h=s.createLinearGradient(0,0,0,n);h.addColorStop(0,r),h.addColorStop(1,o),s.fillStyle=h,s.fillRect(t,e,i,n),s.restore()}class cn{constructor(t,e){this.ht(t,e)}ht(t,e){this.Yt=t,this.ei=e}$t(t,e){return this.Yt.Vt?t.P+t.A+t.V:0}nt(t,e,i,n){if(!this.Yt.Vt||this.Yt.ri.length===0)return;const r=this.Yt.R,o=this.ei.Z,h=t.useBitmapCoordinateSpace(a=>{const l=a.context;l.font=e.k;const c=this.hi(a,e,i,n),d=c.ai;return c.li?ln(l,d.oi,d._i,d.ui,d.ci,o,d.di,[d.ft,0,0,d.ft],o):ln(l,d.fi,d._i,d.ui,d.ci,o,d.di,[0,d.ft,d.ft,0],o),this.Yt.pi&&(l.fillStyle=r,l.fillRect(d.fi,d.mi,d.wi-d.fi,d.gi)),this.Yt.Mi&&(l.fillStyle=e.D,l.fillRect(c.li?d.bi-d.di:0,d._i,d.di,d.Si-d._i)),c});t.useMediaCoordinateSpace(({context:a})=>{const l=h.xi;a.font=e.k,a.textAlign=h.li?"right":"left",a.textBaseline="middle",a.fillStyle=r,a.fillText(this.Yt.ri,l.Ci,(l._i+l.Si)/2+l.Pi)})}hi(t,e,i,n){const{context:r,bitmapSize:o,mediaSize:h,horizontalPixelRatio:a,verticalPixelRatio:l}=t,c=this.Yt.pi||!this.Yt.ki?e.C:0,d=this.Yt.yi?e.S:0,f=e.A+this.ei.Ti,g=e.V+this.ei.Ri,p=e.I,m=e.B,x=this.Yt.ri,b=e.P,v=i.Di(r,x),y=Math.ceil(i.Vi(r,x)),w=b+f+g,S=e.S+p+m+y+c,P=Math.max(1,Math.floor(l));let M=Math.round(w*l);M%2!=P%2&&(M+=1);const k=d>0?Math.max(1,Math.floor(d*a)):0,C=Math.round(S*a),z=Math.round(c*a),j=this.ei.Ii??this.ei.Bi,D=Math.round(j*l)-Math.floor(.5*l),$=Math.floor(D+P/2-M/2),et=$+M,N=n==="right",V=N?h.width-d:d,H=N?o.width-k:k;let _t,wt,ct;return N?(_t=H-C,wt=H-z,ct=V-c-p-d):(_t=H+C,wt=H+z,ct=V+c+p),{li:N,ai:{_i:$,mi:D,Si:et,ui:C,ci:M,ft:2*a,di:k,oi:_t,fi:H,wi:wt,gi:P,bi:o.width},xi:{_i:$/l,Si:et/l,Ci:ct,Pi:v}}}}class Ei{constructor(t){this.Ei={Bi:0,Z:"#000",Ri:0,Ti:0},this.Ai={ri:"",Vt:!1,pi:!0,ki:!1,Ht:"",R:"#FFF",Mi:!1,yi:!1},this.zi={ri:"",Vt:!1,pi:!1,ki:!0,Ht:"",R:"#FFF",Mi:!0,yi:!0},this.xt=!0,this.Li=new(t||cn)(this.Ai,this.Ei),this.Oi=new(t||cn)(this.zi,this.Ei)}ri(){return this.Ni(),this.Ai.ri}Bi(){return this.Ni(),this.Ei.Bi}kt(){this.xt=!0}$t(t,e=!1){return Math.max(this.Li.$t(t,e),this.Oi.$t(t,e))}Fi(){return this.Ei.Ii||0}Wi(t){this.Ei.Ii=t}Hi(){return this.Ni(),this.Ai.Vt||this.zi.Vt}Ui(){return this.Ni(),this.Ai.Vt}Tt(t){return this.Ni(),this.Ai.pi=this.Ai.pi&&t.N().ticksVisible,this.zi.pi=this.zi.pi&&t.N().ticksVisible,this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Li}$i(){return this.Ni(),this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Oi}Ni(){this.xt&&(this.Ai.pi=!0,this.zi.pi=!1,this.qi(this.Ai,this.zi,this.Ei))}}class Jh extends Ei{constructor(t,e,i){super(),this.Jt=t,this.Yi=e,this.ji=i}qi(t,e,i){if(t.Vt=!1,this.Jt.N().mode===2)return;const n=this.Jt.N().horzLine;if(!n.labelVisible)return;const r=this.Yi.zt();if(!this.Jt.Vt()||this.Yi.Ki()||r===null)return;const o=this.Yi.Xi().X(n.labelBackgroundColor);i.Z=o.Z,t.R=o.G;const h=2/12*this.Yi.P();i.Ti=h,i.Ri=h;const a=this.ji(this.Yi);i.Bi=a.Bi,t.ri=this.Yi.Zi(a.gt,r),t.Vt=!0}}const ta=/[1-9]/g;class xo{constructor(){this.Yt=null}ht(t){this.Yt=t}nt(t,e){if(this.Yt===null||this.Yt.Vt===!1||this.Yt.ri.length===0)return;const i=t.useMediaCoordinateSpace(({context:f})=>(f.font=e.k,Math.round(e.Gi.Vi(f,_(this.Yt).ri,ta))));if(i<=0)return;const n=e.Ji,r=i+2*n,o=r/2,h=this.Yt.Qi;let a=this.Yt.Bi,l=Math.floor(a-o)+.5;l<0?(a+=Math.abs(0-l),l=Math.floor(a-o)+.5):l+r>h&&(a-=Math.abs(h-(l+r)),l=Math.floor(a-o)+.5);const c=l+r,d=Math.ceil(0+e.S+e.C+e.A+e.P+e.V);t.useBitmapCoordinateSpace(({context:f,horizontalPixelRatio:g,verticalPixelRatio:p})=>{const m=_(this.Yt);f.fillStyle=m.Z;const x=Math.round(l*g),b=Math.round(0*p),v=Math.round(c*g),y=Math.round(d*p),w=Math.round(2*g);if(f.beginPath(),f.moveTo(x,b),f.lineTo(x,y-w),f.arcTo(x,y,x+w,y,w),f.lineTo(v-w,y),f.arcTo(v,y,v,y-w,w),f.lineTo(v,b),f.fill(),m.pi){const S=Math.round(m.Bi*g),P=b,M=Math.round((P+e.C)*p);f.fillStyle=m.R;const k=Math.max(1,Math.floor(g)),C=Math.floor(.5*g);f.fillRect(S-C,P,k,M-P)}}),t.useMediaCoordinateSpace(({context:f})=>{const g=_(this.Yt),p=0+e.S+e.C+e.A+e.P/2;f.font=e.k,f.textAlign="left",f.textBaseline="middle",f.fillStyle=g.R;const m=e.Gi.Di(f,"Apr0");f.translate(l+n,p+m),f.fillText(g.ri,0,0)})}}class ea{constructor(t,e,i){this.xt=!0,this.Gt=new xo,this.Zt={Vt:!1,Z:"#4c525e",R:"white",ri:"",Qi:0,Bi:NaN,pi:!0},this.Ct=t,this.ts=e,this.ji=i}kt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Gt.ht(this.Zt),this.Gt}Rt(){const t=this.Zt;if(t.Vt=!1,this.Ct.N().mode===2)return;const e=this.Ct.N().vertLine;if(!e.labelVisible)return;const i=this.ts.Et();if(i.Ki())return;t.Qi=i.Qi();const n=this.ji();if(n===null)return;t.Bi=n.Bi;const r=i.ss(this.Ct.Bt());t.ri=i.ns(_(r)),t.Vt=!0;const o=this.ts.Xi().X(e.labelBackgroundColor);t.Z=o.Z,t.R=o.G,t.pi=i.N().ticksVisible}}class bo{constructor(){this.es=null,this.rs=0}hs(){return this.rs}ls(t){this.rs=t}Ft(){return this.es}_s(t){this.es=t}us(t){return[]}cs(){return[]}Vt(){return!0}}var dn;(function(s){s[s.Normal=0]="Normal",s[s.Magnet=1]="Magnet",s[s.Hidden=2]="Hidden",s[s.MagnetOHLC=3]="MagnetOHLC"})(dn||(dn={}));class ia extends bo{constructor(t,e){super(),this.Pt=null,this.ds=NaN,this.fs=0,this.ps=!1,this.vs=new Map,this.ws=!1,this.gs=new WeakMap,this.Ms=new WeakMap,this.bs=NaN,this.Ss=NaN,this.xs=NaN,this.Cs=NaN,this.ts=t,this.Ps=e,this.ks=((n,r)=>o=>{const h=r(),a=n();if(o===_(this.Pt).ys())return{gt:a,Bi:h};{const l=_(o.zt());return{gt:o.Ts(h,l),Bi:h}}})(()=>this.ds,()=>this.Ss);const i=((n,r)=>()=>{const o=this.ts.Et().Rs(n()),h=r();return o&&Number.isFinite(h)?{wt:o,Bi:h}:null})(()=>this.fs,()=>this.si());this.Ds=new ea(this,t,i)}N(){return this.Ps}Vs(t,e){this.xs=t,this.Cs=e}Is(){this.xs=NaN,this.Cs=NaN}Bs(){return this.xs}Es(){return this.Cs}As(t,e,i){this.ws||(this.ws=!0),this.ps=!0,this.zs(t,e,i)}Bt(){return this.fs}si(){return this.bs}ni(){return this.Ss}Vt(){return this.ps}Ls(){this.ps=!1,this.Os(),this.ds=NaN,this.bs=NaN,this.Ss=NaN,this.Pt=null,this.Is(),this.Ns()}Fs(t){let e=this.gs.get(t);e||(e=new Zh(this,t),this.gs.set(t,e));let i=this.Ms.get(t);return i||(i=new Kh(this.ts,this,t),this.Ms.set(t,i)),[e,i]}ti(t){return t===this.Pt&&this.Ps.horzLine.visible}ii(){return this.Ps.vertLine.visible}Ws(t,e){this.ps&&this.Pt===t||this.vs.clear();const i=[];return this.Pt===t&&i.push(this.Hs(this.vs,e,this.ks)),i}cs(){return this.ps?[this.Ds]:[]}Us(){return this.Pt}Ns(){this.ts.$s().forEach(t=>{var e,i;(e=this.gs.get(t))==null||e.kt(),(i=this.Ms.get(t))==null||i.kt()}),this.vs.forEach(t=>t.kt()),this.Ds.kt()}qs(t){return t&&!t.ys().Ki()?t.ys():null}zs(t,e,i){this.Ys(t,e,i)&&this.Ns()}Ys(t,e,i){const n=this.bs,r=this.Ss,o=this.ds,h=this.fs,a=this.Pt,l=this.qs(i);this.fs=t,this.bs=isNaN(t)?NaN:this.ts.Et().qt(t),this.Pt=i;const c=l!==null?l.zt():null;return l!==null&&c!==null?(this.ds=e,this.Ss=l.Nt(e,c)):(this.ds=NaN,this.Ss=NaN),n!==this.bs||r!==this.Ss||h!==this.fs||o!==this.ds||a!==this.Pt}Os(){const t=this.ts.js().map(i=>i.Xs().Ks()).filter(Yh),e=t.length===0?null:Math.max(...t);this.fs=e!==null?e:NaN}Hs(t,e,i){let n=t.get(e);return n===void 0&&(n=new Jh(this,e,i),t.set(e,n)),n}}function Li(s){return s==="left"||s==="right"}class q{constructor(t){this.Zs=new Map,this.Gs=[],this.Js=t}Qs(t,e){const i=function(n,r){return n===void 0?r:{tn:Math.max(n.tn,r.tn),sn:n.sn||r.sn}}(this.Zs.get(t),e);this.Zs.set(t,i)}nn(){return this.Js}en(t){const e=this.Zs.get(t);return e===void 0?{tn:this.Js}:{tn:Math.max(this.Js,e.tn),sn:e.sn}}rn(){this.hn(),this.Gs=[{an:0}]}ln(t){this.hn(),this.Gs=[{an:1,Wt:t}]}_n(t){this.un(),this.Gs.push({an:5,Wt:t})}hn(){this.un(),this.Gs.push({an:6})}cn(){this.hn(),this.Gs=[{an:4}]}dn(t){this.hn(),this.Gs.push({an:2,Wt:t})}fn(t){this.hn(),this.Gs.push({an:3,Wt:t})}pn(){return this.Gs}vn(t){for(const e of t.Gs)this.mn(e);this.Js=Math.max(this.Js,t.Js),t.Zs.forEach((e,i)=>{this.Qs(i,e)})}static wn(){return new q(2)}static gn(){return new q(3)}mn(t){switch(t.an){case 0:this.rn();break;case 1:this.ln(t.Wt);break;case 2:this.dn(t.Wt);break;case 3:this.fn(t.Wt);break;case 4:this.cn();break;case 5:this._n(t.Wt);break;case 6:this.un()}}un(){const t=this.Gs.findIndex(e=>e.an===5);t!==-1&&this.Gs.splice(t,1)}}class vo{formatTickmarks(t){return t.map(e=>this.format(e))}}const un=".";function yt(s,t){if(!ne(s))return"n/a";if(!Ee(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?s.toString():("0000000000000000"+s.toString()).slice(-t)}class Fi extends vo{constructor(t,e){if(super(),e||(e=1),ne(t)&&Ee(t)||(t=100),t<0)throw new TypeError("invalid base");this.Yi=t,this.Mn=e,this.bn()}format(t){const e=t<0?"−":"";return t=Math.abs(t),e+this.Sn(t)}bn(){if(this.xn=0,this.Yi>0&&this.Mn>0){let t=this.Yi;for(;t>1;)t/=10,this.xn++}}Sn(t){const e=this.Yi/this.Mn;let i=Math.floor(t),n="";const r=this.xn!==void 0?this.xn:NaN;if(e>1){let o=+(Math.round(t*e)-i*e).toFixed(this.xn);o>=e&&(o-=e,i+=1),n=un+yt(+o.toFixed(this.xn)*this.Mn,r)}else i=Math.round(i*e)/e,r>0&&(n=un+yt(0,r));return i.toFixed(0)+n}}class yo extends Fi{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class sa extends vo{constructor(t){super(),this.Cn=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.Pn(t):t<999995?e+this.Pn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.Pn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.Pn(t/1e9)+"B")}Pn(t){let e;const i=Math.pow(10,this.Cn);return e=(t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.Cn).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,(n,r)=>r)}}const na=/[2-9]/g;class vi{constructor(t=50){this.kn=0,this.yn=1,this.Tn=1,this.Rn={},this.Dn=new Map,this.Vn=t}In(){this.kn=0,this.Dn.clear(),this.yn=1,this.Tn=1,this.Rn={}}Vi(t,e,i){return this.Bn(t,e,i).width}Di(t,e,i){const n=this.Bn(t,e,i);return((n.actualBoundingBoxAscent||0)-(n.actualBoundingBoxDescent||0))/2}Bn(t,e,i){const n=i||na,r=String(e).replace(n,"0");if(this.Dn.has(r))return tt(this.Dn.get(r)).En;if(this.kn===this.Vn){const h=this.Rn[this.Tn];delete this.Rn[this.Tn],this.Dn.delete(h),this.Tn++,this.kn--}t.save(),t.textBaseline="middle";const o=t.measureText(r);return t.restore(),o.width===0&&e.length||(this.Dn.set(r,{En:o,An:this.yn}),this.Rn[this.yn]=r,this.kn++,this.yn++),o}}class ra{constructor(t){this.zn=null,this.M=null,this.Ln="right",this.On=t}Nn(t,e,i){this.zn=t,this.M=e,this.Ln=i}nt(t){this.M!==null&&this.zn!==null&&this.zn.nt(t,this.M,this.On,this.Ln)}}class _o{constructor(t,e,i){this.Fn=t,this.On=new vi(50),this.Wn=e,this.O=i,this.F=-1,this.Gt=new ra(this.On)}Tt(){const t=this.O.Hn(this.Wn);if(t===null)return null;const e=t.Un(this.Wn)?t.$n():this.Wn.Ft();if(e===null)return null;const i=t.qn(e);if(i==="overlay")return null;const n=this.O.Yn();return n.P!==this.F&&(this.F=n.P,this.On.In()),this.Gt.Nn(this.Fn.$i(),n,i),this.Gt}}class oa extends le{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}jn(t,e){var o;if(!((o=this.Yt)!=null&&o.Vt))return null;const{ut:i,ct:n,Kn:r}=this.Yt;return e>=i-n-7&&e<=i+n+7?{Xn:this.Yt,Kn:r}:null}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Yt===null||this.Yt.Vt===!1)return;const r=Math.round(this.Yt.ut*n);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.Yt.R,t.lineWidth=Math.floor(this.Yt.ct*i),se(t,this.Yt.Xt),go(t,r,0,e.width))}}class As{constructor(t){this.Zn={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Xt:0,Vt:!1},this.Gn=new oa,this.xt=!0,this.Jn=t,this.Qn=t.Qt(),this.Gn.ht(this.Zn)}kt(){this.xt=!0}Tt(){return this.Jn.Vt()?(this.xt&&(this.te(),this.xt=!1),this.Gn):null}}class ha extends As{constructor(t){super(t)}te(){this.Zn.Vt=!1;const t=this.Jn.Ft(),e=t.ie().ie;if(e!==2&&e!==3)return;const i=this.Jn.N();if(!i.baseLineVisible||!this.Jn.Vt())return;const n=this.Jn.zt();n!==null&&(this.Zn.Vt=!0,this.Zn.ut=t.Nt(n.Wt,n.Wt),this.Zn.R=i.baseLineColor,this.Zn.ct=i.baseLineWidth,this.Zn.Xt=i.baseLineStyle)}}class aa extends le{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}se(){return this.Yt}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){const n=this.Yt;if(n===null)return;const r=Math.max(1,Math.floor(e)),o=r%2/2,h=Math.round(n.ne.x*e)+o,a=n.ne.y*i;t.fillStyle=n.ee,t.beginPath();const l=Math.max(2,1.5*n.re)*e;t.arc(h,a,l,0,2*Math.PI,!1),t.fill(),t.fillStyle=n.he,t.beginPath(),t.arc(h,a,n.ft*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=n.ae,t.beginPath(),t.arc(h,a,n.ft*e+r/2,0,2*Math.PI,!1),t.stroke()}}const la=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class ca{constructor(t){this.Gt=new aa,this.xt=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.ge=t}Me(){this.we=this.me-1,this.kt()}be(){if(this.kt(),this.ge.N().lastPriceAnimation===2){const t=performance.now(),e=this.we-t;if(e>0)return void(e<650&&(this.we+=2600));this.me=t,this.we=t+2600}}kt(){this.xt=!0}Se(){this.ve=!0}Vt(){return this.ge.N().lastPriceAnimation!==0}xe(){switch(this.ge.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.Gt}Rt(){this.Gt.ht(null);const t=this.ge.Qt().Et(),e=t.Pe(),i=this.ge.zt();if(e===null||i===null)return;const n=this.ge.ke(!0);if(n.ye||!e.Te(n.Re))return;const r={x:t.qt(n.Re),y:this.ge.Ft().Nt(n.gt,i.Wt)},o=n.R,h=this.ge.N().lineWidth,a=this.De(this.Ve(),o);this.Gt.ht({ee:o,re:h,he:a.he,ae:a.ae,ft:a.ft,ne:r})}Ce(){const t=this.Gt.se();if(t!==null){const e=this.De(this.Ve(),t.ee);t.he=e.he,t.ae=e.ae,t.ft=e.ft}}Ve(){return this.xe()?performance.now()-this.me:2599}Ie(t,e,i,n){const r=i+(n-i)*e;return this.ge.Qt().Xi().j(t,r)}De(t,e){const i=t%2600/2600;let n;for(const l of la)if(i>=l.le&&i<=l.oe){n=l;break}U(n!==void 0,"Last price animation internal logic error");const r=(i-n.le)/(n.oe-n.le);return{he:this.Ie(e,r,n.ce,n.de),ae:this.Ie(e,r,n.fe,n.pe),ft:(o=r,h=n._e,a=n.ue,h+(a-h)*o)};var o,h,a}}class da extends As{constructor(t){super(t)}te(){const t=this.Zn;t.Vt=!1;const e=this.Jn.N();if(!e.priceLineVisible||!this.Jn.Vt())return;const i=this.Jn.ke(e.priceLineSource===0);i.ye||(t.Vt=!0,t.ut=i.Bi,t.R=this.Jn.Be(i.R),t.ct=e.priceLineWidth,t.Xt=e.priceLineStyle)}}class ua extends Ei{constructor(t){super(),this.Jt=t}qi(t,e,i){t.Vt=!1,e.Vt=!1;const n=this.Jt;if(!n.Vt())return;const r=n.N(),o=r.lastValueVisible,h=n.Ee()!=="",a=r.seriesLastValueMode===0,l=n.ke(!1);if(l.ye)return;o&&(t.ri=this.Ae(l,o,a),t.Vt=t.ri.length!==0),(h||a)&&(e.ri=this.ze(l,o,h,a),e.Vt=e.ri.length>0);const c=n.Be(l.R),d=this.Jt.Qt().Xi().X(c);i.Z=d.Z,i.Bi=l.Bi,e.Ht=n.Qt().Ut(l.Bi/n.Ft().$t()),t.Ht=c,t.R=d.G,e.R=d.G}ze(t,e,i,n){let r="";const o=this.Jt.Ee();return i&&o.length!==0&&(r+=`${o} `),e&&n&&(r+=this.Jt.Ft().Le()?t.Oe:t.Ne),r.trim()}Ae(t,e,i){return e?i?this.Jt.Ft().Le()?t.Ne:t.Oe:t.ri:""}}function fn(s,t,e,i){const n=Number.isFinite(t),r=Number.isFinite(e);return n&&r?s(t,e):n||r?n?t:e:i}class G{constructor(t,e){this.Fe=t,this.We=e}He(t){return t!==null&&this.Fe===t.Fe&&this.We===t.We}Ue(){return new G(this.Fe,this.We)}$e(){return this.Fe}qe(){return this.We}Ye(){return this.We-this.Fe}Ki(){return this.We===this.Fe||Number.isNaN(this.We)||Number.isNaN(this.Fe)}vn(t){return t===null?this:new G(fn(Math.min,this.$e(),t.$e(),-1/0),fn(Math.max,this.qe(),t.qe(),1/0))}je(t){if(!ne(t)||this.We-this.Fe===0)return;const e=.5*(this.We+this.Fe);let i=this.We-e,n=this.Fe-e;i*=t,n*=t,this.We=e+i,this.Fe=e+n}Ke(t){ne(t)&&(this.We+=t,this.Fe+=t)}Xe(){return{minValue:this.Fe,maxValue:this.We}}static Ze(t){return t===null?null:new G(t.minValue,t.maxValue)}}class yi{constructor(t,e){this.Ge=t,this.Je=e||null}Qe(){return this.Ge}tr(){return this.Je}Xe(){return{priceRange:this.Ge===null?null:this.Ge.Xe(),margins:this.Je||void 0}}static Ze(t){return t===null?null:new yi(G.Ze(t.priceRange),t.margins)}}class fa extends As{constructor(t,e){super(t),this.ir=e}te(){const t=this.Zn;t.Vt=!1;const e=this.ir.N();if(!this.Jn.Vt()||!e.lineVisible)return;const i=this.ir.sr();i!==null&&(t.Vt=!0,t.ut=i,t.R=e.color,t.ct=e.lineWidth,t.Xt=e.lineStyle,t.Kn=this.ir.N().id)}}class ga extends Ei{constructor(t,e){super(),this.ge=t,this.ir=e}qi(t,e,i){t.Vt=!1,e.Vt=!1;const n=this.ir.N(),r=n.axisLabelVisible,o=n.title!=="",h=this.ge;if(!r||!h.Vt())return;const a=this.ir.sr();if(a===null)return;o&&(e.ri=n.title,e.Vt=!0),e.Ht=h.Qt().Ut(a/h.Ft().$t()),t.ri=this.nr(n.price),t.Vt=!0;const l=this.ge.Qt().Xi().X(n.axisLabelColor||n.color);i.Z=l.Z;const c=n.axisLabelTextColor||l.G;t.R=c,e.R=c,i.Bi=a}nr(t){const e=this.ge.zt();return e===null?"":this.ge.Ft().Zi(t,e.Wt)}}class pa{constructor(t,e){this.ge=t,this.Ps=e,this.er=new fa(t,this),this.Fn=new ga(t,this),this.rr=new _o(this.Fn,t,t.Qt())}hr(t){it(this.Ps,t),this.kt(),this.ge.Qt().ar()}N(){return this.Ps}lr(){return this.er}_r(){return this.rr}ur(){return this.Fn}kt(){this.er.kt(),this.Fn.kt()}sr(){const t=this.ge,e=t.Ft();if(t.Qt().Et().Ki()||e.Ki())return null;const i=t.zt();return i===null?null:e.Nt(this.Ps.price,i.Wt)}}class ma extends bo{constructor(t){super(),this.ts=t}Qt(){return this.ts}}const xa={Bar:(s,t,e,i)=>{const n=t.upColor,r=t.downColor,o=_(s(e,i)),h=Mt(o.Wt[0])<=Mt(o.Wt[3]);return{cr:o.R??(h?n:r)}},Candlestick:(s,t,e,i)=>{const n=t.upColor,r=t.downColor,o=t.borderUpColor,h=t.borderDownColor,a=t.wickUpColor,l=t.wickDownColor,c=_(s(e,i)),d=Mt(c.Wt[0])<=Mt(c.Wt[3]);return{cr:c.R??(d?n:r),dr:c.Ht??(d?o:h),pr:c.vr??(d?a:l)}},Custom:(s,t,e,i)=>({cr:_(s(e,i)).R??t.color}),Area:(s,t,e,i)=>{const n=_(s(e,i));return{cr:n.vt??t.lineColor,vt:n.vt??t.lineColor,mr:n.mr??t.topColor,wr:n.wr??t.bottomColor}},Baseline:(s,t,e,i)=>{const n=_(s(e,i));return{cr:n.Wt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,gr:n.gr??t.topLineColor,Mr:n.Mr??t.bottomLineColor,br:n.br??t.topFillColor1,Sr:n.Sr??t.topFillColor2,Cr:n.Cr??t.bottomFillColor1,Pr:n.Pr??t.bottomFillColor2}},Line:(s,t,e,i)=>{const n=_(s(e,i));return{cr:n.R??t.color,vt:n.R??t.color}},Histogram:(s,t,e,i)=>({cr:_(s(e,i)).R??t.color})};class ba{constructor(t){this.kr=(e,i)=>i!==void 0?i.Wt:this.ge.Xs().yr(e),this.ge=t,this.Tr=xa[t.Rr()]}Dr(t,e){return this.Tr(this.kr,this.ge.N(),t,e)}}function wo(s,t,e,i,n=0,r=t.length){let o=r-n;for(;0<o;){const h=o>>1,a=n+h;i(t[a],e)===s?(n=a+1,o-=h+1):o=h}return n}const re=wo.bind(null,!0),So=wo.bind(null,!1);var gn;(function(s){s[s.NearestLeft=-1]="NearestLeft",s[s.None=0]="None",s[s.NearestRight=1]="NearestRight"})(gn||(gn={}));const St=30;class va{constructor(){this.Vr=[],this.Ir=new Map,this.Br=new Map,this.Er=[]}Ar(){return this.zr()>0?this.Vr[this.Vr.length-1]:null}Lr(){return this.zr()>0?this.Or(0):null}Ks(){return this.zr()>0?this.Or(this.Vr.length-1):null}zr(){return this.Vr.length}Ki(){return this.zr()===0}Te(t){return this.Nr(t,0)!==null}yr(t){return this.Fr(t)}Fr(t,e=0){const i=this.Nr(t,e);return i===null?null:{...this.Wr(i),Re:this.Or(i)}}Hr(){return this.Vr}Ur(t,e,i){if(this.Ki())return null;let n=null;for(const r of i)n=He(n,this.$r(t,e,r));return n}ht(t){this.Br.clear(),this.Ir.clear(),this.Vr=t,this.Er=t.map(e=>e.Re)}qr(){return this.Er}Or(t){return this.Vr[t].Re}Wr(t){return this.Vr[t]}Nr(t,e){const i=this.Yr(t);if(i===null&&e!==0)switch(e){case-1:return this.jr(t);case 1:return this.Kr(t);default:throw new TypeError("Unknown search mode")}return i}jr(t){let e=this.Xr(t);return e>0&&(e-=1),e!==this.Vr.length&&this.Or(e)<t?e:null}Kr(t){const e=this.Zr(t);return e!==this.Vr.length&&t<this.Or(e)?e:null}Yr(t){const e=this.Xr(t);return e===this.Vr.length||t<this.Vr[e].Re?null:e}Xr(t){return re(this.Vr,t,(e,i)=>e.Re<i)}Zr(t){return So(this.Vr,t,(e,i)=>e.Re>i)}Gr(t,e,i){let n=null;for(let r=t;r<e;r++){const o=this.Vr[r].Wt[i];Number.isNaN(o)||(n===null?n={Jr:o,Qr:o}:(o<n.Jr&&(n.Jr=o),o>n.Qr&&(n.Qr=o)))}return n}$r(t,e,i){if(this.Ki())return null;let n=null;const r=_(this.Lr()),o=_(this.Ks()),h=Math.max(t,r),a=Math.min(e,o),l=Math.ceil(h/St)*St,c=Math.max(l,Math.floor(a/St)*St);{const f=this.Xr(h),g=this.Zr(Math.min(a,l,e));n=He(n,this.Gr(f,g,i))}let d=this.Ir.get(i);d===void 0&&(d=new Map,this.Ir.set(i,d));for(let f=Math.max(l+1,h);f<c;f+=St){const g=Math.floor(f/St);let p=d.get(g);if(p===void 0){const m=this.Xr(g*St),x=this.Zr((g+1)*St-1);p=this.Gr(m,x,i),d.set(g,p)}n=He(n,p)}{const f=this.Xr(c),g=this.Zr(a);n=He(n,this.Gr(f,g,i))}return n}}function He(s,t){return s===null?t:t===null?s:{Jr:Math.min(s.Jr,t.Jr),Qr:Math.max(s.Qr,t.Qr)}}class ya{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var n,r;(r=(n=this.th).drawBackground)==null||r.call(n,t)}}class _a{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new ya(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}class ko{constructor(t){this.hh=null,this.ah=t}oh(){return this.ah}Ns(){var t,e;(e=(t=this.ah).updateAllViews)==null||e.call(t)}Fs(){var i,n,r;const t=((n=(i=this.ah).paneViews)==null?void 0:n.call(i))??[];if(((r=this.hh)==null?void 0:r.nh)===t)return this.hh.eh;const e=t.map(o=>new _a(o));return this.hh={nh:t,eh:e},e}jn(t,e){var i,n;return((n=(i=this.ah).hitTest)==null?void 0:n.call(i,t,e))??null}}let wa=class extends ko{us(){return[]}};class Sa{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var n,r;(r=(n=this.th).drawBackground)==null||r.call(n,t)}}class pn{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new Sa(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}function Mo(s){var t,e,i;return{ri:s.text(),Bi:s.coordinate(),Ii:(t=s.fixedCoordinate)==null?void 0:t.call(s),R:s.textColor(),Z:s.backColor(),Vt:((e=s.visible)==null?void 0:e.call(s))??!0,pi:((i=s.tickVisible)==null?void 0:i.call(s))??!0}}class ka{constructor(t,e){this.Gt=new xo,this._h=t,this.uh=e}Tt(){return this.Gt.ht({Qi:this.uh.Qi(),...Mo(this._h)}),this.Gt}}class Ma extends Ei{constructor(t,e){super(),this._h=t,this.Yi=e}qi(t,e,i){const n=Mo(this._h);i.Z=n.Z,t.R=n.R;const r=2/12*this.Yi.P();i.Ti=r,i.Ri=r,i.Bi=n.Bi,i.Ii=n.Ii,t.ri=n.ri,t.Vt=n.Vt,t.pi=n.pi}}class Pa extends ko{constructor(t,e){super(t),this.dh=null,this.fh=null,this.ph=null,this.mh=null,this.ge=e}cs(){var n,r,o;const t=((r=(n=this.ah).timeAxisViews)==null?void 0:r.call(n))??[];if(((o=this.dh)==null?void 0:o.nh)===t)return this.dh.eh;const e=this.ge.Qt().Et(),i=t.map(h=>new ka(h,e));return this.dh={nh:t,eh:i},i}Ws(){var n,r,o;const t=((r=(n=this.ah).priceAxisViews)==null?void 0:r.call(n))??[];if(((o=this.fh)==null?void 0:o.nh)===t)return this.fh.eh;const e=this.ge.Ft(),i=t.map(h=>new Ma(h,e));return this.fh={nh:t,eh:i},i}wh(){var i,n,r;const t=((n=(i=this.ah).priceAxisPaneViews)==null?void 0:n.call(i))??[];if(((r=this.ph)==null?void 0:r.nh)===t)return this.ph.eh;const e=t.map(o=>new pn(o));return this.ph={nh:t,eh:e},e}gh(){var i,n,r;const t=((n=(i=this.ah).timeAxisPaneViews)==null?void 0:n.call(i))??[];if(((r=this.mh)==null?void 0:r.nh)===t)return this.mh.eh;const e=t.map(o=>new pn(o));return this.mh={nh:t,eh:e},e}Mh(t,e){var i,n;return((n=(i=this.ah).autoscaleInfo)==null?void 0:n.call(i,t,e))??null}}function $i(s,t,e,i){s.forEach(n=>{t(n).forEach(r=>{r.rh()===e&&i.push(r)})})}function Hi(s){return s.Fs()}function Ca(s){return s.wh()}function ja(s){return s.gh()}const Ra=["Area","Line","Baseline"];class Oi extends ma{constructor(t,e,i,n,r){super(t),this.Yt=new va,this.er=new da(this),this.bh=[],this.Sh=new ha(this),this.xh=null,this.Ch=null,this.Ph=null,this.kh=[],this.Ps=i,this.yh=e;const o=new ua(this);this.vs=[o],this.rr=new _o(o,this,t),Ra.includes(this.yh)&&(this.xh=new ca(this)),this.Th(),this.sh=n(this,this.Qt(),r)}m(){this.Ph!==null&&clearTimeout(this.Ph)}Be(t){return this.Ps.priceLineColor||t}ke(t){const e={ye:!0},i=this.Ft();if(this.Qt().Et().Ki()||i.Ki()||this.Yt.Ki())return e;const n=this.Qt().Et().Pe(),r=this.zt();if(n===null||r===null)return e;let o,h;if(t){const d=this.Yt.Ar();if(d===null)return e;o=d,h=d.Re}else{const d=this.Yt.Fr(n.bi(),-1);if(d===null||(o=this.Yt.yr(d.Re),o===null))return e;h=d.Re}const a=o.Wt[3],l=this.Rh().Dr(h,{Wt:o}),c=i.Nt(a,r.Wt);return{ye:!1,gt:a,ri:i.Zi(a,r.Wt),Oe:i.Dh(a),Ne:i.Vh(a,r.Wt),R:l.cr,Bi:c,Re:h}}Rh(){return this.Ch!==null||(this.Ch=new ba(this)),this.Ch}N(){return this.Ps}hr(t){const e=t.priceScaleId;e!==void 0&&e!==this.Ps.priceScaleId&&this.Qt().Ih(this,e),it(this.Ps,t),t.priceFormat!==void 0&&(this.Th(),this.Qt().Bh()),this.Qt().Eh(this),this.Qt().Ah(),this.sh.kt("options")}ht(t,e){this.Yt.ht(t),this.sh.kt("data"),this.xh!==null&&(e&&e.zh?this.xh.be():t.length===0&&this.xh.Me());const i=this.Qt().Hn(this);this.Qt().Lh(i),this.Qt().Eh(this),this.Qt().Ah(),this.Qt().ar()}Oh(t){const e=new pa(this,t);return this.bh.push(e),this.Qt().Eh(this),e}Nh(t){const e=this.bh.indexOf(t);e!==-1&&this.bh.splice(e,1),this.Qt().Eh(this)}Fh(){return this.bh}Rr(){return this.yh}zt(){const t=this.Wh();return t===null?null:{Wt:t.Wt[3],Hh:t.wt}}Wh(){const t=this.Qt().Et().Pe();if(t===null)return null;const e=t.Uh();return this.Yt.Fr(e,1)}Xs(){return this.Yt}$h(t){const e=this.Yt.yr(t);return e===null?null:this.yh==="Bar"||this.yh==="Candlestick"||this.yh==="Custom"?{qh:e.Wt[0],Yh:e.Wt[1],jh:e.Wt[2],Kh:e.Wt[3]}:e.Wt[3]}Xh(t){const e=[];$i(this.kh,Hi,"top",e);const i=this.xh;return i!==null&&i.Vt()&&(this.Ph===null&&i.xe()&&(this.Ph=setTimeout(()=>{this.Ph=null,this.Qt().Zh()},0)),i.Se(),e.unshift(i)),e}Fs(){const t=[];this.Gh()||t.push(this.Sh),t.push(this.sh,this.er);const e=this.bh.map(i=>i.lr());return t.push(...e),$i(this.kh,Hi,"normal",t),t}Jh(){return this.Qh(Hi,"bottom")}ta(t){return this.Qh(Ca,t)}ia(t){return this.Qh(ja,t)}sa(t,e){return this.kh.map(i=>i.jn(t,e)).filter(i=>i!==null)}us(){return[this.rr,...this.bh.map(t=>t._r())]}Ws(t,e){if(e!==this.es&&!this.Gh())return[];const i=[...this.vs];for(const n of this.bh)i.push(n.ur());return this.kh.forEach(n=>{i.push(...n.Ws())}),i}cs(){const t=[];return this.kh.forEach(e=>{t.push(...e.cs())}),t}Mh(t,e){if(this.Ps.autoscaleInfoProvider!==void 0){const i=this.Ps.autoscaleInfoProvider(()=>{const n=this.na(t,e);return n===null?null:n.Xe()});return yi.Ze(i)}return this.na(t,e)}ea(){return this.Ps.priceFormat.minMove}ra(){return this.ha}Ns(){var t;this.sh.kt();for(const e of this.vs)e.kt();for(const e of this.bh)e.kt();this.er.kt(),this.Sh.kt(),(t=this.xh)==null||t.kt(),this.kh.forEach(e=>e.Ns())}Ft(){return _(super.Ft())}At(t){if(!((this.yh==="Line"||this.yh==="Area"||this.yh==="Baseline")&&this.Ps.crosshairMarkerVisible))return null;const e=this.Yt.yr(t);return e===null?null:{gt:e.Wt[3],ft:this.aa(),Ht:this.la(),Ot:this.oa(),Lt:this._a(t)}}Ee(){return this.Ps.title}Vt(){return this.Ps.visible}ua(t){this.kh.push(new Pa(t,this))}ca(t){this.kh=this.kh.filter(e=>e.oh()!==t)}da(){if(this.yh==="Custom")return t=>this.sh.fa(t)}pa(){if(this.yh==="Custom")return t=>this.sh.va(t)}ma(){return this.Yt.qr()}Gh(){return!Li(this.Ft().wa())}na(t,e){if(!Ee(t)||!Ee(e)||this.Yt.Ki())return null;const i=this.yh==="Line"||this.yh==="Area"||this.yh==="Baseline"||this.yh==="Histogram"?[3]:[2,1],n=this.Yt.Ur(t,e,i);let r=n!==null?new G(n.Jr,n.Qr):null,o=null;if(this.Rr()==="Histogram"){const h=this.Ps.base,a=new G(h,h);r=r!==null?r.vn(a):a}return this.kh.forEach(h=>{const a=h.Mh(t,e);if(a!=null&&a.priceRange){const l=new G(a.priceRange.minValue,a.priceRange.maxValue);r=r!==null?r.vn(l):l}a!=null&&a.margins&&(o=a.margins)}),new yi(r,o)}aa(){switch(this.yh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerRadius}return 0}la(){switch(this.yh){case"Line":case"Area":case"Baseline":{const t=this.Ps.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}oa(){switch(this.yh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerBorderWidth}return 0}_a(t){switch(this.yh){case"Line":case"Area":case"Baseline":{const e=this.Ps.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.Rh().Dr(t).cr}Th(){switch(this.Ps.priceFormat.type){case"custom":{const t=this.Ps.priceFormat.formatter;this.ha={format:t,formatTickmarks:this.Ps.priceFormat.tickmarksFormatter??(e=>e.map(t))};break}case"volume":this.ha=new sa(this.Ps.priceFormat.precision);break;case"percent":this.ha=new yo(this.Ps.priceFormat.precision);break;default:{const t=Math.pow(10,this.Ps.priceFormat.precision);this.ha=new Fi(t,this.Ps.priceFormat.minMove*t)}}this.es!==null&&this.es.ga()}Qh(t,e){const i=[];return $i(this.kh,t,e,i),i}}const za=[3],Da=[0,1,2,3];class Ta{constructor(t){this.Ps=t}Ma(t,e,i){let n=t;if(this.Ps.mode===0)return n;const r=i.ys(),o=r.zt();if(o===null)return n;const h=r.Nt(t,o),a=i.ba().filter(c=>c instanceof Oi).reduce((c,d)=>{if(i.Un(d)||!d.Vt())return c;const f=d.Ft(),g=d.Xs();if(f.Ki()||!g.Te(e))return c;const p=g.yr(e);if(p===null)return c;const m=Mt(d.zt()),x=this.Ps.mode===3?Da:za;return c.concat(x.map(b=>f.Nt(p.Wt[b],m.Wt)))},[]);if(a.length===0)return n;a.sort((c,d)=>Math.abs(c-h)-Math.abs(d-h));const l=a[0];return n=r.Ts(l,o),n}}function Me(s,t,e){return Math.min(Math.max(s,t),e)}function qe(s,t,e){return t-s<=e}class Ea extends le{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Yt===null)return;const r=Math.max(1,Math.floor(i));t.lineWidth=r,function(o,h){o.save(),o.lineWidth%2&&o.translate(.5,.5),h(),o.restore()}(t,()=>{const o=_(this.Yt);if(o.Sa){t.strokeStyle=o.xa,se(t,o.Ca),t.beginPath();for(const h of o.Pa){const a=Math.round(h.ka*i);t.moveTo(a,-r),t.lineTo(a,e.height+r)}t.stroke()}if(o.ya){t.strokeStyle=o.Ta,se(t,o.Ra),t.beginPath();for(const h of o.Da){const a=Math.round(h.ka*n);t.moveTo(-r,a),t.lineTo(e.width+r,a)}t.stroke()}})}}class La{constructor(t){this.Gt=new Ea,this.xt=!0,this.Pt=t}kt(){this.xt=!0}Tt(){if(this.xt){const t=this.Pt.Qt().N().grid,e={ya:t.horzLines.visible,Sa:t.vertLines.visible,Ta:t.horzLines.color,xa:t.vertLines.color,Ra:t.horzLines.style,Ca:t.vertLines.style,Da:this.Pt.ys().Va(),Pa:(this.Pt.Qt().Et().Va()||[]).map(i=>({ka:i.coord}))};this.Gt.ht(e),this.xt=!1}return this.Gt}}class Fa{constructor(t){this.sh=new La(t)}lr(){return this.sh}}const qi={Ia:4,Ba:1e-4};function Zt(s,t){const e=100*(s-t)/t;return t<0?-e:e}function Oa(s,t){const e=Zt(s.$e(),t),i=Zt(s.qe(),t);return new G(e,i)}function Pe(s,t){const e=100*(s-t)/t+100;return t<0?-e:e}function Aa(s,t){const e=Pe(s.$e(),t),i=Pe(s.qe(),t);return new G(e,i)}function _i(s,t){const e=Math.abs(s);if(e<1e-15)return 0;const i=Math.log10(e+t.Ba)+t.Ia;return s<0?-i:i}function Ce(s,t){const e=Math.abs(s);if(e<1e-15)return 0;const i=Math.pow(10,e-t.Ia)-t.Ba;return s<0?-i:i}function ge(s,t){if(s===null)return null;const e=_i(s.$e(),t),i=_i(s.qe(),t);return new G(e,i)}function _e(s,t){if(s===null)return null;const e=Ce(s.$e(),t),i=Ce(s.qe(),t);return new G(e,i)}function Ui(s){if(s===null)return qi;const t=Math.abs(s.qe()-s.$e());if(t>=1||t<1e-15)return qi;const e=Math.ceil(Math.abs(Math.log10(t))),i=qi.Ia+e;return{Ia:i,Ba:1/Math.pow(10,i)}}class Xi{constructor(t,e){if(this.Ea=t,this.Aa=e,function(i){if(i<0)return!1;for(let n=i;n>1;n/=10)if(n%10!=0)return!1;return!0}(this.Ea))this.za=[2,2.5,2];else{this.za=[];for(let i=this.Ea;i!==1;){if(i%2==0)this.za.push(2),i/=2;else{if(i%5!=0)throw new Error("unexpected base");this.za.push(2,2.5),i/=5}if(this.za.length>100)throw new Error("something wrong with base")}}}La(t,e,i){const n=this.Ea===0?0:1/this.Ea;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),o=0,h=this.Aa[0];for(;;){const d=qe(r,n,1e-14)&&r>n+1e-14,f=qe(r,i*h,1e-14),g=qe(r,1,1e-14);if(!(d&&f&&g))break;r/=h,h=this.Aa[++o%this.Aa.length]}if(r<=n+1e-14&&(r=n),r=Math.max(1,r),this.za.length>0&&(a=r,l=1,c=1e-14,Math.abs(a-l)<c))for(o=0,h=this.za[0];qe(r,i*h,1e-14)&&r>n+1e-14;)r/=h,h=this.za[++o%this.za.length];var a,l,c;return r}}class mn{constructor(t,e,i,n){this.Oa=[],this.Yi=t,this.Ea=e,this.Na=i,this.Fa=n}La(t,e){if(t<e)throw new Error("high < low");const i=this.Yi.$t(),n=(t-e)*this.Wa()/i,r=new Xi(this.Ea,[2,2.5,2]),o=new Xi(this.Ea,[2,2,2.5]),h=new Xi(this.Ea,[2.5,2,2]),a=[];return a.push(r.La(t,e,n),o.La(t,e,n),h.La(t,e,n)),function(l){if(l.length<1)throw Error("array is empty");let c=l[0];for(let d=1;d<l.length;++d)l[d]<c&&(c=l[d]);return c}(a)}Ha(){const t=this.Yi,e=t.zt();if(e===null)return void(this.Oa=[]);const i=t.$t(),n=this.Na(i-1,e),r=this.Na(0,e),o=this.Yi.N().entireTextOnly?this.Ua()/2:0,h=o,a=i-1-o,l=Math.max(n,r),c=Math.min(n,r);if(l===c)return void(this.Oa=[]);const d=this.La(l,c);if(this.$a(e,d,l,c,h,a),t.qa()&&this.Ya(d,c,l)){const p=this.Yi.ja();this.Ka(e,d,h,a,p,2*p)}const f=this.Oa.map(p=>p.Xa),g=this.Yi.Za(f);for(let p=0;p<this.Oa.length;p++)this.Oa[p].Ga=g[p]}Va(){return this.Oa}Ua(){return this.Yi.P()}Wa(){return Math.ceil(2.5*this.Ua())}$a(t,e,i,n,r,o){const h=this.Oa,a=this.Yi;let l=i%e;l+=l<0?e:0;const c=i>=n?1:-1;let d=null,f=0;for(let g=i-l;g>n;g-=e){const p=this.Fa(g,t,!0);d!==null&&Math.abs(p-d)<this.Wa()||p<r||p>o||(f<h.length?(h[f].ka=p,h[f].Ga=a.Ja(g),h[f].Xa=g):h.push({ka:p,Ga:a.Ja(g),Xa:g}),f++,d=p,a.Qa()&&(e=this.La(g*c,n)))}h.length=f}Ka(t,e,i,n,r,o){const h=this.Oa,a=this.tl(t,i,r,o),l=this.tl(t,n,-o,-r),c=this.Fa(0,t,!0)-this.Fa(e,t,!0);h.length>0&&h[0].ka-a.ka<c/2&&h.shift(),h.length>0&&l.ka-h[h.length-1].ka<c/2&&h.pop(),h.unshift(a),h.push(l)}tl(t,e,i,n){const r=(i+n)/2,o=this.Na(e+i,t),h=this.Na(e+n,t),a=Math.min(o,h),l=Math.max(o,h),c=Math.max(.1,this.La(l,a)),d=this.Na(e+r,t),f=d-d%c,g=this.Fa(f,t,!0);return{Ga:this.Yi.Ja(f),ka:g,Xa:f}}Ya(t,e,i){let n=Mt(this.Yi.Qe());return this.Yi.Qa()&&(n=_e(n,this.Yi.il())),n.$e()-e<t&&i-n.qe()<t}}function Po(s){return s.slice().sort((t,e)=>_(t.hs())-_(e.hs()))}var xn;(function(s){s[s.Normal=0]="Normal",s[s.Logarithmic=1]="Logarithmic",s[s.Percentage=2]="Percentage",s[s.IndexedTo100=3]="IndexedTo100"})(xn||(xn={}));const bn=new yo,vn=new Fi(100,1);class Na{constructor(t,e,i,n,r){this.sl=0,this.nl=null,this.Ge=null,this.el=null,this.rl={hl:!1,al:null},this.ll=!1,this.ol=0,this._l=0,this.ul=new W,this.cl=new W,this.dl=[],this.fl=null,this.pl=null,this.vl=null,this.ml=null,this.wl=null,this.ha=vn,this.gl=Ui(null),this.Ml=t,this.Ps=e,this.bl=i,this.Sl=n,this.xl=r,this.Cl=new mn(this,100,this.Pl.bind(this),this.kl.bind(this))}wa(){return this.Ml}N(){return this.Ps}hr(t){if(it(this.Ps,t),this.ga(),t.mode!==void 0&&this.yl({ie:t.mode}),t.scaleMargins!==void 0){const e=tt(t.scaleMargins.top),i=tt(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.Tl(),this.vl=null}}Rl(){return this.Ps.autoScale}Dl(){return this.ll}Qa(){return this.Ps.mode===1}Le(){return this.Ps.mode===2}Vl(){return this.Ps.mode===3}il(){return this.gl}ie(){return{sn:this.Ps.autoScale,Il:this.Ps.invertScale,ie:this.Ps.mode}}yl(t){const e=this.ie();let i=null;t.sn!==void 0&&(this.Ps.autoScale=t.sn),t.ie!==void 0&&(this.Ps.mode=t.ie,t.ie!==2&&t.ie!==3||(this.Ps.autoScale=!0),this.rl.hl=!1),e.ie===1&&t.ie!==e.ie&&(function(r,o){if(r===null)return!1;const h=Ce(r.$e(),o),a=Ce(r.qe(),o);return isFinite(h)&&isFinite(a)}(this.Ge,this.gl)?(i=_e(this.Ge,this.gl),i!==null&&this.Bl(i)):this.Ps.autoScale=!0),t.ie===1&&t.ie!==e.ie&&(i=ge(this.Ge,this.gl),i!==null&&this.Bl(i));const n=e.ie!==this.Ps.mode;n&&(e.ie===2||this.Le())&&this.ga(),n&&(e.ie===3||this.Vl())&&this.ga(),t.Il!==void 0&&e.Il!==t.Il&&(this.Ps.invertScale=t.Il,this.El()),this.cl.p(e,this.ie())}Al(){return this.cl}P(){return this.bl.fontSize}$t(){return this.sl}zl(t){this.sl!==t&&(this.sl=t,this.Tl(),this.vl=null)}Ll(){if(this.nl)return this.nl;const t=this.$t()-this.Ol()-this.Nl();return this.nl=t,t}Qe(){return this.Fl(),this.Ge}Bl(t,e){const i=this.Ge;(e||i===null&&t!==null||i!==null&&!i.He(t))&&(this.vl=null,this.Ge=t)}Wl(t){this.Bl(t),this.Hl(t!==null)}Ki(){return this.Fl(),this.sl===0||!this.Ge||this.Ge.Ki()}Ul(t){return this.Il()?t:this.$t()-1-t}Nt(t,e){return this.Le()?t=Zt(t,e):this.Vl()&&(t=Pe(t,e)),this.kl(t,e)}$l(t,e,i){this.Fl();const n=this.Nl(),r=_(this.Qe()),o=r.$e(),h=r.qe(),a=this.Ll()-1,l=this.Il(),c=a/(h-o),d=i===void 0?0:i.from,f=i===void 0?t.length:i.to,g=this.ql();for(let p=d;p<f;p++){const m=t[p],x=m.gt;if(isNaN(x))continue;let b=x;g!==null&&(b=g(m.gt,e));const v=n+c*(b-o),y=l?v:this.sl-1-v;m.ut=y}}Yl(t,e,i){this.Fl();const n=this.Nl(),r=_(this.Qe()),o=r.$e(),h=r.qe(),a=this.Ll()-1,l=this.Il(),c=a/(h-o),d=i===void 0?0:i.from,f=i===void 0?t.length:i.to,g=this.ql();for(let p=d;p<f;p++){const m=t[p];let x=m.qh,b=m.Yh,v=m.jh,y=m.Kh;g!==null&&(x=g(m.qh,e),b=g(m.Yh,e),v=g(m.jh,e),y=g(m.Kh,e));let w=n+c*(x-o),S=l?w:this.sl-1-w;m.jl=S,w=n+c*(b-o),S=l?w:this.sl-1-w,m.Kl=S,w=n+c*(v-o),S=l?w:this.sl-1-w,m.Xl=S,w=n+c*(y-o),S=l?w:this.sl-1-w,m.Zl=S}}Ts(t,e){const i=this.Pl(t,e);return this.Gl(i,e)}Gl(t,e){let i=t;return this.Le()?i=function(n,r){return r<0&&(n=-n),n/100*r+r}(i,e):this.Vl()&&(i=function(n,r){return n-=100,r<0&&(n=-n),n/100*r+r}(i,e)),i}ba(){return this.dl}Dt(){return this.pl||(this.pl=Po(this.dl)),this.pl}Jl(t){this.dl.indexOf(t)===-1&&(this.dl.push(t),this.ga(),this.Ql())}io(t){const e=this.dl.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.dl.splice(e,1),this.dl.length===0&&(this.yl({sn:!0}),this.Bl(null)),this.ga(),this.Ql()}zt(){let t=null;for(const e of this.dl){const i=e.zt();i!==null&&(t===null||i.Hh<t.Hh)&&(t=i)}return t===null?null:t.Wt}Il(){return this.Ps.invertScale}Va(){const t=this.zt()===null;if(this.vl!==null&&(t||this.vl.so===t))return this.vl.Va;this.Cl.Ha();const e=this.Cl.Va();return this.vl={Va:e,so:t},this.ul.p(),e}no(){return this.ul}eo(t){this.Le()||this.Vl()||this.ml===null&&this.el===null&&(this.Ki()||(this.ml=this.sl-t,this.el=_(this.Qe()).Ue()))}ro(t){if(this.Le()||this.Vl()||this.ml===null)return;this.yl({sn:!1}),(t=this.sl-t)<0&&(t=0);let e=(this.ml+.2*(this.sl-1))/(t+.2*(this.sl-1));const i=_(this.el).Ue();e=Math.max(e,.1),i.je(e),this.Bl(i)}ho(){this.Le()||this.Vl()||(this.ml=null,this.el=null)}ao(t){this.Rl()||this.wl===null&&this.el===null&&(this.Ki()||(this.wl=t,this.el=_(this.Qe()).Ue()))}lo(t){if(this.Rl()||this.wl===null)return;const e=_(this.Qe()).Ye()/(this.Ll()-1);let i=t-this.wl;this.Il()&&(i*=-1);const n=i*e,r=_(this.el).Ue();r.Ke(n),this.Bl(r,!0),this.vl=null}oo(){this.Rl()||this.wl!==null&&(this.wl=null,this.el=null)}ra(){return this.ha||this.ga(),this.ha}Zi(t,e){switch(this.Ps.mode){case 2:return this._o(Zt(t,e));case 3:return this.ra().format(Pe(t,e));default:return this.nr(t)}}Ja(t){switch(this.Ps.mode){case 2:return this._o(t);case 3:return this.ra().format(t);default:return this.nr(t)}}Za(t){switch(this.Ps.mode){case 2:return this.uo(t);case 3:return this.ra().formatTickmarks(t);default:return this.co(t)}}Dh(t){return this.nr(t,_(this.fl).ra())}Vh(t,e){return t=Zt(t,e),this._o(t,bn)}do(){return this.dl}fo(t){this.rl={al:t,hl:!1}}Ns(){this.dl.forEach(t=>t.Ns())}qa(){return this.Ps.ensureEdgeTickMarksVisible&&this.Rl()}ja(){return this.P()/2}ga(){this.vl=null;let t=1/0;this.fl=null;for(const i of this.dl)i.hs()<t&&(t=i.hs(),this.fl=i);let e=100;this.fl!==null&&(e=Math.round(1/this.fl.ea())),this.ha=vn,this.Le()?(this.ha=bn,e=100):this.Vl()?(this.ha=new Fi(100,1),e=100):this.fl!==null&&(this.ha=this.fl.ra()),this.Cl=new mn(this,e,this.Pl.bind(this),this.kl.bind(this)),this.Cl.Ha()}Ql(){this.pl=null}Xi(){return this.xl}Hl(t){this.ll=t}Ol(){return this.Il()?this.Ps.scaleMargins.bottom*this.$t()+this._l:this.Ps.scaleMargins.top*this.$t()+this.ol}Nl(){return this.Il()?this.Ps.scaleMargins.top*this.$t()+this.ol:this.Ps.scaleMargins.bottom*this.$t()+this._l}Fl(){this.rl.hl||(this.rl.hl=!0,this.po())}Tl(){this.nl=null}kl(t,e){if(this.Fl(),this.Ki())return 0;t=this.Qa()&&t?_i(t,this.gl):t;const i=_(this.Qe()),n=this.Nl()+(this.Ll()-1)*(t-i.$e())/i.Ye();return this.Ul(n)}Pl(t,e){if(this.Fl(),this.Ki())return 0;const i=this.Ul(t),n=_(this.Qe()),r=n.$e()+n.Ye()*((i-this.Nl())/(this.Ll()-1));return this.Qa()?Ce(r,this.gl):r}El(){this.vl=null,this.Cl.Ha()}po(){if(this.Dl()&&!this.Rl())return;const t=this.rl.al;if(t===null)return;let e=null;const i=this.do();let n=0,r=0;for(const a of i){if(!a.Vt())continue;const l=a.zt();if(l===null)continue;const c=a.Mh(t.Uh(),t.bi());let d=c&&c.Qe();if(d!==null){switch(this.Ps.mode){case 1:d=ge(d,this.gl);break;case 2:d=Oa(d,l.Wt);break;case 3:d=Aa(d,l.Wt)}if(e=e===null?d:e.vn(_(d)),c!==null){const f=c.tr();f!==null&&(n=Math.max(n,f.above),r=Math.max(r,f.below))}}}if(this.qa()&&(n=Math.max(n,this.ja()),r=Math.max(r,this.ja())),n===this.ol&&r===this._l||(this.ol=n,this._l=r,this.vl=null,this.Tl()),e!==null){if(e.$e()===e.qe()){const a=this.fl,l=5*(a===null||this.Le()||this.Vl()?1:a.ea());this.Qa()&&(e=_e(e,this.gl)),e=new G(e.$e()-l,e.qe()+l),this.Qa()&&(e=ge(e,this.gl))}if(this.Qa()){const a=_e(e,this.gl),l=Ui(a);if(o=l,h=this.gl,o.Ia!==h.Ia||o.Ba!==h.Ba){const c=this.el!==null?_e(this.el,this.gl):null;this.gl=l,e=ge(a,l),c!==null&&(this.el=ge(c,l))}}this.Bl(e)}else this.Ge===null&&(this.Bl(new G(-.5,.5)),this.gl=Ui(null));var o,h}ql(){return this.Le()?Zt:this.Vl()?Pe:this.Qa()?t=>_i(t,this.gl):null}vo(t,e,i){return e===void 0?(i===void 0&&(i=this.ra()),i.format(t)):e(t)}mo(t,e,i){return e===void 0?(i===void 0&&(i=this.ra()),i.formatTickmarks(t)):e(t)}nr(t,e){return this.vo(t,this.Sl.priceFormatter,e)}co(t,e){const i=this.Sl.priceFormatter;return this.mo(t,this.Sl.tickmarksPriceFormatter??(i?n=>n.map(i):void 0),e)}_o(t,e){return this.vo(t,this.Sl.percentageFormatter,e)}uo(t,e){const i=this.Sl.percentageFormatter;return this.mo(t,this.Sl.tickmarksPercentageFormatter??(i?n=>n.map(i):void 0),e)}}function yn(s){return s instanceof Oi}class _n{constructor(t,e){this.dl=[],this.wo=new Map,this.sl=0,this.Mo=0,this.bo=1,this.pl=null,this.So=!1,this.xo=new W,this.kh=[],this.uh=t,this.ts=e,this.Co=new Fa(this);const i=e.N();this.Po=this.ko("left",i.leftPriceScale),this.yo=this.ko("right",i.rightPriceScale),this.Po.Al().i(this.To.bind(this,this.Po),this),this.yo.Al().i(this.To.bind(this,this.yo),this),this.Ro(i)}Ro(t){if(t.leftPriceScale&&this.Po.hr(t.leftPriceScale),t.rightPriceScale&&this.yo.hr(t.rightPriceScale),t.localization&&(this.Po.ga(),this.yo.ga()),t.overlayPriceScales){const e=Array.from(this.wo.values());for(const i of e){const n=_(i[0].Ft());n.hr(t.overlayPriceScales),t.localization&&n.ga()}}}Do(t){switch(t){case"left":return this.Po;case"right":return this.yo}return this.wo.has(t)?tt(this.wo.get(t))[0].Ft():null}m(){this.Qt().Vo().u(this),this.Po.Al().u(this),this.yo.Al().u(this),this.dl.forEach(t=>{t.m&&t.m()}),this.kh=this.kh.filter(t=>{const e=t.oh();return e.detached&&e.detached(),!1}),this.xo.p()}Io(){return this.bo}Bo(t){this.bo=t}Qt(){return this.ts}Qi(){return this.Mo}$t(){return this.sl}Eo(t){this.Mo=t,this.Ao()}zl(t){this.sl=t,this.Po.zl(t),this.yo.zl(t),this.dl.forEach(e=>{if(this.Un(e)){const i=e.Ft();i!==null&&i.zl(t)}}),this.Ao()}zo(t){this.So=t}Lo(){return this.So}Oo(){return this.dl.filter(yn)}ba(){return this.dl}Un(t){const e=t.Ft();return e===null||this.Po!==e&&this.yo!==e}Jl(t,e,i){this.No(t,e,i?t.hs():this.dl.length)}io(t,e){const i=this.dl.indexOf(t);U(i!==-1,"removeDataSource: invalid data source"),this.dl.splice(i,1),e||this.dl.forEach((o,h)=>o.ls(h));const n=_(t.Ft()).wa();if(this.wo.has(n)){const o=tt(this.wo.get(n)),h=o.indexOf(t);h!==-1&&(o.splice(h,1),o.length===0&&this.wo.delete(n))}const r=t.Ft();r&&r.ba().indexOf(t)>=0&&(r.io(t),this.Fo(r)),this.pl=null}qn(t){return t===this.Po?"left":t===this.yo?"right":"overlay"}Wo(){return this.Po}Ho(){return this.yo}Uo(t,e){t.eo(e)}$o(t,e){t.ro(e),this.Ao()}qo(t){t.ho()}Yo(t,e){t.ao(e)}jo(t,e){t.lo(e),this.Ao()}Ko(t){t.oo()}Ao(){this.dl.forEach(t=>{t.Ns()})}ys(){let t=null;return this.ts.N().rightPriceScale.visible&&this.yo.ba().length!==0?t=this.yo:this.ts.N().leftPriceScale.visible&&this.Po.ba().length!==0?t=this.Po:this.dl.length!==0&&(t=this.dl[0].Ft()),t===null&&(t=this.yo),t}$n(){let t=null;return this.ts.N().rightPriceScale.visible?t=this.yo:this.ts.N().leftPriceScale.visible&&(t=this.Po),t}Fo(t){t!==null&&t.Rl()&&this.Xo(t)}Zo(t){const e=this.uh.Pe();t.yl({sn:!0}),e!==null&&t.fo(e),this.Ao()}Go(){this.Xo(this.Po),this.Xo(this.yo)}Jo(){this.Fo(this.Po),this.Fo(this.yo),this.dl.forEach(t=>{this.Un(t)&&this.Fo(t.Ft())}),this.Ao(),this.ts.ar()}Dt(){return this.pl===null&&(this.pl=Po(this.dl)),this.pl}Qo(t,e){e=Me(e,0,this.dl.length-1);const i=this.dl.indexOf(t);U(i!==-1,"setSeriesOrder: invalid data source"),this.dl.splice(i,1),this.dl.splice(e,0,t),this.dl.forEach((n,r)=>n.ls(r)),this.pl=null;for(const n of[this.Po,this.yo])n.Ql(),n.ga();this.ts.ar()}It(){return this.Dt().filter(yn)}t_(){return this.xo}i_(){return this.Co}ua(t){this.kh.push(new wa(t))}ca(t){this.kh=this.kh.filter(e=>e.oh()!==t),t.detached&&t.detached(),this.ts.ar()}s_(){return this.kh}sa(t,e){return this.kh.map(i=>i.jn(t,e)).filter(i=>i!==null)}Xo(t){const e=t.do();if(e&&e.length>0&&!this.uh.Ki()){const i=this.uh.Pe();i!==null&&t.fo(i)}t.Ns()}No(t,e,i){let n=this.Do(e);if(n===null&&(n=this.ko(e,this.ts.N().overlayPriceScales)),this.dl.splice(i,0,t),!Li(e)){const r=this.wo.get(e)||[];r.push(t),this.wo.set(e,r)}t.ls(i),n.Jl(t),t._s(n),this.Fo(n),this.pl=null}To(t,e,i){e.ie!==i.ie&&this.Xo(t)}ko(t,e){const i={visible:!0,autoScale:!0,...vt(e)},n=new Na(t,i,this.ts.N().layout,this.ts.N().localization,this.ts.Xi());return n.zl(this.$t()),n}}function Ue(s){return{n_:s.n_,e_:{Kn:s.r_.externalId},h_:s.r_.cursorStyle}}function Ba(s,t,e,i){for(const n of s){const r=n.Tt(i);if(r!==null&&r.jn){const o=r.jn(t,e);if(o!==null)return{a_:n,e_:o}}}return null}function Ia(s){return s.Fs!==void 0}function Co(s,t,e){const i=[s,...s.Dt()],n=function(r,o,h){var f;let a,l;for(const g of r){const p=((f=g.sa)==null?void 0:f.call(g,o,h))??[];for(const m of p)c=m.zOrder,d=a==null?void 0:a.zOrder,(!d||c==="top"&&d!=="top"||c==="normal"&&d==="bottom")&&(a=m,l=g)}var c,d;return a&&l?{r_:a,n_:l}:null}(i,t,e);if((n==null?void 0:n.r_.zOrder)==="top")return Ue(n);for(const r of i){if(n&&n.n_===r&&n.r_.zOrder!=="bottom"&&!n.r_.isBackground)return Ue(n);if(Ia(r)){const o=Ba(r.Fs(s),t,e,s);if(o!==null)return{n_:r,a_:o.a_,e_:o.e_}}if(n&&n.n_===r&&n.r_.zOrder!=="bottom"&&n.r_.isBackground)return Ue(n)}return n!=null&&n.r_?Ue(n):null}class Wa{constructor(t,e,i=50){this.kn=0,this.yn=1,this.Tn=1,this.Dn=new Map,this.Rn=new Map,this.l_=t,this.o_=e,this.Vn=i}__(t){const e=t.time,i=this.o_.cacheKey(e),n=this.Dn.get(i);if(n!==void 0)return n.u_;if(this.kn===this.Vn){const o=this.Rn.get(this.Tn);this.Rn.delete(this.Tn),this.Dn.delete(tt(o)),this.Tn++,this.kn--}const r=this.l_(t);return this.Dn.set(i,{u_:r,An:this.yn}),this.Rn.set(this.yn,i),this.kn++,this.yn++,r}}class je{constructor(t,e){U(t<=e,"right should be >= left"),this.c_=t,this.d_=e}Uh(){return this.c_}bi(){return this.d_}f_(){return this.d_-this.c_+1}Te(t){return this.c_<=t&&t<=this.d_}He(t){return this.c_===t.Uh()&&this.d_===t.bi()}}function wn(s,t){return s===null||t===null?s===t:s.He(t)}class Va{constructor(){this.p_=new Map,this.Dn=null,this.v_=!1}m_(t){this.v_=t,this.Dn=null}w_(t,e){this.g_(e),this.Dn=null;for(let i=e;i<t.length;++i){const n=t[i];let r=this.p_.get(n.timeWeight);r===void 0&&(r=[],this.p_.set(n.timeWeight,r)),r.push({index:i,time:n.time,weight:n.timeWeight,originalTime:n.originalTime})}}M_(t,e,i,n,r){const o=Math.ceil(e/t);return this.Dn!==null&&this.Dn.b_===o&&r===this.Dn.S_&&i===this.Dn.x_||(this.Dn={S_:r,x_:i,Va:this.C_(o,i,n),b_:o}),this.Dn.Va}g_(t){if(t===0)return void this.p_.clear();const e=[];this.p_.forEach((i,n)=>{t<=i[0].index?e.push(n):i.splice(re(i,t,r=>r.index<t),1/0)});for(const i of e)this.p_.delete(i)}C_(t,e,i){let n=[];const r=o=>!e||i.has(o.index);for(const o of Array.from(this.p_.keys()).sort((h,a)=>a-h)){if(!this.p_.get(o))continue;const h=n;n=[];const a=h.length;let l=0;const c=tt(this.p_.get(o)),d=c.length;let f=1/0,g=-1/0;for(let p=0;p<d;p++){const m=c[p],x=m.index;for(;l<a;){const b=h[l],v=b.index;if(!(v<x&&r(b))){f=v;break}l++,n.push(b),g=v,f=1/0}if(f-x>=t&&x-g>=t&&r(m))n.push(m),g=x;else if(this.v_)return h}for(;l<a;l++)r(h[l])&&n.push(h[l])}return n}}class te{constructor(t){this.P_=t}k_(){return this.P_===null?null:new je(Math.floor(this.P_.Uh()),Math.ceil(this.P_.bi()))}y_(){return this.P_}static T_(){return new te(null)}}function Ya(s,t){return s.weight>t.weight?s:t}class $a{constructor(t,e,i,n){this.Mo=0,this.R_=null,this.D_=[],this.wl=null,this.ml=null,this.V_=new Va,this.I_=new Map,this.B_=te.T_(),this.E_=!0,this.A_=new W,this.z_=new W,this.L_=new W,this.O_=null,this.N_=null,this.F_=new Map,this.W_=-1,this.H_=[],this.Ps=e,this.Sl=i,this.U_=e.rightOffset,this.q_=e.barSpacing,this.ts=t,this.o_=n,this.Y_(),this.V_.m_(e.uniformDistribution),this.j_()}N(){return this.Ps}K_(t){it(this.Sl,t),this.X_(),this.Y_()}hr(t,e){it(this.Ps,t),this.Ps.fixLeftEdge&&this.Z_(),this.Ps.fixRightEdge&&this.G_(),t.barSpacing!==void 0&&this.ts.dn(t.barSpacing),t.rightOffset!==void 0&&this.ts.fn(t.rightOffset),t.minBarSpacing===void 0&&t.maxBarSpacing===void 0||this.ts.dn(t.barSpacing??this.q_),t.ignoreWhitespaceIndices!==void 0&&t.ignoreWhitespaceIndices!==this.Ps.ignoreWhitespaceIndices&&this.j_(),this.X_(),this.Y_(),this.L_.p()}Rs(t){var e;return((e=this.D_[t])==null?void 0:e.time)??null}ss(t){return this.D_[t]??null}J_(t,e){if(this.D_.length<1)return null;if(this.o_.key(t)>this.o_.key(this.D_[this.D_.length-1].time))return e?this.D_.length-1:null;const i=re(this.D_,this.o_.key(t),(n,r)=>this.o_.key(n.time)<r);return this.o_.key(t)<this.o_.key(this.D_[i].time)?e?i:null:i}Ki(){return this.Mo===0||this.D_.length===0||this.R_===null}Q_(){return this.D_.length>0}Pe(){return this.tu(),this.B_.k_()}iu(){return this.tu(),this.B_.y_()}su(){const t=this.Pe();if(t===null)return null;const e={from:t.Uh(),to:t.bi()};return this.nu(e)}nu(t){const e=Math.round(t.from),i=Math.round(t.to),n=_(this.eu()),r=_(this.ru());return{from:_(this.ss(Math.max(n,e))),to:_(this.ss(Math.min(r,i)))}}hu(t){return{from:_(this.J_(t.from,!0)),to:_(this.J_(t.to,!0))}}Qi(){return this.Mo}Eo(t){if(!isFinite(t)||t<=0||this.Mo===t)return;const e=this.iu(),i=this.Mo;if(this.Mo=t,this.E_=!0,this.Ps.lockVisibleTimeRangeOnResize&&i!==0){const n=this.q_*t/i;this.q_=n}if(this.Ps.fixLeftEdge&&e!==null&&e.Uh()<=0){const n=i-t;this.U_-=Math.round(n/this.q_)+1,this.E_=!0}this.au(),this.lu()}qt(t){if(this.Ki()||!Ee(t))return 0;const e=this.ou()+this.U_-t;return this.Mo-(e+.5)*this.q_-1}_u(t,e){const i=this.ou(),n=e===void 0?0:e.from,r=e===void 0?t.length:e.to;for(let o=n;o<r;o++){const h=t[o].wt,a=i+this.U_-h,l=this.Mo-(a+.5)*this.q_-1;t[o]._t=l}}uu(t,e){const i=Math.ceil(this.cu(t));return e&&this.Ps.ignoreWhitespaceIndices&&!this.du(i)?this.fu(i):i}fn(t){this.E_=!0,this.U_=t,this.lu(),this.ts.pu(),this.ts.ar()}vu(){return this.q_}dn(t){this.mu(t),this.lu(),this.ts.pu(),this.ts.ar()}wu(){return this.U_}Va(){if(this.Ki())return null;if(this.N_!==null)return this.N_;const t=this.q_,e=5*(this.ts.N().layout.fontSize+4)/8*(this.Ps.tickMarkMaxCharacterLength||8),i=Math.round(e/t),n=_(this.Pe()),r=Math.max(n.Uh(),n.Uh()-i),o=Math.max(n.bi(),n.bi()-i),h=this.V_.M_(t,e,this.Ps.ignoreWhitespaceIndices,this.F_,this.W_),a=this.eu()+i,l=this.ru()-i,c=this.gu(),d=this.Ps.fixLeftEdge||c,f=this.Ps.fixRightEdge||c;let g=0;for(const p of h){if(!(r<=p.index&&p.index<=o))continue;let m;g<this.H_.length?(m=this.H_[g],m.coord=this.qt(p.index),m.label=this.Mu(p),m.weight=p.weight):(m={needAlignCoordinate:!1,coord:this.qt(p.index),label:this.Mu(p),weight:p.weight},this.H_.push(m)),this.q_>e/2&&!c?m.needAlignCoordinate=!1:m.needAlignCoordinate=d&&p.index<=a||f&&p.index>=l,g++}return this.H_.length=g,this.N_=this.H_,this.H_}bu(){this.E_=!0,this.dn(this.Ps.barSpacing),this.fn(this.Ps.rightOffset)}Su(t){this.E_=!0,this.R_=t,this.lu(),this.Z_()}xu(t,e){const i=this.cu(t),n=this.vu(),r=n+e*(n/10);this.dn(r),this.Ps.rightBarStaysOnScroll||this.fn(this.wu()+(i-this.cu(t)))}eo(t){this.wl&&this.oo(),this.ml===null&&this.O_===null&&(this.Ki()||(this.ml=t,this.Cu()))}ro(t){if(this.O_===null)return;const e=Me(this.Mo-t,0,this.Mo),i=Me(this.Mo-_(this.ml),0,this.Mo);e!==0&&i!==0&&this.dn(this.O_.vu*e/i)}ho(){this.ml!==null&&(this.ml=null,this.Pu())}ao(t){this.wl===null&&this.O_===null&&(this.Ki()||(this.wl=t,this.Cu()))}lo(t){if(this.wl===null)return;const e=(this.wl-t)/this.vu();this.U_=_(this.O_).wu+e,this.E_=!0,this.lu()}oo(){this.wl!==null&&(this.wl=null,this.Pu())}ku(){this.yu(this.Ps.rightOffset)}yu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.U_,n=performance.now();this.ts._n({Tu:r=>(r-n)/e>=1,Ru:r=>{const o=(r-n)/e;return o>=1?t:i+(t-i)*o}})}kt(t,e){this.E_=!0,this.D_=t,this.V_.w_(t,e),this.lu()}Du(){return this.A_}Vu(){return this.z_}Iu(){return this.L_}ou(){return this.R_||0}Bu(t){const e=t.f_();this.mu(this.Mo/e),this.U_=t.bi()-this.ou(),this.lu(),this.E_=!0,this.ts.pu(),this.ts.ar()}Eu(){const t=this.eu(),e=this.ru();t!==null&&e!==null&&this.Bu(new je(t,e+this.Ps.rightOffset))}Au(t){const e=new je(t.from,t.to);this.Bu(e)}ns(t){return this.Sl.timeFormatter!==void 0?this.Sl.timeFormatter(t.originalTime):this.o_.formatHorzItem(t.time)}j_(){if(!this.Ps.ignoreWhitespaceIndices)return;this.F_.clear();const t=this.ts.js();for(const e of t)for(const i of e.ma())this.F_.set(i,!0);this.W_++}gu(){const t=this.ts.N().handleScroll,e=this.ts.N().handleScale;return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}eu(){return this.D_.length===0?null:0}ru(){return this.D_.length===0?null:this.D_.length-1}zu(t){return(this.Mo-1-t)/this.q_}cu(t){const e=this.zu(t),i=this.ou()+this.U_-e;return Math.round(1e6*i)/1e6}mu(t){const e=this.q_;this.q_=t,this.au(),e!==this.q_&&(this.E_=!0,this.Lu())}tu(){if(!this.E_)return;if(this.E_=!1,this.Ki())return void this.Ou(te.T_());const t=this.ou(),e=this.Mo/this.q_,i=this.U_+t,n=new je(i-e+1,i);this.Ou(new te(n))}au(){const t=Me(this.q_,this.Nu(),this.Fu());this.q_!==t&&(this.q_=t,this.E_=!0)}Fu(){return this.Ps.maxBarSpacing>0?this.Ps.maxBarSpacing:.5*this.Mo}Nu(){return this.Ps.fixLeftEdge&&this.Ps.fixRightEdge&&this.D_.length!==0?this.Mo/this.D_.length:this.Ps.minBarSpacing}lu(){const t=this.Wu();t!==null&&this.U_<t&&(this.U_=t,this.E_=!0);const e=this.Hu();this.U_>e&&(this.U_=e,this.E_=!0)}Wu(){const t=this.eu(),e=this.R_;return t===null||e===null?null:t-e-1+(this.Ps.fixLeftEdge?this.Mo/this.q_:Math.min(2,this.D_.length))}Hu(){return this.Ps.fixRightEdge?0:this.Mo/this.q_-Math.min(2,this.D_.length)}Cu(){this.O_={vu:this.vu(),wu:this.wu()}}Pu(){this.O_=null}Mu(t){let e=this.I_.get(t.weight);return e===void 0&&(e=new Wa(i=>this.Uu(i),this.o_),this.I_.set(t.weight,e)),e.__(t)}Uu(t){return this.o_.formatTickmark(t,this.Sl)}Ou(t){const e=this.B_;this.B_=t,wn(e.k_(),this.B_.k_())||this.A_.p(),wn(e.y_(),this.B_.y_())||this.z_.p(),this.Lu()}Lu(){this.N_=null}X_(){this.Lu(),this.I_.clear()}Y_(){this.o_.updateFormatter(this.Sl)}Z_(){if(!this.Ps.fixLeftEdge)return;const t=this.eu();if(t===null)return;const e=this.Pe();if(e===null)return;const i=e.Uh()-t;if(i<0){const n=this.U_-i-1;this.fn(n)}this.au()}G_(){this.lu(),this.au()}du(t){return!this.Ps.ignoreWhitespaceIndices||this.F_.get(t)||!1}fu(t){const e=function*(n){const r=Math.round(n),o=r<n;let h=1;for(;;)o?(yield r+h,yield r-h):(yield r-h,yield r+h),h++}(t),i=this.ru();for(;i;){const n=e.next().value;if(this.F_.get(n))return n;if(n<0||n>i)break}return t}}var Sn,kn,Mn,_s,Pn;(function(s){s[s.OnTouchEnd=0]="OnTouchEnd",s[s.OnNextTap=1]="OnNextTap"})(Sn||(Sn={}));class Ha{constructor(t,e,i){this.$u=[],this.qu=[],this.Mo=0,this.Yu=null,this.ju=new W,this.Ku=new W,this.Xu=null,this.Zu=t,this.Ps=e,this.o_=i,this.xl=new Hh(this.Ps.layout.colorParsers),this.Gu=new $h(this),this.uh=new $a(this,e.timeScale,this.Ps.localization,i),this.Ct=new ia(this,e.crosshair),this.Ju=new Ta(e.crosshair),e.addDefaultPane&&(this.Qu(0),this.$u[0].Bo(2)),this.tc=this.sc(0),this.nc=this.sc(1)}Bh(){this.ec(q.gn())}ar(){this.ec(q.wn())}Zh(){this.ec(new q(1))}Eh(t){const e=this.rc(t);this.ec(e)}hc(){return this.Yu}ac(t){var i,n,r,o;if(((i=this.Yu)==null?void 0:i.n_)===(t==null?void 0:t.n_)&&((r=(n=this.Yu)==null?void 0:n.e_)==null?void 0:r.Kn)===((o=t==null?void 0:t.e_)==null?void 0:o.Kn))return;const e=this.Yu;this.Yu=t,e!==null&&this.Eh(e.n_),t!==null&&t.n_!==(e==null?void 0:e.n_)&&this.Eh(t.n_)}N(){return this.Ps}hr(t){it(this.Ps,t),this.$u.forEach(e=>e.Ro(t)),t.timeScale!==void 0&&this.uh.hr(t.timeScale),t.localization!==void 0&&this.uh.K_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.ju.p(),this.tc=this.sc(0),this.nc=this.sc(1),this.Bh()}lc(t,e,i=0){const n=this.$u[i];if(n===void 0)return;if(t==="left")return it(this.Ps,{leftPriceScale:e}),n.Ro({leftPriceScale:e}),this.ju.p(),void this.Bh();if(t==="right")return it(this.Ps,{rightPriceScale:e}),n.Ro({rightPriceScale:e}),this.ju.p(),void this.Bh();const r=this.oc(t,i);r!==null&&(r.Ft.hr(e),this.ju.p())}oc(t,e){const i=this.$u[e];if(i===void 0)return null;const n=i.Do(t);return n!==null?{Us:i,Ft:n}:null}Et(){return this.uh}$s(){return this.$u}_c(){return this.Ct}uc(){return this.Ku}cc(t,e){t.zl(e),this.pu()}Eo(t){this.Mo=t,this.uh.Eo(this.Mo),this.$u.forEach(e=>e.Eo(t)),this.pu()}dc(t){this.$u.length!==1&&(U(t>=0&&t<this.$u.length,"Invalid pane index"),this.$u.splice(t,1),this.Bh())}fc(t,e){if(this.$u.length<2)return;U(t>=0&&t<this.$u.length,"Invalid pane index");const i=this.$u[t],n=this.$u.reduce((d,f)=>d+f.Io(),0),r=this.$u.reduce((d,f)=>d+f.$t(),0),o=r-30*(this.$u.length-1);e=Math.min(o,Math.max(30,e));const h=n/r,a=i.$t();i.Bo(e*h);let l=e-a,c=this.$u.length-1;for(const d of this.$u)if(d!==i){const f=Math.min(o,Math.max(30,d.$t()-l/c));l-=d.$t()-f,c-=1;const g=f*h;d.Bo(g)}this.Bh()}vc(t,e){U(t>=0&&t<this.$u.length&&e>=0&&e<this.$u.length,"Invalid pane index");const i=this.$u[t],n=this.$u[e];this.$u[t]=n,this.$u[e]=i,this.Bh()}mc(t,e){if(U(t>=0&&t<this.$u.length&&e>=0&&e<this.$u.length,"Invalid pane index"),t===e)return;const[i]=this.$u.splice(t,1);this.$u.splice(e,0,i),this.Bh()}Uo(t,e,i){t.Uo(e,i)}$o(t,e,i){t.$o(e,i),this.Ah(),this.ec(this.wc(t,2))}qo(t,e){t.qo(e),this.ec(this.wc(t,2))}Yo(t,e,i){e.Rl()||t.Yo(e,i)}jo(t,e,i){e.Rl()||(t.jo(e,i),this.Ah(),this.ec(this.wc(t,2)))}Ko(t,e){e.Rl()||(t.Ko(e),this.ec(this.wc(t,2)))}Zo(t,e){t.Zo(e),this.ec(this.wc(t,2))}gc(t){this.uh.eo(t)}Mc(t,e){const i=this.Et();if(i.Ki()||e===0)return;const n=i.Qi();t=Math.max(1,Math.min(t,n)),i.xu(t,e),this.pu()}bc(t){this.Sc(0),this.xc(t),this.Cc()}Pc(t){this.uh.ro(t),this.pu()}kc(){this.uh.ho(),this.ar()}Sc(t){this.uh.ao(t)}xc(t){this.uh.lo(t),this.pu()}Cc(){this.uh.oo(),this.ar()}js(){return this.qu}yc(t,e,i,n,r){this.Ct.Vs(t,e);let o=NaN,h=this.uh.uu(t,!0);const a=this.uh.Pe();a!==null&&(h=Math.min(Math.max(a.Uh(),h),a.bi()));const l=n.ys(),c=l.zt();if(c!==null&&(o=l.Ts(e,c)),o=this.Ju.Ma(o,h,n),this.Ct.As(h,o,n),this.Zh(),!r){const d=Co(n,t,e);this.ac(d&&{n_:d.n_,e_:d.e_,h_:d.h_||null}),this.Ku.p(this.Ct.Bt(),{x:t,y:e},i)}}Tc(t,e,i){const n=i.ys(),r=n.zt(),o=n.Nt(t,_(r)),h=this.uh.J_(e,!0),a=this.uh.qt(_(h));this.yc(a,o,null,i,!0)}Rc(t){this._c().Ls(),this.Zh(),t||this.Ku.p(null,null,null)}Ah(){const t=this.Ct.Us();if(t!==null){const e=this.Ct.Bs(),i=this.Ct.Es();this.yc(e,i,null,t)}this.Ct.Ns()}Dc(t,e,i){const n=this.uh.Rs(0);e!==void 0&&i!==void 0&&this.uh.kt(e,i);const r=this.uh.Rs(0),o=this.uh.ou(),h=this.uh.Pe();if(h!==null&&n!==null&&r!==null){const a=h.Te(o),l=this.o_.key(n)>this.o_.key(r),c=t!==null&&t>o&&!l,d=this.uh.N().allowShiftVisibleRangeOnWhitespaceReplacement,f=a&&(i!==void 0||d)&&this.uh.N().shiftVisibleRangeOnNewBar;if(c&&!f){const g=t-o;this.uh.fn(this.uh.wu()-g)}}this.uh.Su(t)}Lh(t){t!==null&&t.Jo()}Hn(t){if(function(i){return i instanceof _n}(t))return t;const e=this.$u.find(i=>i.Dt().includes(t));return e===void 0?null:e}pu(){this.$u.forEach(t=>t.Jo()),this.Ah()}m(){this.$u.forEach(t=>t.m()),this.$u.length=0,this.Ps.localization.priceFormatter=void 0,this.Ps.localization.percentageFormatter=void 0,this.Ps.localization.timeFormatter=void 0}Vc(){return this.Gu}Yn(){return this.Gu.N()}Vo(){return this.ju}Ic(t,e){const i=this.Qu(e);this.Bc(t,i),this.qu.push(t),this.qu.length===1?this.Bh():this.ar()}Ec(t){const e=this.Hn(t),i=this.qu.indexOf(t);U(i!==-1,"Series not found");const n=_(e);this.qu.splice(i,1),n.io(t),t.m&&t.m(),this.uh.j_(),this.Ac(n)}Ih(t,e){const i=_(this.Hn(t));i.io(t,!0),i.Jl(t,e,!0)}Eu(){const t=q.wn();t.rn(),this.ec(t)}zc(t){const e=q.wn();e.ln(t),this.ec(e)}cn(){const t=q.wn();t.cn(),this.ec(t)}dn(t){const e=q.wn();e.dn(t),this.ec(e)}fn(t){const e=q.wn();e.fn(t),this.ec(e)}_n(t){const e=q.wn();e._n(t),this.ec(e)}hn(){const t=q.wn();t.hn(),this.ec(t)}Lc(){return this.Ps.rightPriceScale.visible?"right":"left"}Oc(t,e){if(U(e>=0,"Index should be greater or equal to 0"),e===this.Nc(t))return;const i=_(this.Hn(t));i.io(t);const n=this.Qu(e);this.Bc(t,n),i.ba().length===0&&this.Ac(i),this.Bh()}Fc(){return this.nc}$(){return this.tc}Ut(t){const e=this.nc,i=this.tc;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Xu===null||this.Xu.mr!==i||this.Xu.wr!==e)this.Xu={mr:i,wr:e,Wc:new Map};else{const r=this.Xu.Wc.get(t);if(r!==void 0)return r}const n=this.xl.tt(i,e,t/100);return this.Xu.Wc.set(t,n),n}Hc(t){return this.$u.indexOf(t)}Xi(){return this.xl}Uc(){return this.$c()}$c(t){const e=new _n(this.uh,this);this.$u.push(e);const i=t??this.$u.length-1,n=q.gn();return n.Qs(i,{tn:0,sn:!0}),this.ec(n),e}Qu(t){return U(t>=0,"Index should be greater or equal to 0"),(t=Math.min(this.$u.length,t))<this.$u.length?this.$u[t]:this.$c(t)}Nc(t){return this.$u.findIndex(e=>e.Oo().includes(t))}wc(t,e){const i=new q(e);if(t!==null){const n=this.$u.indexOf(t);i.Qs(n,{tn:e})}return i}rc(t,e){return e===void 0&&(e=2),this.wc(this.Hn(t),e)}ec(t){this.Zu&&this.Zu(t),this.$u.forEach(e=>e.i_().lr().kt())}Bc(t,e){const i=t.N().priceScaleId,n=i!==void 0?i:this.Lc();e.Jl(t,n),Li(n)||t.hr(t.N())}sc(t){const e=this.Ps.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}Ac(t){!t.Lo()&&t.ba().length===0&&this.$u.length>1&&this.$u.splice(this.Hc(t),1)}}function ws(s){return!ne(s)&&!Be(s)}function jo(s){return ne(s)}(function(s){s[s.Disabled=0]="Disabled",s[s.Continuous=1]="Continuous",s[s.OnDataUpdate=2]="OnDataUpdate"})(kn||(kn={})),function(s){s[s.LastBar=0]="LastBar",s[s.LastVisible=1]="LastVisible"}(Mn||(Mn={})),function(s){s.Solid="solid",s.VerticalGradient="gradient"}(_s||(_s={})),function(s){s[s.Year=0]="Year",s[s.Month=1]="Month",s[s.DayOfMonth=2]="DayOfMonth",s[s.Time=3]="Time",s[s.TimeWithSeconds=4]="TimeWithSeconds"}(Pn||(Pn={}));const Cn=s=>s.getUTCFullYear();function qa(s,t,e){return t.replace(/yyyy/g,(i=>yt(Cn(i),4))(s)).replace(/yy/g,(i=>yt(Cn(i)%100,2))(s)).replace(/MMMM/g,((i,n)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(n,{month:"long"}))(s,e)).replace(/MMM/g,((i,n)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(n,{month:"short"}))(s,e)).replace(/MM/g,(i=>yt((n=>n.getUTCMonth()+1)(i),2))(s)).replace(/dd/g,(i=>yt((n=>n.getUTCDate())(i),2))(s))}class Ro{constructor(t="yyyy-MM-dd",e="default"){this.qc=t,this.Yc=e}__(t){return qa(t,this.qc,this.Yc)}}class Ua{constructor(t){this.jc=t||"%h:%m:%s"}__(t){return this.jc.replace("%h",yt(t.getUTCHours(),2)).replace("%m",yt(t.getUTCMinutes(),2)).replace("%s",yt(t.getUTCSeconds(),2))}}const Xa={Kc:"yyyy-MM-dd",Xc:"%h:%m:%s",Zc:" ",Gc:"default"};class Qa{constructor(t={}){const e={...Xa,...t};this.Jc=new Ro(e.Kc,e.Gc),this.Qc=new Ua(e.Xc),this.td=e.Zc}__(t){return`${this.Jc.__(t)}${this.td}${this.Qc.__(t)}`}}function Xe(s){return 60*s*60*1e3}function Qi(s){return 60*s*1e3}const Qe=[{sd:(jn=1,1e3*jn),nd:10},{sd:Qi(1),nd:20},{sd:Qi(5),nd:21},{sd:Qi(30),nd:22},{sd:Xe(1),nd:30},{sd:Xe(3),nd:31},{sd:Xe(6),nd:32},{sd:Xe(12),nd:33}];var jn;function Rn(s,t){if(s.getUTCFullYear()!==t.getUTCFullYear())return 70;if(s.getUTCMonth()!==t.getUTCMonth())return 60;if(s.getUTCDate()!==t.getUTCDate())return 50;for(let e=Qe.length-1;e>=0;--e)if(Math.floor(t.getTime()/Qe[e].sd)!==Math.floor(s.getTime()/Qe[e].sd))return Qe[e].nd;return 0}function Ki(s){let t=s;if(Be(s)&&(t=Ns(s)),!ws(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{ed:Math.round(e.getTime()/1e3),rd:t}}function zn(s){if(!jo(s))throw new Error("time must be of type isUTCTimestamp");return{ed:s}}function Ns(s){const t=new Date(s);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${s}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function Dn(s){Be(s.time)&&(s.time=Ns(s.time))}class Tn{options(){return this.Ps}setOptions(t){this.Ps=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(e){e.forEach(Dn)}(t):Dn(t)}createConverterToInternalObj(t){return _(function(e){return e.length===0?null:ws(e[0].time)||Be(e[0].time)?Ki:zn}(t))}key(t){return typeof t=="object"&&"ed"in t?t.ed:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.rd===void 0?new Date(1e3*e.ed).getTime():new Date(Date.UTC(e.rd.year,e.rd.month-1,e.rd.day)).getTime()}convertHorzItemToInternal(t){return jo(e=t)?zn(e):ws(e)?Ki(e):Ki(Ns(e));var e}updateFormatter(t){if(!this.Ps)return;const e=t.dateFormat;this.Ps.timeScale.timeVisible?this.hd=new Qa({Kc:e,Xc:this.Ps.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Zc:"   ",Gc:t.locale}):this.hd=new Ro(e,t.locale)}formatHorzItem(t){const e=t;return this.hd.__(new Date(1e3*e.ed))}formatTickmark(t,e){const i=function(r,o,h){switch(r){case 0:case 10:return o?h?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.Ps.timeScale.timeVisible,this.Ps.timeScale.secondsVisible),n=this.Ps.timeScale;if(n.tickMarkFormatter!==void 0){const r=n.tickMarkFormatter(t.originalTime,i,e.locale);if(r!==null)return r}return function(r,o,h){const a={};switch(o){case 0:a.year="numeric";break;case 1:a.month="short";break;case 2:a.day="numeric";break;case 3:a.hour12=!1,a.hour="2-digit",a.minute="2-digit";break;case 4:a.hour12=!1,a.hour="2-digit",a.minute="2-digit",a.second="2-digit"}const l=r.rd===void 0?new Date(1e3*r.ed):new Date(Date.UTC(r.rd.year,r.rd.month-1,r.rd.day));return new Date(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate(),l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()).toLocaleString(h,a)}(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(Ya,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(i,n=0){if(i.length===0)return;let r=n===0?null:i[n-1].time.ed,o=r!==null?new Date(1e3*r):null,h=0;for(let a=n;a<i.length;++a){const l=i[a],c=new Date(1e3*l.time.ed);o!==null&&(l.timeWeight=Rn(c,o)),h+=l.time.ed-(r||l.time.ed),r=l.time.ed,o=c}if(n===0&&i.length>1){const a=Math.ceil(h/(i.length-1)),l=new Date(1e3*(i[0].time.ed-a));i[0].timeWeight=Rn(new Date(1e3*i[0].time.ed),l)}})(t,e)}static ad(t){return it({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const oe=typeof window<"u";function En(){return!!oe&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Gi(){return!!oe&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Ss(s){return s+s%2}function Ka(s){oe&&window.chrome!==void 0&&s.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class Ai{constructor(t,e,i){this.ld=0,this.od=null,this._d={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.ud=0,this.dd=null,this.fd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.pd=null,this.vd=!1,this.md=null,this.wd=null,this.gd=!1,this.Md=!1,this.bd=!1,this.Sd=null,this.xd=null,this.Cd=null,this.Pd=null,this.kd=null,this.yd=null,this.Td=null,this.Rd=0,this.Dd=!1,this.Vd=!1,this.Id=!1,this.Bd=0,this.Ed=null,this.Ad=!Gi(),this.zd=n=>{this.Ld(n)},this.Od=n=>{if(this.Nd(n)){const r=this.Fd(n);if(++this.ud,this.dd&&this.ud>1){const{Wd:o}=this.Hd(dt(n),this.fd);o<30&&!this.bd&&this.Ud(r,this.qd.$d),this.Yd()}}else{const r=this.Fd(n);if(++this.ld,this.od&&this.ld>1){const{Wd:o}=this.Hd(dt(n),this._d);o<5&&!this.Md&&this.jd(r,this.qd.Kd),this.Xd()}}},this.Zd=t,this.qd=e,this.Ps=i,this.Gd()}m(){this.Sd!==null&&(this.Sd(),this.Sd=null),this.xd!==null&&(this.xd(),this.xd=null),this.Pd!==null&&(this.Pd(),this.Pd=null),this.kd!==null&&(this.kd(),this.kd=null),this.yd!==null&&(this.yd(),this.yd=null),this.Cd!==null&&(this.Cd(),this.Cd=null),this.Jd(),this.Xd()}Qd(t){this.Pd&&this.Pd();const e=this.tf.bind(this);if(this.Pd=()=>{this.Zd.removeEventListener("mousemove",e)},this.Zd.addEventListener("mousemove",e),this.Nd(t))return;const i=this.Fd(t);this.jd(i,this.qd.if),this.Ad=!0}Xd(){this.od!==null&&clearTimeout(this.od),this.ld=0,this.od=null,this._d={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Yd(){this.dd!==null&&clearTimeout(this.dd),this.ud=0,this.dd=null,this.fd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}tf(t){if(this.Id||this.wd!==null||this.Nd(t))return;const e=this.Fd(t);this.jd(e,this.qd.sf),this.Ad=!0}nf(t){const e=Zi(t.changedTouches,_(this.Ed));if(e===null||(this.Bd=Ke(t),this.Td!==null)||this.Vd)return;this.Dd=!0;const i=this.Hd(dt(e),_(this.wd)),{ef:n,rf:r,Wd:o}=i;if(this.gd||!(o<5)){if(!this.gd){const h=.5*n,a=r>=h&&!this.Ps.hf(),l=h>r&&!this.Ps.af();a||l||(this.Vd=!0),this.gd=!0,this.bd=!0,this.Jd(),this.Yd()}if(!this.Vd){const h=this.Fd(t,e);this.Ud(h,this.qd.lf),Kt(t)}}}_f(t){if(t.button!==0)return;const e=this.Hd(dt(t),_(this.md)),{Wd:i}=e;if(i>=5&&(this.Md=!0,this.Xd()),this.Md){const n=this.Fd(t);this.jd(n,this.qd.uf)}}Hd(t,e){const i=Math.abs(e._t-t._t),n=Math.abs(e.ut-t.ut);return{ef:i,rf:n,Wd:i+n}}cf(t){let e=Zi(t.changedTouches,_(this.Ed));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.Ed=null,this.Bd=Ke(t),this.Jd(),this.wd=null,this.yd&&(this.yd(),this.yd=null);const i=this.Fd(t,e);if(this.Ud(i,this.qd.df),++this.ud,this.dd&&this.ud>1){const{Wd:n}=this.Hd(dt(e),this.fd);n<30&&!this.bd&&this.Ud(i,this.qd.$d),this.Yd()}else this.bd||(this.Ud(i,this.qd.ff),this.qd.ff&&Kt(t));this.ud===0&&Kt(t),t.touches.length===0&&this.vd&&(this.vd=!1,Kt(t))}Ld(t){if(t.button!==0)return;const e=this.Fd(t);if(this.md=null,this.Id=!1,this.kd&&(this.kd(),this.kd=null),En()&&this.Zd.ownerDocument.documentElement.removeEventListener("mouseleave",this.zd),!this.Nd(t))if(this.jd(e,this.qd.pf),++this.ld,this.od&&this.ld>1){const{Wd:i}=this.Hd(dt(t),this._d);i<5&&!this.Md&&this.jd(e,this.qd.Kd),this.Xd()}else this.Md||this.jd(e,this.qd.vf)}Jd(){this.pd!==null&&(clearTimeout(this.pd),this.pd=null)}mf(t){if(this.Ed!==null)return;const e=t.changedTouches[0];this.Ed=e.identifier,this.Bd=Ke(t);const i=this.Zd.ownerDocument.documentElement;this.bd=!1,this.gd=!1,this.Vd=!1,this.wd=dt(e),this.yd&&(this.yd(),this.yd=null);{const r=this.nf.bind(this),o=this.cf.bind(this);this.yd=()=>{i.removeEventListener("touchmove",r),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",r,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this.Jd(),this.pd=setTimeout(this.wf.bind(this,t),240)}const n=this.Fd(t,e);this.Ud(n,this.qd.gf),this.dd||(this.ud=0,this.dd=setTimeout(this.Yd.bind(this),500),this.fd=dt(e))}Mf(t){if(t.button!==0)return;const e=this.Zd.ownerDocument.documentElement;En()&&e.addEventListener("mouseleave",this.zd),this.Md=!1,this.md=dt(t),this.kd&&(this.kd(),this.kd=null);{const n=this._f.bind(this),r=this.Ld.bind(this);this.kd=()=>{e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",n),e.addEventListener("mouseup",r)}if(this.Id=!0,this.Nd(t))return;const i=this.Fd(t);this.jd(i,this.qd.bf),this.od||(this.ld=0,this.od=setTimeout(this.Xd.bind(this),500),this._d=dt(t))}Gd(){this.Zd.addEventListener("mouseenter",this.Qd.bind(this)),this.Zd.addEventListener("touchcancel",this.Jd.bind(this));{const t=this.Zd.ownerDocument,e=i=>{this.qd.Sf&&(i.composed&&this.Zd.contains(i.composedPath()[0])||i.target&&this.Zd.contains(i.target)||this.qd.Sf())};this.xd=()=>{t.removeEventListener("touchstart",e)},this.Sd=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}Gi()&&(this.Cd=()=>{this.Zd.removeEventListener("dblclick",this.Od)},this.Zd.addEventListener("dblclick",this.Od)),this.Zd.addEventListener("mouseleave",this.xf.bind(this)),this.Zd.addEventListener("touchstart",this.mf.bind(this),{passive:!0}),Ka(this.Zd),this.Zd.addEventListener("mousedown",this.Mf.bind(this)),this.Cf(),this.Zd.addEventListener("touchmove",()=>{},{passive:!1})}Cf(){this.qd.Pf===void 0&&this.qd.kf===void 0&&this.qd.yf===void 0||(this.Zd.addEventListener("touchstart",t=>this.Tf(t.touches),{passive:!0}),this.Zd.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.Td!==null&&this.qd.kf!==void 0){const e=Ln(t.touches[0],t.touches[1])/this.Rd;this.qd.kf(this.Td,e),Kt(t)}},{passive:!1}),this.Zd.addEventListener("touchend",t=>{this.Tf(t.touches)}))}Tf(t){t.length===1&&(this.Dd=!1),t.length!==2||this.Dd||this.vd?this.Rf():this.Df(t)}Df(t){const e=this.Zd.getBoundingClientRect()||{left:0,top:0};this.Td={_t:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,ut:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Rd=Ln(t[0],t[1]),this.qd.Pf!==void 0&&this.qd.Pf(),this.Jd()}Rf(){this.Td!==null&&(this.Td=null,this.qd.yf!==void 0&&this.qd.yf())}xf(t){if(this.Pd&&this.Pd(),this.Nd(t)||!this.Ad)return;const e=this.Fd(t);this.jd(e,this.qd.Vf),this.Ad=!Gi()}wf(t){const e=Zi(t.touches,_(this.Ed));if(e===null)return;const i=this.Fd(t,e);this.Ud(i,this.qd.If),this.bd=!0,this.vd=!0}Nd(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:Ke(t)<this.Bd+500}Ud(t,e){e&&e.call(this.qd,t)}jd(t,e){e&&e.call(this.qd,t)}Fd(t,e){const i=e||t,n=this.Zd.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-n.left,localY:i.clientY-n.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Bf:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",Ef:t.type,Af:i.target,a_:t.view,zf:()=>{t.type!=="touchstart"&&Kt(t)}}}}function Ln(s,t){const e=s.clientX-t.clientX,i=s.clientY-t.clientY;return Math.sqrt(e*e+i*i)}function Kt(s){s.cancelable&&s.preventDefault()}function dt(s){return{_t:s.pageX,ut:s.pageY}}function Ke(s){return s.timeStamp||performance.now()}function Zi(s,t){for(let e=0;e<s.length;++e)if(s[e].identifier===t)return s[e];return null}class Ga{constructor(t,e,i){this.Lf=null,this.Of=null,this.Nf=!0,this.Ff=null,this.Wf=t,this.Hf=t.Uf()[e],this.$f=t.Uf()[i],this.qf=document.createElement("tr"),this.qf.style.height="1px",this.Yf=document.createElement("td"),this.Yf.style.position="relative",this.Yf.style.padding="0",this.Yf.style.margin="0",this.Yf.setAttribute("colspan","3"),this.jf(),this.qf.appendChild(this.Yf),this.Nf=this.Wf.N().layout.panes.enableResize,this.Nf?this.Kf():(this.Lf=null,this.Of=null)}m(){this.Of!==null&&this.Of.m()}Xf(){return this.qf}Zf(){return O({width:this.Hf.Zf().width,height:1})}Gf(){return O({width:this.Hf.Gf().width,height:1*window.devicePixelRatio})}Jf(t,e,i){const n=this.Gf();t.fillStyle=this.Wf.N().layout.panes.separatorColor,t.fillRect(e,i,n.width,n.height)}kt(){this.jf(),this.Wf.N().layout.panes.enableResize!==this.Nf&&(this.Nf=this.Wf.N().layout.panes.enableResize,this.Nf?this.Kf():(this.Lf!==null&&(this.Yf.removeChild(this.Lf.Qf),this.Yf.removeChild(this.Lf.tp),this.Lf=null),this.Of!==null&&(this.Of.m(),this.Of=null)))}Kf(){const t=document.createElement("div"),e=t.style;e.position="fixed",e.display="none",e.zIndex="49",e.top="0",e.left="0",e.width="100%",e.height="100%",e.cursor="row-resize",this.Yf.appendChild(t);const i=document.createElement("div"),n=i.style;n.position="absolute",n.zIndex="50",n.top="-4px",n.height="9px",n.width="100%",n.backgroundColor="",n.cursor="row-resize",this.Yf.appendChild(i);const r={if:this.ip.bind(this),Vf:this.sp.bind(this),bf:this.np.bind(this),gf:this.np.bind(this),uf:this.ep.bind(this),lf:this.ep.bind(this),pf:this.rp.bind(this),df:this.rp.bind(this)};this.Of=new Ai(i,r,{hf:()=>!1,af:()=>!0}),this.Lf={tp:i,Qf:t}}jf(){this.Yf.style.background=this.Wf.N().layout.panes.separatorColor}ip(t){this.Lf!==null&&(this.Lf.tp.style.backgroundColor=this.Wf.N().layout.panes.separatorHoverColor)}sp(t){this.Lf!==null&&this.Ff===null&&(this.Lf.tp.style.backgroundColor="")}np(t){if(this.Lf===null)return;const e=this.Hf.hp().Io()+this.$f.hp().Io(),i=e/(this.Hf.Zf().height+this.$f.Zf().height),n=30*i;e<=2*n||(this.Ff={ap:t.pageY,lp:this.Hf.hp().Io(),op:e-n,_p:e,up:i,cp:n},this.Lf.Qf.style.display="block")}ep(t){const e=this.Ff;if(e===null)return;const i=(t.pageY-e.ap)*e.up,n=Me(e.lp+i,e.cp,e.op);this.Hf.hp().Bo(n),this.$f.hp().Bo(e._p-n),this.Wf.Qt().Bh()}rp(t){this.Ff!==null&&this.Lf!==null&&(this.Ff=null,this.Lf.Qf.style.display="none")}}function Ji(s,t){return s.dp-t.dp}function ts(s,t,e){const i=(s.dp-t.dp)/(s.wt-t.wt);return Math.sign(i)*Math.min(Math.abs(i),e)}class Za{constructor(t,e,i,n){this.fp=null,this.pp=null,this.vp=null,this.mp=null,this.wp=null,this.gp=0,this.Mp=0,this.bp=t,this.Sp=e,this.xp=i,this.Mn=n}Cp(t,e){if(this.fp!==null){if(this.fp.wt===e)return void(this.fp.dp=t);if(Math.abs(this.fp.dp-t)<this.Mn)return}this.mp=this.vp,this.vp=this.pp,this.pp=this.fp,this.fp={wt:e,dp:t}}le(t,e){if(this.fp===null||this.pp===null||e-this.fp.wt>50)return;let i=0;const n=ts(this.fp,this.pp,this.Sp),r=Ji(this.fp,this.pp),o=[n],h=[r];if(i+=r,this.vp!==null){const l=ts(this.pp,this.vp,this.Sp);if(Math.sign(l)===Math.sign(n)){const c=Ji(this.pp,this.vp);if(o.push(l),h.push(c),i+=c,this.mp!==null){const d=ts(this.vp,this.mp,this.Sp);if(Math.sign(d)===Math.sign(n)){const f=Ji(this.vp,this.mp);o.push(d),h.push(f),i+=f}}}}let a=0;for(let l=0;l<o.length;++l)a+=h[l]/i*o[l];Math.abs(a)<this.bp||(this.wp={dp:t,wt:e},this.Mp=a,this.gp=function(l,c){const d=Math.log(c);return Math.log(1*d/-l)/d}(Math.abs(a),this.xp))}Ru(t){const e=_(this.wp),i=t-e.wt;return e.dp+this.Mp*(Math.pow(this.xp,i)-1)/Math.log(this.xp)}Tu(t){return this.wp===null||this.Pp(t)===this.gp}Pp(t){const e=t-_(this.wp).wt;return Math.min(e,this.gp)}}class Ja{constructor(t,e){this.kp=void 0,this.yp=void 0,this.Tp=void 0,this.ps=!1,this.Rp=t,this.Dp=e,this.Vp()}kt(){this.Vp()}Ip(){this.kp&&this.Rp.removeChild(this.kp),this.yp&&this.Rp.removeChild(this.yp),this.kp=void 0,this.yp=void 0}Bp(){return this.ps!==this.Ep()||this.Tp!==this.Ap()}Ap(){return this.Dp.Qt().Xi().J(this.Dp.N().layout.textColor)>160?"dark":"light"}Ep(){return this.Dp.N().layout.attributionLogo}zp(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Vp(){this.Bp()&&(this.Ip(),this.ps=this.Ep(),this.ps&&(this.Tp=this.Ap(),this.yp=document.createElement("style"),this.yp.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.kp=document.createElement("a"),this.kp.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.zp()}`,this.kp.title="Charting by TradingView",this.kp.id="tv-attr-logo",this.kp.target="_blank",this.kp.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.kp.toggleAttribute("data-dark",this.Tp==="dark"),this.Rp.appendChild(this.yp),this.Rp.appendChild(this.kp)))}}function qt(s,t){const e=_(s.ownerDocument).createElement("canvas");s.appendChild(e);const i=Bh(e,{options:{allowResizeObserver:!0},transform:(n,r)=>({width:Math.max(n.width,r.width),height:Math.max(n.height,r.height)})});return i.resizeCanvasElement(t),i}function Ut(s){var t;s.width=1,s.height=1,(t=s.getContext("2d"))==null||t.clearRect(0,0,1,1)}function ks(s,t,e,i){s.ih&&s.ih(t,e,i)}function ci(s,t,e,i){s.nt(t,e,i)}function Ms(s,t,e,i){const n=s(e,i);for(const r of n){const o=r.Tt(i);o!==null&&t(o)}}function es(s,t){return e=>{var i,n;return function(r){return r.Ft!==void 0}(e)?(((i=e.Ft())==null?void 0:i.wa())??"")!==t?[]:((n=e.ta)==null?void 0:n.call(e,s))??[]:[]}}function Fn(s,t,e,i){if(!s.length)return;let n=0;const r=s[0].$t(i,!0);let o=t===1?e/2-(s[0].Fi()-r/2):s[0].Fi()-r/2-e/2;o=Math.max(0,o);for(let h=1;h<s.length;h++){const a=s[h],l=s[h-1],c=l.$t(i,!1),d=a.Fi(),f=l.Fi();if(t===1?d>f-c:d<f+c){const g=f-c*t;a.Wi(g);const p=g-t*c/2;if((t===1?p<0:p>e)&&o>0){const m=t===1?-1-p:p-e,x=Math.min(m,o);for(let b=n;b<s.length;b++)s[b].Wi(s[b].Fi()+t*x);o-=x}}else n=h,o=t===1?f-c-d:d-(f+c)}}class On{constructor(t,e,i,n){this.Yi=null,this.Lp=null,this.Op=!1,this.Np=new vi(200),this.Fp=null,this.Wp=0,this.Hp=!1,this.Up=()=>{this.Hp||this.Pt.$p().Qt().ar()},this.qp=()=>{this.Hp||this.Pt.$p().Qt().ar()},this.Pt=t,this.Ps=e,this.bl=e.layout,this.Gu=i,this.Yp=n==="left",this.jp=es("normal",n),this.Kp=es("top",n),this.Xp=es("bottom",n),this.Yf=document.createElement("div"),this.Yf.style.height="100%",this.Yf.style.overflow="hidden",this.Yf.style.width="25px",this.Yf.style.left="0",this.Yf.style.position="relative",this.Zp=qt(this.Yf,O({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const r=this.Zp.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Gp=qt(this.Yf,O({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const o=this.Gp.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const h={bf:this.np.bind(this),gf:this.np.bind(this),uf:this.ep.bind(this),lf:this.ep.bind(this),Sf:this.Jp.bind(this),pf:this.rp.bind(this),df:this.rp.bind(this),Kd:this.Qp.bind(this),$d:this.Qp.bind(this),if:this.tv.bind(this),Vf:this.sp.bind(this)};this.Of=new Ai(this.Gp.canvasElement,h,{hf:()=>!this.Ps.handleScroll.vertTouchDrag,af:()=>!0})}m(){this.Of.m(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),Ut(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Ut(this.Zp.canvasElement),this.Zp.dispose(),this.Yi!==null&&this.Yi.no().u(this),this.Yi=null}Xf(){return this.Yf}P(){return this.bl.fontSize}iv(){const t=this.Gu.N();return this.Fp!==t.k&&(this.Np.In(),this.Fp=t.k),t}sv(){if(this.Yi===null)return 0;let t=0;const e=this.iv(),i=_(this.Zp.canvasElement.getContext("2d",{colorSpace:this.Pt.$p().N().layout.colorSpace}));i.save();const n=this.Yi.Va();i.font=this.nv(),n.length>0&&(t=Math.max(this.Np.Vi(i,n[0].Ga),this.Np.Vi(i,n[n.length-1].Ga)));const r=this.ev();for(let l=r.length;l--;){const c=this.Np.Vi(i,r[l].ri());c>t&&(t=c)}const o=this.Yi.zt();if(o!==null&&this.Lp!==null&&(h=this.Ps.crosshair).mode!==2&&h.horzLine.visible&&h.horzLine.labelVisible){const l=this.Yi.Ts(1,o),c=this.Yi.Ts(this.Lp.height-2,o);t=Math.max(t,this.Np.Vi(i,this.Yi.Zi(Math.floor(Math.min(l,c))+.11111111111111,o)),this.Np.Vi(i,this.Yi.Zi(Math.ceil(Math.max(l,c))-.11111111111111,o)))}var h;i.restore();const a=t||34;return Ss(Math.ceil(e.S+e.C+e.I+e.B+5+a))}rv(t){this.Lp!==null&&Yt(this.Lp,t)||(this.Lp=t,this.Hp=!0,this.Zp.resizeCanvasElement(t),this.Gp.resizeCanvasElement(t),this.Hp=!1,this.Yf.style.width=`${t.width}px`,this.Yf.style.height=`${t.height}px`)}hv(){return _(this.Lp).width}_s(t){this.Yi!==t&&(this.Yi!==null&&this.Yi.no().u(this),this.Yi=t,t.no().i(this.ul.bind(this),this))}Ft(){return this.Yi}In(){const t=this.Pt.hp();this.Pt.$p().Qt().Zo(t,_(this.Ft()))}av(t){if(this.Lp===null)return;const e={colorSpace:this.Pt.$p().N().layout.colorSpace};if(t!==1){this.lv(),this.Zp.applySuggestedBitmapSize();const n=Ht(this.Zp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this.ov(r),this._v(r)}),this.Pt.uv(n,this.Xp),this.cv(n),this.Pt.uv(n,this.jp),this.dv(n))}this.Gp.applySuggestedBitmapSize();const i=Ht(this.Gp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.fv(i),this.Pt.uv(i,this.Kp))}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const n=this.Gf();n.width>0&&n.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}kt(){var t;(t=this.Yi)==null||t.Va()}np(t){if(this.Yi===null||this.Yi.Ki()||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.$p().Qt(),i=this.Pt.hp();this.Op=!0,e.Uo(i,this.Yi,t.localY)}ep(t){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.$p().Qt(),i=this.Pt.hp(),n=this.Yi;e.$o(i,n,t.localY)}Jp(){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const t=this.Pt.$p().Qt(),e=this.Pt.hp(),i=this.Yi;this.Op&&(this.Op=!1,t.qo(e,i))}rp(t){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.$p().Qt(),i=this.Pt.hp();this.Op=!1,e.qo(i,this.Yi)}Qp(t){this.Ps.handleScale.axisDoubleClickReset.price&&this.In()}tv(t){this.Yi!==null&&(!this.Pt.$p().Qt().N().handleScale.axisPressedMouseMove.price||this.Yi.Le()||this.Yi.Vl()||this.pv(1))}sp(t){this.pv(0)}ev(){const t=[],e=this.Yi===null?void 0:this.Yi;return(i=>{for(let n=0;n<i.length;++n){const r=i[n].Ws(this.Pt.hp(),e);for(let o=0;o<r.length;o++)t.push(r[o])}})(this.Pt.hp().Dt()),t}ov({context:t,bitmapSize:e}){const{width:i,height:n}=e,r=this.Pt.hp().Qt(),o=r.$(),h=r.Fc();o===h?Ti(t,0,0,i,n,o):mo(t,0,0,i,n,o,h)}_v({context:t,bitmapSize:e,horizontalPixelRatio:i}){if(this.Lp===null||this.Yi===null||!this.Yi.N().borderVisible)return;t.fillStyle=this.Yi.N().borderColor;const n=Math.max(1,Math.floor(this.iv().S*i));let r;r=this.Yp?e.width-n:0,t.fillRect(r,0,n,e.height)}cv(t){if(this.Lp===null||this.Yi===null)return;const e=this.Yi.Va(),i=this.Yi.N(),n=this.iv(),r=this.Yp?this.Lp.width-n.C:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:h,verticalPixelRatio:a})=>{o.fillStyle=i.borderColor;const l=Math.max(1,Math.floor(a)),c=Math.floor(.5*a),d=Math.round(n.C*h);o.beginPath();for(const f of e)o.rect(Math.floor(r*h),Math.round(f.ka*a)-c,d,l);o.fill()}),t.useMediaCoordinateSpace(({context:o})=>{o.font=this.nv(),o.fillStyle=i.textColor??this.bl.textColor,o.textAlign=this.Yp?"right":"left",o.textBaseline="middle";const h=this.Yp?Math.round(r-n.I):Math.round(r+n.C+n.I),a=e.map(l=>this.Np.Di(o,l.Ga));for(let l=e.length;l--;){const c=e[l];o.fillText(c.Ga,h,c.ka+a[l])}})}lv(){if(this.Lp===null||this.Yi===null)return;let t=this.Lp.height/2;const e=[],i=this.Yi.Dt().slice(),n=this.Pt.hp(),r=this.iv();this.Yi===n.$n()&&this.Pt.hp().Dt().forEach(a=>{n.Un(a)&&i.push(a)});const o=this.Yi.ba()[0],h=this.Yi;i.forEach(a=>{const l=a.Ws(n,h);l.forEach(c=>{c.Wi(null),c.Hi()&&e.push(c)}),o===a&&l.length>0&&(t=l[0].Bi())}),e.forEach(a=>a.Wi(a.Bi())),this.Yi.N().alignLabels&&this.vv(e,r,t)}vv(t,e,i){if(this.Lp===null)return;const n=t.filter(o=>o.Bi()<=i),r=t.filter(o=>o.Bi()>i);n.sort((o,h)=>h.Bi()-o.Bi()),n.length&&r.length&&r.push(n[0]),r.sort((o,h)=>o.Bi()-h.Bi());for(const o of t){const h=Math.floor(o.$t(e)/2),a=o.Bi();a>-h&&a<h&&o.Wi(h),a>this.Lp.height-h&&a<this.Lp.height+h&&o.Wi(this.Lp.height-h)}Fn(n,1,this.Lp.height,e),Fn(r,-1,this.Lp.height,e)}dv(t){if(this.Lp===null)return;const e=this.ev(),i=this.iv(),n=this.Yp?"right":"left";e.forEach(r=>{r.Ui()&&r.Tt(_(this.Yi)).nt(t,i,this.Np,n)})}fv(t){if(this.Lp===null||this.Yi===null)return;const e=this.Pt.$p().Qt(),i=[],n=this.Pt.hp(),r=e._c().Ws(n,this.Yi);r.length&&i.push(r);const o=this.iv(),h=this.Yp?"right":"left";i.forEach(a=>{a.forEach(l=>{l.Tt(_(this.Yi)).nt(t,o,this.Np,h)})})}pv(t){this.Yf.style.cursor=t===1?"ns-resize":"default"}ul(){const t=this.sv();this.Wp<t&&this.Pt.$p().Qt().Bh(),this.Wp=t}nv(){return bi(this.bl.fontSize,this.bl.fontFamily)}}function tl(s,t){var e;return((e=s.Jh)==null?void 0:e.call(s,t))??[]}function An(s,t){var e;return((e=s.Fs)==null?void 0:e.call(s,t))??[]}function Nn(s,t){var e;return((e=s.us)==null?void 0:e.call(s,t))??[]}function el(s,t){var e;return((e=s.Xh)==null?void 0:e.call(s,t))??[]}class Bs{constructor(t,e){this.Lp=O({width:0,height:0}),this.mv=null,this.wv=null,this.gv=null,this.Mv=null,this.bv=!1,this.Sv=new W,this.xv=new W,this.Cv=0,this.Pv=!1,this.kv=null,this.yv=!1,this.Tv=null,this.Rv=null,this.Hp=!1,this.Up=()=>{this.Hp||this.Dv===null||this.ts().ar()},this.qp=()=>{this.Hp||this.Dv===null||this.ts().ar()},this.Dp=t,this.Dv=e,this.Dv.t_().i(this.Vv.bind(this),this,!0),this.Iv=document.createElement("td"),this.Iv.style.padding="0",this.Iv.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.Bv=document.createElement("td"),this.Bv.style.padding="0",this.Ev=document.createElement("td"),this.Ev.style.padding="0",this.Iv.appendChild(i),this.Zp=qt(i,O({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const n=this.Zp.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Gp=qt(i,O({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const r=this.Gp.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.qf=document.createElement("tr"),this.qf.appendChild(this.Bv),this.qf.appendChild(this.Iv),this.qf.appendChild(this.Ev),this.Av(),this.Of=new Ai(this.Gp.canvasElement,this,{hf:()=>this.kv===null&&!this.Dp.N().handleScroll.vertTouchDrag,af:()=>this.kv===null&&!this.Dp.N().handleScroll.horzTouchDrag})}m(){this.mv!==null&&this.mv.m(),this.wv!==null&&this.wv.m(),this.gv=null,this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),Ut(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Ut(this.Zp.canvasElement),this.Zp.dispose(),this.Dv!==null&&(this.Dv.t_().u(this),this.Dv.m()),this.Of.m()}hp(){return _(this.Dv)}zv(t){var e;this.Dv!==null&&this.Dv.t_().u(this),this.Dv=t,this.Dv!==null&&this.Dv.t_().i(Bs.prototype.Vv.bind(this),this,!0),this.Av(),this.Dp.Uf().indexOf(this)===this.Dp.Uf().length-1?(this.gv=this.gv??new Ja(this.Iv,this.Dp),this.gv.kt()):((e=this.gv)==null||e.Ip(),this.gv=null)}$p(){return this.Dp}Xf(){return this.qf}Av(){if(this.Dv!==null&&(this.Lv(),this.ts().js().length!==0)){if(this.mv!==null){const t=this.Dv.Wo();this.mv._s(_(t))}if(this.wv!==null){const t=this.Dv.Ho();this.wv._s(_(t))}}}Ov(){this.mv!==null&&this.mv.kt(),this.wv!==null&&this.wv.kt()}Io(){return this.Dv!==null?this.Dv.Io():0}Bo(t){this.Dv&&this.Dv.Bo(t)}if(t){if(!this.Dv)return;this.Nv();const e=t.localX,i=t.localY;this.Fv(e,i,t)}bf(t){this.Nv(),this.Wv(),this.Fv(t.localX,t.localY,t)}sf(t){if(!this.Dv)return;this.Nv();const e=t.localX,i=t.localY;this.Fv(e,i,t)}vf(t){this.Dv!==null&&(this.Nv(),this.Hv(t))}Kd(t){this.Dv!==null&&this.Uv(this.xv,t)}$d(t){this.Kd(t)}uf(t){this.Nv(),this.$v(t),this.Fv(t.localX,t.localY,t)}pf(t){this.Dv!==null&&(this.Nv(),this.Pv=!1,this.qv(t))}ff(t){this.Dv!==null&&this.Hv(t)}If(t){if(this.Pv=!0,this.kv===null){const e={x:t.localX,y:t.localY};this.Yv(e,e,t)}}Vf(t){this.Dv!==null&&(this.Nv(),this.Dv.Qt().ac(null),this.jv())}Kv(){return this.Sv}Xv(){return this.xv}Pf(){this.Cv=1,this.ts().hn()}kf(t,e){if(!this.Dp.N().handleScale.pinch)return;const i=5*(e-this.Cv);this.Cv=e,this.ts().Mc(t._t,i)}gf(t){this.Pv=!1,this.yv=this.kv!==null,this.Wv();const e=this.ts()._c();this.kv!==null&&e.Vt()&&(this.Tv={x:e.si(),y:e.ni()},this.kv={x:t.localX,y:t.localY})}lf(t){if(this.Dv===null)return;const e=t.localX,i=t.localY;if(this.kv===null)this.$v(t);else{this.yv=!1;const n=_(this.Tv),r=n.x+(e-this.kv.x),o=n.y+(i-this.kv.y);this.Fv(r,o,t)}}df(t){this.$p().N().trackingMode.exitMode===0&&(this.yv=!0),this.Zv(),this.qv(t)}jn(t,e){const i=this.Dv;return i===null?null:Co(i,t,e)}Gv(t,e){_(e==="left"?this.mv:this.wv).rv(O({width:t,height:this.Lp.height}))}Zf(){return this.Lp}rv(t){Yt(this.Lp,t)||(this.Lp=t,this.Hp=!0,this.Zp.resizeCanvasElement(t),this.Gp.resizeCanvasElement(t),this.Hp=!1,this.Iv.style.width=t.width+"px",this.Iv.style.height=t.height+"px")}Jv(){const t=_(this.Dv);t.Fo(t.Wo()),t.Fo(t.Ho());for(const e of t.ba())if(t.Un(e)){const i=e.Ft();i!==null&&t.Fo(i),e.Ns()}for(const e of t.s_())e.Ns()}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const n=this.Gf();n.width>0&&n.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}av(t){if(t===0||this.Dv===null)return;t>1&&this.Jv(),this.mv!==null&&this.mv.av(t),this.wv!==null&&this.wv.av(t);const e={colorSpace:this.Dp.N().layout.colorSpace};if(t!==1){this.Zp.applySuggestedBitmapSize();const n=Ht(this.Zp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this.ov(r)}),this.Dv&&(this.Qv(n,tl),this.tm(n),this.Qv(n,An),this.Qv(n,Nn)))}this.Gp.applySuggestedBitmapSize();const i=Ht(this.Gp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.im(i),this.Qv(i,el),this.Qv(i,Nn))}sm(){return this.mv}nm(){return this.wv}uv(t,e){this.Qv(t,e)}Vv(){this.Dv!==null&&this.Dv.t_().u(this),this.Dv=null}Hv(t){this.Uv(this.Sv,t)}Uv(t,e){const i=e.localX,n=e.localY;t.v()&&t.p(this.ts().Et().uu(i),{x:i,y:n},e)}ov({context:t,bitmapSize:e}){const{width:i,height:n}=e,r=this.ts(),o=r.$(),h=r.Fc();o===h?Ti(t,0,0,i,n,h):mo(t,0,0,i,n,o,h)}tm(t){const e=_(this.Dv),i=e.i_().lr().Tt(e);i!==null&&i.nt(t,!1)}im(t){this.rm(t,An,ci,this.ts()._c())}Qv(t,e){const i=_(this.Dv),n=i.Dt(),r=i.s_();for(const o of r)this.rm(t,e,ks,o);for(const o of n)this.rm(t,e,ks,o);for(const o of r)this.rm(t,e,ci,o);for(const o of n)this.rm(t,e,ci,o)}rm(t,e,i,n){const r=_(this.Dv),o=r.Qt().hc(),h=o!==null&&o.n_===n,a=o!==null&&h&&o.e_!==void 0?o.e_.Xn:void 0;Ms(e,l=>i(l,t,h,a),n,r)}Lv(){if(this.Dv===null)return;const t=this.Dp,e=this.Dv.Wo().N().visible,i=this.Dv.Ho().N().visible;e||this.mv===null||(this.Bv.removeChild(this.mv.Xf()),this.mv.m(),this.mv=null),i||this.wv===null||(this.Ev.removeChild(this.wv.Xf()),this.wv.m(),this.wv=null);const n=t.Qt().Vc();e&&this.mv===null&&(this.mv=new On(this,t.N(),n,"left"),this.Bv.appendChild(this.mv.Xf())),i&&this.wv===null&&(this.wv=new On(this,t.N(),n,"right"),this.Ev.appendChild(this.wv.Xf()))}hm(t){return t.Bf&&this.Pv||this.kv!==null}am(t){return Math.max(0,Math.min(t,this.Lp.width-1))}lm(t){return Math.max(0,Math.min(t,this.Lp.height-1))}Fv(t,e,i){this.ts().yc(this.am(t),this.lm(e),i,_(this.Dv))}jv(){this.ts().Rc()}Zv(){this.yv&&(this.kv=null,this.jv())}Yv(t,e,i){this.kv=t,this.yv=!1,this.Fv(e.x,e.y,i);const n=this.ts()._c();this.Tv={x:n.si(),y:n.ni()}}ts(){return this.Dp.Qt()}qv(t){if(!this.bv)return;const e=this.ts(),i=this.hp();if(e.Ko(i,i.ys()),this.Mv=null,this.bv=!1,e.Cc(),this.Rv!==null){const n=performance.now(),r=e.Et();this.Rv.le(r.wu(),n),this.Rv.Tu(n)||e._n(this.Rv)}}Nv(){this.kv=null}Wv(){if(this.Dv){if(this.ts().hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)_(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.Dv.ys().Ki()&&this.ts().Et().Ki()}}$v(t){if(this.Dv===null)return;const e=this.ts(),i=e.Et();if(i.Ki())return;const n=this.Dp.N(),r=n.handleScroll,o=n.kineticScroll;if((!r.pressedMouseMove||t.Bf)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t.Bf))return;const h=this.Dv.ys(),a=performance.now();if(this.Mv!==null||this.hm(t)||(this.Mv={x:t.clientX,y:t.clientY,ed:a,om:t.localX,_m:t.localY}),this.Mv!==null&&!this.bv&&(this.Mv.x!==t.clientX||this.Mv.y!==t.clientY)){if(t.Bf&&o.touch||!t.Bf&&o.mouse){const l=i.vu();this.Rv=new Za(.2/l,7/l,.997,15/l),this.Rv.Cp(i.wu(),this.Mv.ed)}else this.Rv=null;h.Ki()||e.Yo(this.Dv,h,t.localY),e.Sc(t.localX),this.bv=!0}this.bv&&(h.Ki()||e.jo(this.Dv,h,t.localY),e.xc(t.localX),this.Rv!==null&&this.Rv.Cp(i.wu(),a))}}class Bn{constructor(t,e,i,n,r){this.xt=!0,this.Lp=O({width:0,height:0}),this.Up=()=>this.av(3),this.Yp=t==="left",this.Gu=i.Vc,this.Ps=e,this.um=n,this.dm=r,this.Yf=document.createElement("div"),this.Yf.style.width="25px",this.Yf.style.height="100%",this.Yf.style.overflow="hidden",this.Zp=qt(this.Yf,O({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up)}m(){this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Ut(this.Zp.canvasElement),this.Zp.dispose()}Xf(){return this.Yf}Zf(){return this.Lp}rv(t){Yt(this.Lp,t)||(this.Lp=t,this.Zp.resizeCanvasElement(t),this.Yf.style.width=`${t.width}px`,this.Yf.style.height=`${t.height}px`,this.xt=!0)}av(t){if(t<3&&!this.xt||this.Lp.width===0||this.Lp.height===0)return;this.xt=!1,this.Zp.applySuggestedBitmapSize();const e=Ht(this.Zp,{colorSpace:this.Ps.layout.colorSpace});e!==null&&e.useBitmapCoordinateSpace(i=>{this.ov(i),this._v(i)})}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const n=this.Gf();n.width>0&&n.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}_v({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(!this.um())return;t.fillStyle=this.Ps.timeScale.borderColor;const r=Math.floor(this.Gu.N().S*i),o=Math.floor(this.Gu.N().S*n),h=this.Yp?e.width-r:0;t.fillRect(h,0,r,o)}ov({context:t,bitmapSize:e}){Ti(t,0,0,e.width,e.height,this.dm())}}function Is(s){return t=>{var e;return((e=t.ia)==null?void 0:e.call(t,s))??[]}}const il=Is("normal"),sl=Is("top"),nl=Is("bottom");class rl{constructor(t,e){this.fm=null,this.pm=null,this.M=null,this.vm=!1,this.Lp=O({width:0,height:0}),this.wm=new W,this.Np=new vi(5),this.Hp=!1,this.Up=()=>{this.Hp||this.Dp.Qt().ar()},this.qp=()=>{this.Hp||this.Dp.Qt().ar()},this.Dp=t,this.o_=e,this.Ps=t.N().layout,this.kp=document.createElement("tr"),this.gm=document.createElement("td"),this.gm.style.padding="0",this.Mm=document.createElement("td"),this.Mm.style.padding="0",this.Yf=document.createElement("td"),this.Yf.style.height="25px",this.Yf.style.padding="0",this.bm=document.createElement("div"),this.bm.style.width="100%",this.bm.style.height="100%",this.bm.style.position="relative",this.bm.style.overflow="hidden",this.Yf.appendChild(this.bm),this.Zp=qt(this.bm,O({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const i=this.Zp.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Gp=qt(this.bm,O({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const n=this.Gp.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.kp.appendChild(this.gm),this.kp.appendChild(this.Yf),this.kp.appendChild(this.Mm),this.Sm(),this.Dp.Qt().Vo().i(this.Sm.bind(this),this),this.Of=new Ai(this.Gp.canvasElement,this,{hf:()=>!0,af:()=>!this.Dp.N().handleScroll.horzTouchDrag})}m(){this.Of.m(),this.fm!==null&&this.fm.m(),this.pm!==null&&this.pm.m(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),Ut(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Ut(this.Zp.canvasElement),this.Zp.dispose()}Xf(){return this.kp}xm(){return this.fm}Cm(){return this.pm}bf(t){if(this.vm)return;this.vm=!0;const e=this.Dp.Qt();!e.Et().Ki()&&this.Dp.N().handleScale.axisPressedMouseMove.time&&e.gc(t.localX)}gf(t){this.bf(t)}Sf(){const t=this.Dp.Qt();!t.Et().Ki()&&this.vm&&(this.vm=!1,this.Dp.N().handleScale.axisPressedMouseMove.time&&t.kc())}uf(t){const e=this.Dp.Qt();!e.Et().Ki()&&this.Dp.N().handleScale.axisPressedMouseMove.time&&e.Pc(t.localX)}lf(t){this.uf(t)}pf(){this.vm=!1;const t=this.Dp.Qt();t.Et().Ki()&&!this.Dp.N().handleScale.axisPressedMouseMove.time||t.kc()}df(){this.pf()}Kd(){this.Dp.N().handleScale.axisDoubleClickReset.time&&this.Dp.Qt().cn()}$d(){this.Kd()}if(){this.Dp.Qt().N().handleScale.axisPressedMouseMove.time&&this.pv(1)}Vf(){this.pv(0)}Zf(){return this.Lp}Pm(){return this.wm}km(t,e,i){Yt(this.Lp,t)||(this.Lp=t,this.Hp=!0,this.Zp.resizeCanvasElement(t),this.Gp.resizeCanvasElement(t),this.Hp=!1,this.Yf.style.width=`${t.width}px`,this.Yf.style.height=`${t.height}px`,this.wm.p(t)),this.fm!==null&&this.fm.rv(O({width:e,height:t.height})),this.pm!==null&&this.pm.rv(O({width:i,height:t.height}))}ym(){const t=this.Tm();return Math.ceil(t.S+t.C+t.P+t.A+t.V+t.Rm)}kt(){this.Dp.Qt().Et().Va()}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const n=this.Gf();n.width>0&&n.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}av(t){if(t===0)return;const e={colorSpace:this.Ps.colorSpace};if(t!==1){this.Zp.applySuggestedBitmapSize();const n=Ht(this.Zp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this.ov(r),this._v(r),this.Dm(n,nl)}),this.cv(n),this.Dm(n,il)),this.fm!==null&&this.fm.av(t),this.pm!==null&&this.pm.av(t)}this.Gp.applySuggestedBitmapSize();const i=Ht(this.Gp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.Vm([...this.Dp.Qt().js(),this.Dp.Qt()._c()],i),this.Dm(i,sl))}Dm(t,e){const i=this.Dp.Qt().js();for(const n of i)Ms(e,r=>ks(r,t,!1,void 0),n,void 0);for(const n of i)Ms(e,r=>ci(r,t,!1,void 0),n,void 0)}ov({context:t,bitmapSize:e}){Ti(t,0,0,e.width,e.height,this.Dp.Qt().Fc())}_v({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this.Dp.N().timeScale.borderVisible){t.fillStyle=this.Im();const n=Math.max(1,Math.floor(this.Tm().S*i));t.fillRect(0,0,e.width,n)}}cv(t){const e=this.Dp.Qt().Et(),i=e.Va();if(!i||i.length===0)return;const n=this.o_.maxTickMarkWeight(i),r=this.Tm(),o=e.N();o.borderVisible&&o.ticksVisible&&t.useBitmapCoordinateSpace(({context:h,horizontalPixelRatio:a,verticalPixelRatio:l})=>{h.strokeStyle=this.Im(),h.fillStyle=this.Im();const c=Math.max(1,Math.floor(a)),d=Math.floor(.5*a);h.beginPath();const f=Math.round(r.C*l);for(let g=i.length;g--;){const p=Math.round(i[g].coord*a);h.rect(p-d,0,c,f)}h.fill()}),t.useMediaCoordinateSpace(({context:h})=>{const a=r.S+r.C+r.A+r.P/2;h.textAlign="center",h.textBaseline="middle",h.fillStyle=this.H(),h.font=this.nv();for(const l of i)if(l.weight<n){const c=l.needAlignCoordinate?this.Bm(h,l.coord,l.label):l.coord;h.fillText(l.label,c,a)}this.Dp.N().timeScale.allowBoldLabels&&(h.font=this.Em());for(const l of i)if(l.weight>=n){const c=l.needAlignCoordinate?this.Bm(h,l.coord,l.label):l.coord;h.fillText(l.label,c,a)}})}Bm(t,e,i){const n=this.Np.Vi(t,i),r=n/2,o=Math.floor(e-r)+.5;return o<0?e+=Math.abs(0-o):o+n>this.Lp.width&&(e-=Math.abs(this.Lp.width-(o+n))),e}Vm(t,e){const i=this.Tm();for(const n of t)for(const r of n.cs())r.Tt().nt(e,i)}Im(){return this.Dp.N().timeScale.borderColor}H(){return this.Ps.textColor}F(){return this.Ps.fontSize}nv(){return bi(this.F(),this.Ps.fontFamily)}Em(){return bi(this.F(),this.Ps.fontFamily,"bold")}Tm(){this.M===null&&(this.M={S:1,L:NaN,A:NaN,V:NaN,Ji:NaN,C:5,P:NaN,k:"",Gi:new vi,Rm:0});const t=this.M,e=this.nv();if(t.k!==e){const i=this.F();t.P=i,t.k=e,t.A=3*i/12,t.V=3*i/12,t.Ji=9*i/12,t.L=0,t.Rm=4*i/12,t.Gi.In()}return this.M}pv(t){this.Yf.style.cursor=t===1?"ew-resize":"default"}Sm(){const t=this.Dp.Qt(),e=t.N();e.leftPriceScale.visible||this.fm===null||(this.gm.removeChild(this.fm.Xf()),this.fm.m(),this.fm=null),e.rightPriceScale.visible||this.pm===null||(this.Mm.removeChild(this.pm.Xf()),this.pm.m(),this.pm=null);const i={Vc:this.Dp.Qt().Vc()},n=()=>e.leftPriceScale.borderVisible&&t.Et().N().borderVisible,r=()=>t.Fc();e.leftPriceScale.visible&&this.fm===null&&(this.fm=new Bn("left",e,i,n,r),this.gm.appendChild(this.fm.Xf())),e.rightPriceScale.visible&&this.pm===null&&(this.pm=new Bn("right",e,i,n,r),this.Mm.appendChild(this.pm.Xf()))}}var co;const ol=!!oe&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(s=>s.brand.includes("Chromium"))&&!!oe&&((co=navigator==null?void 0:navigator.userAgentData)!=null&&co.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class hl{constructor(t,e,i){var n;this.Am=[],this.zm=[],this.Lm=0,this.sl=0,this.Mo=0,this.Om=0,this.Nm=0,this.Fm=null,this.Wm=!1,this.Sv=new W,this.xv=new W,this.Ku=new W,this.Hm=null,this.Um=null,this.Rp=t,this.Ps=e,this.o_=i,this.kp=document.createElement("div"),this.kp.classList.add("tv-lightweight-charts"),this.kp.style.overflow="hidden",this.kp.style.direction="ltr",this.kp.style.width="100%",this.kp.style.height="100%",(n=this.kp).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.$m=document.createElement("table"),this.$m.setAttribute("cellspacing","0"),this.kp.appendChild(this.$m),this.qm=this.Ym.bind(this),is(this.Ps)&&this.jm(!0),this.ts=new Ha(this.Zu.bind(this),this.Ps,i),this.Qt().uc().i(this.Km.bind(this),this),this.Xm=new rl(this,this.o_),this.$m.appendChild(this.Xm.Xf());const r=e.autoSize&&this.Zm();let o=this.Ps.width,h=this.Ps.height;if(r||o===0||h===0){const a=t.getBoundingClientRect();o=o||a.width,h=h||a.height}this.Gm(o,h),this.Jm(),t.appendChild(this.kp),this.Qm(),this.ts.Et().Iu().i(this.ts.Bh.bind(this.ts),this),this.ts.Vo().i(this.ts.Bh.bind(this.ts),this)}Qt(){return this.ts}N(){return this.Ps}Uf(){return this.Am}tw(){return this.Xm}m(){this.jm(!1),this.Lm!==0&&window.cancelAnimationFrame(this.Lm),this.ts.uc().u(this),this.ts.Et().Iu().u(this),this.ts.Vo().u(this),this.ts.m();for(const t of this.Am)this.$m.removeChild(t.Xf()),t.Kv().u(this),t.Xv().u(this),t.m();this.Am=[];for(const t of this.zm)this.iw(t);this.zm=[],_(this.Xm).m(),this.kp.parentElement!==null&&this.kp.parentElement.removeChild(this.kp),this.Ku.m(),this.Sv.m(),this.xv.m(),this.sw()}Gm(t,e,i=!1){if(this.sl===e&&this.Mo===t)return;const n=function(h){const a=Math.floor(h.width),l=Math.floor(h.height);return O({width:a-a%2,height:l-l%2})}(O({width:t,height:e}));this.sl=n.height,this.Mo=n.width;const r=this.sl+"px",o=this.Mo+"px";_(this.kp).style.height=r,_(this.kp).style.width=o,this.$m.style.height=r,this.$m.style.width=o,i?this.nw(q.gn(),performance.now()):this.ts.Bh()}av(t){t===void 0&&(t=q.gn());for(let e=0;e<this.Am.length;e++)this.Am[e].av(t.en(e).tn);this.Ps.timeScale.visible&&this.Xm.av(t.nn())}hr(t){var n;const e=is(this.Ps);this.ts.hr(t);const i=is(this.Ps);i!==e&&this.jm(i),(n=t.layout)!=null&&n.panes&&this.ew(),this.Qm(),this.rw(t)}Kv(){return this.Sv}Xv(){return this.xv}uc(){return this.Ku}hw(){this.Fm!==null&&(this.nw(this.Fm,performance.now()),this.Fm=null);const t=this.aw(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=_(e.getContext("2d"));return this.aw(i),e}lw(t){return t==="left"&&!this.ow()||t==="right"&&!this._w()||this.Am.length===0?0:_(t==="left"?this.Am[0].sm():this.Am[0].nm()).hv()}uw(){return this.Ps.autoSize&&this.Hm!==null}tp(){return this.kp}cw(t){this.Um=t,this.Um?this.tp().style.setProperty("cursor",t):this.tp().style.removeProperty("cursor")}dw(){return this.Um}fw(t){return tt(this.Am[t]).Zf()}ew(){this.zm.forEach(t=>{t.kt()})}rw(t){(t.autoSize!==void 0||!this.Hm||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.Hm&&this.Zm(),t.autoSize===!1&&this.Hm!==null&&this.sw(),t.autoSize||t.width===void 0&&t.height===void 0||this.Gm(t.width||this.Mo,t.height||this.sl))}aw(t){let e=0,i=0;const n=this.Am[0],r=(h,a)=>{let l=0;for(let c=0;c<this.Am.length;c++){const d=this.Am[c],f=_(h==="left"?d.sm():d.nm()),g=f.Gf();if(t!==null&&f.Jf(t,a,l),l+=g.height,c<this.Am.length-1){const p=this.zm[c],m=p.Gf();t!==null&&p.Jf(t,a,l),l+=m.height}}};this.ow()&&(r("left",0),e+=_(n.sm()).Gf().width);for(let h=0;h<this.Am.length;h++){const a=this.Am[h],l=a.Gf();if(t!==null&&a.Jf(t,e,i),i+=l.height,h<this.Am.length-1){const c=this.zm[h],d=c.Gf();t!==null&&c.Jf(t,e,i),i+=d.height}}e+=n.Gf().width,this._w()&&(r("right",e),e+=_(n.nm()).Gf().width);const o=(h,a,l)=>{_(h==="left"?this.Xm.xm():this.Xm.Cm()).Jf(_(t),a,l)};if(this.Ps.timeScale.visible){const h=this.Xm.Gf();if(t!==null){let a=0;this.ow()&&(o("left",a,i),a=_(n.sm()).Gf().width),this.Xm.Jf(t,a,i),a+=h.width,this._w()&&o("right",a,i)}i+=h.height}return O({width:e,height:i})}pw(){let t=0,e=0,i=0;for(const x of this.Am)this.ow()&&(e=Math.max(e,_(x.sm()).sv(),this.Ps.leftPriceScale.minimumWidth)),this._w()&&(i=Math.max(i,_(x.nm()).sv(),this.Ps.rightPriceScale.minimumWidth)),t+=x.Io();e=Ss(e),i=Ss(i);const n=this.Mo,r=this.sl,o=Math.max(n-e-i,0),h=1*this.zm.length,a=this.Ps.timeScale.visible;let l=a?Math.max(this.Xm.ym(),this.Ps.timeScale.minimumHeight):0;var c;l=(c=l)+c%2;const d=h+l,f=r<d?0:r-d,g=f/t;let p=0;const m=window.devicePixelRatio||1;for(let x=0;x<this.Am.length;++x){const b=this.Am[x];b.zv(this.ts.$s()[x]);let v=0,y=0;y=x===this.Am.length-1?Math.ceil((f-p)*m)/m:Math.round(b.Io()*g*m)/m,v=Math.max(y,2),p+=v,b.rv(O({width:o,height:v})),this.ow()&&b.Gv(e,"left"),this._w()&&b.Gv(i,"right"),b.hp()&&this.ts.cc(b.hp(),v)}this.Xm.km(O({width:a?o:0,height:l}),a?e:0,a?i:0),this.ts.Eo(o),this.Om!==e&&(this.Om=e),this.Nm!==i&&(this.Nm=i)}jm(t){t?this.kp.addEventListener("wheel",this.qm,{passive:!1}):this.kp.removeEventListener("wheel",this.qm)}mw(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return ol?1/window.devicePixelRatio:1}Ym(t){if(!(t.deltaX!==0&&this.Ps.handleScroll.mouseWheel||t.deltaY!==0&&this.Ps.handleScale.mouseWheel))return;const e=this.mw(t),i=e*t.deltaX/100,n=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),n!==0&&this.Ps.handleScale.mouseWheel){const r=Math.sign(n)*Math.min(1,Math.abs(n)),o=t.clientX-this.kp.getBoundingClientRect().left;this.Qt().Mc(o,r)}i!==0&&this.Ps.handleScroll.mouseWheel&&this.Qt().bc(-80*i)}nw(t,e){var n;const i=t.nn();i===3&&this.ww(),i!==3&&i!==2||(this.gw(t),this.Mw(t,e),this.Xm.kt(),this.Am.forEach(r=>{r.Ov()}),((n=this.Fm)==null?void 0:n.nn())===3&&(this.Fm.vn(t),this.ww(),this.gw(this.Fm),this.Mw(this.Fm,e),t=this.Fm,this.Fm=null)),this.av(t)}Mw(t,e){for(const i of t.pn())this.mn(i,e)}gw(t){const e=this.ts.$s();for(let i=0;i<e.length;i++)t.en(i).sn&&e[i].Go()}mn(t,e){const i=this.ts.Et();switch(t.an){case 0:i.Eu();break;case 1:i.Au(t.Wt);break;case 2:i.dn(t.Wt);break;case 3:i.fn(t.Wt);break;case 4:i.bu();break;case 5:t.Wt.Tu(e)||i.fn(t.Wt.Ru(e))}}Zu(t){this.Fm!==null?this.Fm.vn(t):this.Fm=t,this.Wm||(this.Wm=!0,this.Lm=window.requestAnimationFrame(e=>{if(this.Wm=!1,this.Lm=0,this.Fm!==null){const i=this.Fm;this.Fm=null,this.nw(i,e);for(const n of i.pn())if(n.an===5&&!n.Wt.Tu(e)){this.Qt()._n(n.Wt);break}}}))}ww(){this.Jm()}iw(t){this.$m.removeChild(t.Xf()),t.m()}Jm(){const t=this.ts.$s(),e=t.length,i=this.Am.length;for(let n=e;n<i;n++){const r=tt(this.Am.pop());this.$m.removeChild(r.Xf()),r.Kv().u(this),r.Xv().u(this),r.m();const o=this.zm.pop();o!==void 0&&this.iw(o)}for(let n=i;n<e;n++){const r=new Bs(this,t[n]);if(r.Kv().i(this.bw.bind(this,r),this),r.Xv().i(this.Sw.bind(this,r),this),this.Am.push(r),n>0){const o=new Ga(this,n-1,n);this.zm.push(o),this.$m.insertBefore(o.Xf(),this.Xm.Xf())}this.$m.insertBefore(r.Xf(),this.Xm.Xf())}for(let n=0;n<e;n++){const r=t[n],o=this.Am[n];o.hp()!==r?o.zv(r):o.Av()}this.Qm(),this.pw()}xw(t,e,i,n){var d;const r=new Map;t!==null&&this.ts.js().forEach(f=>{const g=f.Xs().Fr(t);g!==null&&r.set(f,g)});let o;if(t!==null){const f=(d=this.ts.Et().ss(t))==null?void 0:d.originalTime;f!==void 0&&(o=f)}const h=this.Qt().hc(),a=h!==null&&h.n_ instanceof Oi?h.n_:void 0,l=h!==null&&h.e_!==void 0?h.e_.Kn:void 0,c=this.Cw(n);return{Pw:o,Re:t??void 0,kw:e??void 0,yw:c!==-1?c:void 0,Tw:a,Rw:r,Dw:l,Vw:i??void 0}}Cw(t){let e=-1;if(t)e=this.Am.indexOf(t);else{const i=this.Qt()._c().Us();i!==null&&(e=this.Qt().$s().indexOf(i))}return e}bw(t,e,i,n){this.Sv.p(()=>this.xw(e,i,n,t))}Sw(t,e,i,n){this.xv.p(()=>this.xw(e,i,n,t))}Km(t,e,i){var n;this.cw(((n=this.Qt().hc())==null?void 0:n.h_)??null),this.Ku.p(()=>this.xw(t,e,i))}Qm(){const t=this.Ps.timeScale.visible?"":"none";this.Xm.Xf().style.display=t}ow(){return this.Am[0].hp().Wo().N().visible}_w(){return this.Am[0].hp().Ho().N().visible}Zm(){return"ResizeObserver"in window&&(this.Hm=new ResizeObserver(t=>{const e=t[t.length-1];e&&this.Gm(e.contentRect.width,e.contentRect.height)}),this.Hm.observe(this.Rp,{box:"border-box"}),!0)}sw(){this.Hm!==null&&this.Hm.disconnect(),this.Hm=null}}function is(s){return!!(s.handleScroll.mouseWheel||s.handleScale.mouseWheel)}function al(s){return s.open===void 0&&s.value===void 0}function ll(s){return function(t){return t.open!==void 0}(s)||function(t){return t.value!==void 0}(s)}function In(s,t,e,i){const n=e.value,r={Re:t,wt:s,Wt:[n,n,n,n],Pw:i};return e.color!==void 0&&(r.R=e.color),r}function cl(s,t,e,i){const n=e.value,r={Re:t,wt:s,Wt:[n,n,n,n],Pw:i};return e.lineColor!==void 0&&(r.vt=e.lineColor),e.topColor!==void 0&&(r.mr=e.topColor),e.bottomColor!==void 0&&(r.wr=e.bottomColor),r}function dl(s,t,e,i){const n=e.value,r={Re:t,wt:s,Wt:[n,n,n,n],Pw:i};return e.topLineColor!==void 0&&(r.gr=e.topLineColor),e.bottomLineColor!==void 0&&(r.Mr=e.bottomLineColor),e.topFillColor1!==void 0&&(r.br=e.topFillColor1),e.topFillColor2!==void 0&&(r.Sr=e.topFillColor2),e.bottomFillColor1!==void 0&&(r.Cr=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(r.Pr=e.bottomFillColor2),r}function ul(s,t,e,i){const n={Re:t,wt:s,Wt:[e.open,e.high,e.low,e.close],Pw:i};return e.color!==void 0&&(n.R=e.color),n}function fl(s,t,e,i){const n={Re:t,wt:s,Wt:[e.open,e.high,e.low,e.close],Pw:i};return e.color!==void 0&&(n.R=e.color),e.borderColor!==void 0&&(n.Ht=e.borderColor),e.wickColor!==void 0&&(n.vr=e.wickColor),n}function gl(s,t,e,i,n){const r=tt(n)(e),o=Math.max(...r),h=Math.min(...r),a=r[r.length-1],l=[a,o,h,a],{time:c,color:d,...f}=e;return{Re:t,wt:s,Wt:l,Pw:i,se:f,R:d}}function pe(s){return s.Wt!==void 0}function Wn(s,t){return t.customValues!==void 0&&(s.Iw=t.customValues),s}function Ft(s){return(t,e,i,n,r,o)=>function(h,a){return a?a(h):al(h)}(i,o)?Wn({wt:t,Re:e,Pw:n},i):Wn(s(t,e,i,n,r),i)}function Vn(s){return{Candlestick:Ft(fl),Bar:Ft(ul),Area:Ft(cl),Baseline:Ft(dl),Histogram:Ft(In),Line:Ft(In),Custom:Ft(gl)}[s]}function Yn(s){return{Re:0,Bw:new Map,Hh:s}}function $n(s,t){if(s!==void 0&&s.length!==0)return{Ew:t.key(s[0].wt),Aw:t.key(s[s.length-1].wt)}}function Hn(s){let t;return s.forEach(e=>{t===void 0&&(t=e.Pw)}),tt(t)}class pl{constructor(t){this.zw=new Map,this.Lw=new Map,this.Ow=new Map,this.Nw=[],this.o_=t}m(){this.zw.clear(),this.Lw.clear(),this.Ow.clear(),this.Nw=[]}Fw(t,e){let i=this.zw.size!==0,n=!1;const r=this.Lw.get(t);if(r!==void 0)if(this.Lw.size===1)i=!1,n=!0,this.zw.clear();else for(const a of this.Nw)a.pointData.Bw.delete(t)&&(n=!0);let o=[];if(e.length!==0){const a=e.map(g=>g.time),l=this.o_.createConverterToInternalObj(e),c=Vn(t.Rr()),d=t.da(),f=t.pa();o=e.map((g,p)=>{const m=l(g.time),x=this.o_.key(m);let b=this.zw.get(x);b===void 0&&(b=Yn(m),this.zw.set(x,b),n=!0);const v=c(m,b.Re,g,a[p],d,f);return b.Bw.set(t,v),v})}i&&this.Ww(),this.Hw(t,o);let h=-1;if(n){const a=[];this.zw.forEach(l=>{a.push({timeWeight:0,time:l.Hh,pointData:l,originalTime:Hn(l.Bw)})}),a.sort((l,c)=>this.o_.key(l.time)-this.o_.key(c.time)),h=this.Uw(a)}return this.$w(t,h,function(a,l,c){const d=$n(a,c),f=$n(l,c);if(d!==void 0&&f!==void 0)return{qw:!1,zh:d.Aw>=f.Aw&&d.Ew>=f.Ew}}(this.Lw.get(t),r,this.o_))}Ec(t){return this.Fw(t,[])}Yw(t,e,i){const n=e;(function(x){x.Pw===void 0&&(x.Pw=x.time)})(n),this.o_.preprocessData(e);const r=this.o_.createConverterToInternalObj([e])(e.time),o=this.Ow.get(t);if(!i&&o!==void 0&&this.o_.key(r)<this.o_.key(o))throw new Error(`Cannot update oldest data, last time=${o}, new time=${r}`);let h=this.zw.get(this.o_.key(r));if(i&&h===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const a=h===void 0;h===void 0&&(h=Yn(r),this.zw.set(this.o_.key(r),h));const l=Vn(t.Rr()),c=t.da(),d=t.pa(),f=l(r,h.Re,e,n.Pw,c,d);h.Bw.set(t,f),i?this.jw(t,f,h.Re):this.Kw(t,f);const g={zh:pe(f),qw:i};if(!a)return this.$w(t,-1,g);const p={timeWeight:0,time:h.Hh,pointData:h,originalTime:Hn(h.Bw)},m=re(this.Nw,this.o_.key(p.time),(x,b)=>this.o_.key(x.time)<b);this.Nw.splice(m,0,p);for(let x=m;x<this.Nw.length;++x)ss(this.Nw[x].pointData,x);return this.o_.fillWeightsForPoints(this.Nw,m),this.$w(t,m,g)}Kw(t,e){let i=this.Lw.get(t);i===void 0&&(i=[],this.Lw.set(t,i));const n=i.length!==0?i[i.length-1]:null;n===null||this.o_.key(e.wt)>this.o_.key(n.wt)?pe(e)&&i.push(e):pe(e)?i[i.length-1]=e:i.splice(-1,1),this.Ow.set(t,e.wt)}jw(t,e,i){const n=this.Lw.get(t);if(n===void 0)return;const r=re(n,i,(o,h)=>o.Re<h);pe(e)?n[r]=e:n.splice(r,1)}Hw(t,e){e.length!==0?(this.Lw.set(t,e.filter(pe)),this.Ow.set(t,e[e.length-1].wt)):(this.Lw.delete(t),this.Ow.delete(t))}Ww(){for(const t of this.Nw)t.pointData.Bw.size===0&&this.zw.delete(this.o_.key(t.time))}Uw(t){let e=-1;for(let i=0;i<this.Nw.length&&i<t.length;++i){const n=this.Nw[i],r=t[i];if(this.o_.key(n.time)!==this.o_.key(r.time)){e=i;break}r.timeWeight=n.timeWeight,ss(r.pointData,i)}if(e===-1&&this.Nw.length!==t.length&&(e=Math.min(this.Nw.length,t.length)),e===-1)return-1;for(let i=e;i<t.length;++i)ss(t[i].pointData,i);return this.o_.fillWeightsForPoints(t,e),this.Nw=t,e}Xw(){if(this.Lw.size===0)return null;let t=0;return this.Lw.forEach(e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].Re))}),t}$w(t,e,i){const n={Oo:new Map,Et:{ou:this.Xw()}};if(e!==-1)this.Lw.forEach((r,o)=>{n.Oo.set(o,{se:r,Zw:o===t?i:void 0})}),this.Lw.has(t)||n.Oo.set(t,{se:[],Zw:i}),n.Et.Gw=this.Nw,n.Et.Jw=e;else{const r=this.Lw.get(t);n.Oo.set(t,{se:r||[],Zw:i})}return n}}function ss(s,t){s.Re=t,s.Bw.forEach(e=>{e.Re=t})}function ml(s,t){return s.wt<t}function xl(s,t){return t<s.wt}function bl(s,t,e){const i=t.Uh(),n=t.bi(),r=re(s,i,ml),o=So(s,n,xl);if(!e)return{from:r,to:o};let h=r,a=o;return r>0&&r<s.length&&s[r].wt>=i&&(h=r-1),o>0&&o<s.length&&s[o-1].wt<=n&&(a=o+1),{from:h,to:a}}class zo{constructor(t,e,i){this.Qw=!0,this.tg=!0,this.ig=!0,this.sg=[],this.ng=null,this.Jn=t,this.Qn=e,this.eg=i}kt(t){this.Qw=!0,t==="data"&&(this.tg=!0),t==="options"&&(this.ig=!0)}Tt(){return this.Jn.Vt()?(this.rg(),this.ng===null?null:this.hg):null}ag(){this.sg=this.sg.map(t=>({...t,...this.Jn.Rh().Dr(t.wt)}))}lg(){this.ng=null}rg(){this.tg&&(this.og(),this.tg=!1),this.ig&&(this.ag(),this.ig=!1),this.Qw&&(this._g(),this.Qw=!1)}_g(){const t=this.Jn.Ft(),e=this.Qn.Et();if(this.lg(),e.Ki()||t.Ki())return;const i=e.Pe();if(i===null||this.Jn.Xs().zr()===0)return;const n=this.Jn.zt();n!==null&&(this.ng=bl(this.sg,i,this.eg),this.ug(t,e,n.Wt),this.cg())}}class vl{constructor(t,e){this.dg=t,this.Yi=e}nt(t,e,i){this.dg.draw(t,this.Yi,e,i)}}class yl extends zo{constructor(t,e,i){super(t,e,!1),this.sh=i,this.hg=new vl(this.sh.renderer(),n=>{const r=t.zt();return r===null?null:t.Ft().Nt(n,r.Wt)})}fa(t){return this.sh.priceValueBuilder(t)}va(t){return this.sh.isWhitespace(t)}og(){const t=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map(e=>({wt:e.Re,_t:NaN,...t.Dr(e.Re),fg:e.se}))}ug(t,e){e._u(this.sg,ys(this.ng))}cg(){this.sh.update({bars:this.sg.map(_l),barSpacing:this.Qn.Et().vu(),visibleRange:this.ng},this.Jn.N())}}function _l(s){return{x:s._t,time:s.wt,originalData:s.fg,barColor:s.cr}}const wl={color:"#2196f3"},Sl=(s,t,e)=>{const i=Mt(e);return new yl(s,t,i)};function Ws(s){const t={value:s.Wt[3],time:s.Pw};return s.Iw!==void 0&&(t.customValues=s.Iw),t}function qn(s){const t=Ws(s);return s.R!==void 0&&(t.color=s.R),t}function kl(s){const t=Ws(s);return s.vt!==void 0&&(t.lineColor=s.vt),s.mr!==void 0&&(t.topColor=s.mr),s.wr!==void 0&&(t.bottomColor=s.wr),t}function Ml(s){const t=Ws(s);return s.gr!==void 0&&(t.topLineColor=s.gr),s.Mr!==void 0&&(t.bottomLineColor=s.Mr),s.br!==void 0&&(t.topFillColor1=s.br),s.Sr!==void 0&&(t.topFillColor2=s.Sr),s.Cr!==void 0&&(t.bottomFillColor1=s.Cr),s.Pr!==void 0&&(t.bottomFillColor2=s.Pr),t}function Do(s){const t={open:s.Wt[0],high:s.Wt[1],low:s.Wt[2],close:s.Wt[3],time:s.Pw};return s.Iw!==void 0&&(t.customValues=s.Iw),t}function Pl(s){const t=Do(s);return s.R!==void 0&&(t.color=s.R),t}function Cl(s){const t=Do(s),{R:e,Ht:i,vr:n}=s;return e!==void 0&&(t.color=e),i!==void 0&&(t.borderColor=i),n!==void 0&&(t.wickColor=n),t}function Ps(s){return{Area:kl,Line:qn,Baseline:Ml,Histogram:qn,Bar:Pl,Candlestick:Cl,Custom:jl}[s]}function jl(s){const t=s.Pw;return{...s.se,time:t}}const Rl={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},zl={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Dl={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:po,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},ns={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},Tl={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Un(){return{addDefaultPane:!0,width:0,height:0,autoSize:!1,layout:Dl,crosshair:Rl,grid:zl,overlayPriceScales:{...ns},leftPriceScale:{...ns,visible:!1},rightPriceScale:{...ns,visible:!0},timeScale:Tl,localization:{locale:oe?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class To{constructor(t,e,i){this.Wf=t,this.pg=e,this.vg=i??0}applyOptions(t){this.Wf.Qt().lc(this.pg,t,this.vg)}options(){return this.Yi().N()}width(){return Li(this.pg)?this.Wf.lw(this.pg):0}setVisibleRange(t){this.setAutoScale(!1),this.Yi().Wl(new G(t.from,t.to))}getVisibleRange(){const t=this.Yi().Qe();return t===null?null:{from:t.$e(),to:t.qe()}}setAutoScale(t){this.applyOptions({autoScale:t})}Yi(){return _(this.Wf.Qt().oc(this.pg,this.vg)).Ft}}class El{constructor(t,e,i,n){this.Wf=t,this.Pt=i,this.mg=e,this.wg=n}getHeight(){return this.Pt.$t()}setHeight(t){const e=this.Wf.Qt(),i=e.Hc(this.Pt);e.fc(i,t)}getStretchFactor(){return this.Pt.Io()}setStretchFactor(t){this.Pt.Bo(t),this.Wf.Qt().Bh()}paneIndex(){return this.Wf.Qt().Hc(this.Pt)}moveTo(t){const e=this.paneIndex();e!==t&&(U(t>=0&&t<this.Wf.Uf().length,"Invalid pane index"),this.Wf.Qt().mc(e,t))}getSeries(){return this.Pt.Oo().map(t=>this.mg(t))??[]}getHTMLElement(){const t=this.Wf.Uf();return t&&t.length!==0&&t[this.paneIndex()]?t[this.paneIndex()].Xf():null}attachPrimitive(t){this.Pt.ua(t),t.attached&&t.attached({chart:this.wg,requestUpdate:()=>this.Pt.Qt().Bh()})}detachPrimitive(t){this.Pt.ca(t)}priceScale(t){if(this.Pt.Do(t)===null)throw new Error(`Cannot find price scale with id: ${t}`);return new To(this.Wf,t,this.paneIndex())}setPreserveEmptyPane(t){this.Pt.zo(t)}preserveEmptyPane(){return this.Pt.Lo()}addCustomSeries(t,e={},i=0){return this.wg.addCustomSeries(t,e,i)}addSeries(t,e={}){return this.wg.addSeries(t,e,this.paneIndex())}}const Ll={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class Xn{constructor(t){this.ir=t}applyOptions(t){this.ir.hr(t)}options(){return this.ir.N()}gg(){return this.ir}}class Fl{constructor(t,e,i,n,r,o){this.Mg=new W,this.Jn=t,this.bg=e,this.Sg=i,this.o_=r,this.wg=n,this.xg=o}m(){this.Mg.m()}priceFormatter(){return this.Jn.ra()}priceToCoordinate(t){const e=this.Jn.zt();return e===null?null:this.Jn.Ft().Nt(t,e.Wt)}coordinateToPrice(t){const e=this.Jn.zt();return e===null?null:this.Jn.Ft().Ts(t,e.Wt)}barsInLogicalRange(t){if(t===null)return null;const e=new te(new je(t.from,t.to)).k_(),i=this.Jn.Xs();if(i.Ki())return null;const n=i.Fr(e.Uh(),1),r=i.Fr(e.bi(),-1),o=_(i.Lr()),h=_(i.Ks());if(n!==null&&r!==null&&n.Re>r.Re)return{barsBefore:t.from-o,barsAfter:h-t.to};const a={barsBefore:n===null||n.Re===o?t.from-o:n.Re-o,barsAfter:r===null||r.Re===h?h-t.to:h-r.Re};return n!==null&&r!==null&&(a.from=n.Pw,a.to=r.Pw),a}setData(t){this.o_,this.Jn.Rr(),this.bg.Cg(this.Jn,t),this.Pg("full")}update(t,e=!1){this.Jn.Rr(),this.bg.kg(this.Jn,t,e),this.Pg("update")}dataByIndex(t,e){const i=this.Jn.Xs().Fr(t,e);return i===null?null:Ps(this.seriesType())(i)}data(){const t=Ps(this.seriesType());return this.Jn.Xs().Hr().map(e=>t(e))}subscribeDataChanged(t){this.Mg.i(t)}unsubscribeDataChanged(t){this.Mg._(t)}applyOptions(t){this.Jn.hr(t)}options(){return vt(this.Jn.N())}priceScale(){return this.Sg.priceScale(this.Jn.Ft().wa(),this.getPane().paneIndex())}createPriceLine(t){const e=it(vt(Ll),t),i=this.Jn.Oh(e);return new Xn(i)}removePriceLine(t){this.Jn.Nh(t.gg())}priceLines(){return this.Jn.Fh().map(t=>new Xn(t))}seriesType(){return this.Jn.Rr()}attachPrimitive(t){this.Jn.ua(t),t.attached&&t.attached({chart:this.wg,series:this,requestUpdate:()=>this.Jn.Qt().Bh(),horzScaleBehavior:this.o_})}detachPrimitive(t){this.Jn.ca(t),t.detached&&t.detached(),this.Jn.Qt().Bh()}getPane(){const t=this.Jn,e=_(this.Jn.Qt().Hn(t));return this.xg(e)}moveToPane(t){this.Jn.Qt().Oc(this.Jn,t)}seriesOrder(){const t=this.Jn.Qt().Hn(this.Jn);return t===null?-1:t.Oo().indexOf(this.Jn)}setSeriesOrder(t){const e=this.Jn.Qt().Hn(this.Jn);e!==null&&e.Qo(this.Jn,t)}Pg(t){this.Mg.v()&&this.Mg.p(t)}}class Ol{constructor(t,e,i){this.yg=new W,this.z_=new W,this.wm=new W,this.ts=t,this.uh=t.Et(),this.Xm=e,this.uh.Du().i(this.Tg.bind(this)),this.uh.Vu().i(this.Rg.bind(this)),this.Xm.Pm().i(this.Dg.bind(this)),this.o_=i}m(){this.uh.Du().u(this),this.uh.Vu().u(this),this.Xm.Pm().u(this),this.yg.m(),this.z_.m(),this.wm.m()}scrollPosition(){return this.uh.wu()}scrollToPosition(t,e){e?this.uh.yu(t,1e3):this.ts.fn(t)}scrollToRealTime(){this.uh.ku()}getVisibleRange(){const t=this.uh.su();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.o_.convertHorzItemToInternal(t.from),to:this.o_.convertHorzItemToInternal(t.to)},i=this.uh.hu(e);this.ts.zc(i)}getVisibleLogicalRange(){const t=this.uh.iu();return t===null?null:{from:t.Uh(),to:t.bi()}}setVisibleLogicalRange(t){U(t.from<=t.to,"The from index cannot be after the to index."),this.ts.zc(t)}resetTimeScale(){this.ts.cn()}fitContent(){this.ts.Eu()}logicalToCoordinate(t){const e=this.ts.Et();return e.Ki()?null:e.qt(t)}coordinateToLogical(t){return this.uh.Ki()?null:this.uh.uu(t)}timeToIndex(t,e){const i=this.o_.convertHorzItemToInternal(t);return this.uh.J_(i,e)}timeToCoordinate(t){const e=this.timeToIndex(t,!1);return e===null?null:this.uh.qt(e)}coordinateToTime(t){const e=this.ts.Et(),i=e.uu(t),n=e.ss(i);return n===null?null:n.originalTime}width(){return this.Xm.Zf().width}height(){return this.Xm.Zf().height}subscribeVisibleTimeRangeChange(t){this.yg.i(t)}unsubscribeVisibleTimeRangeChange(t){this.yg._(t)}subscribeVisibleLogicalRangeChange(t){this.z_.i(t)}unsubscribeVisibleLogicalRangeChange(t){this.z_._(t)}subscribeSizeChange(t){this.wm.i(t)}unsubscribeSizeChange(t){this.wm._(t)}applyOptions(t){this.uh.hr(t)}options(){return{...vt(this.uh.N()),barSpacing:this.uh.vu()}}Tg(){this.yg.v()&&this.yg.p(this.getVisibleRange())}Rg(){this.z_.v()&&this.z_.p(this.getVisibleLogicalRange())}Dg(t){this.wm.p(t.width,t.height)}}function Al(s){if(s===void 0||s.type==="custom")return;const t=s;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;let i=0;for(;i<8;i++){const n=Math.round(e);if(Math.abs(n-e)<1e-8)return i;e*=10}return i}(t.minMove))}function Qn(s){return function(t){if($e(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:i,axisDoubleClickReset:n}=t.handleScale;$e(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),$e(n)&&(t.handleScale.axisDoubleClickReset={time:n,price:n})}const e=t.handleScroll;$e(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(s),s}class Nl{constructor(t,e,i){this.Vg=new Map,this.Ig=new Map,this.Bg=new W,this.Eg=new W,this.Ag=new W,this.$u=new WeakMap,this.zg=new pl(e);const n=i===void 0?vt(Un()):it(vt(Un()),Qn(i));this.Lg=e,this.Wf=new hl(t,n,e),this.Wf.Kv().i(o=>{this.Bg.v()&&this.Bg.p(this.Og(o()))},this),this.Wf.Xv().i(o=>{this.Eg.v()&&this.Eg.p(this.Og(o()))},this),this.Wf.uc().i(o=>{this.Ag.v()&&this.Ag.p(this.Og(o()))},this);const r=this.Wf.Qt();this.Ng=new Ol(r,this.Wf.tw(),this.Lg)}remove(){this.Wf.Kv().u(this),this.Wf.Xv().u(this),this.Wf.uc().u(this),this.Ng.m(),this.Wf.m(),this.Vg.clear(),this.Ig.clear(),this.Bg.m(),this.Eg.m(),this.Ag.m(),this.zg.m()}resize(t,e,i){this.autoSizeActive()||this.Wf.Gm(t,e,i)}addCustomSeries(t,e={},i=0){const n=(r=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...wl,...r.defaultOptions()},Fg:Sl,Wg:r}))(Mt(t));return this.Hg(n,e,i)}addSeries(t,e={},i=0){return this.Hg(t,e,i)}removeSeries(t){const e=tt(this.Vg.get(t)),i=this.zg.Ec(e);this.Wf.Qt().Ec(e),this.Ug(i),this.Vg.delete(t),this.Ig.delete(e)}Cg(t,e){this.Ug(this.zg.Fw(t,e))}kg(t,e,i){this.Ug(this.zg.Yw(t,e,i))}subscribeClick(t){this.Bg.i(t)}unsubscribeClick(t){this.Bg._(t)}subscribeCrosshairMove(t){this.Ag.i(t)}unsubscribeCrosshairMove(t){this.Ag._(t)}subscribeDblClick(t){this.Eg.i(t)}unsubscribeDblClick(t){this.Eg._(t)}priceScale(t,e=0){return new To(this.Wf,t,e)}timeScale(){return this.Ng}applyOptions(t){this.Wf.hr(Qn(t))}options(){return this.Wf.N()}takeScreenshot(){return this.Wf.hw()}addPane(t=!1){const e=this.Wf.Qt().Uc();return e.zo(t),this.$g(e)}removePane(t){this.Wf.Qt().dc(t)}swapPanes(t,e){this.Wf.Qt().vc(t,e)}autoSizeActive(){return this.Wf.uw()}chartElement(){return this.Wf.tp()}panes(){return this.Wf.Qt().$s().map(t=>this.$g(t))}paneSize(t=0){const e=this.Wf.fw(t);return{height:e.height,width:e.width}}setCrosshairPosition(t,e,i){const n=this.Vg.get(i);if(n===void 0)return;const r=this.Wf.Qt().Hn(n);r!==null&&this.Wf.Qt().Tc(t,e,r)}clearCrosshairPosition(){this.Wf.Qt().Rc(!0)}horzBehaviour(){return this.Lg}Hg(t,e={},i=0){U(t.Fg!==void 0),Al(e.priceFormat),t.type==="Candlestick"&&function(a){a.borderColor!==void 0&&(a.borderUpColor=a.borderColor,a.borderDownColor=a.borderColor),a.wickColor!==void 0&&(a.wickUpColor=a.wickColor,a.wickDownColor=a.wickColor)}(e);const n=it(vt(fo),vt(t.defaultOptions),e),r=t.Fg,o=new Oi(this.Wf.Qt(),t.type,n,r,t.Wg);this.Wf.Qt().Ic(o,i);const h=new Fl(o,this,this,this,this.Lg,a=>this.$g(a));return this.Vg.set(h,o),this.Ig.set(o,h),h}Ug(t){const e=this.Wf.Qt();e.Dc(t.Et.ou,t.Et.Gw,t.Et.Jw),t.Oo.forEach((i,n)=>n.ht(i.se,i.Zw)),e.Et().j_(),e.pu()}qg(t){return tt(this.Ig.get(t))}Og(t){const e=new Map;t.Rw.forEach((n,r)=>{const o=r.Rr(),h=Ps(o)(n);if(o!=="Custom")U(ll(h));else{const a=r.pa();U(!a||a(h)===!1)}e.set(this.qg(r),h)});const i=t.Tw!==void 0&&this.Ig.has(t.Tw)?this.qg(t.Tw):void 0;return{time:t.Pw,logical:t.Re,point:t.kw,paneIndex:t.yw,hoveredSeries:i,hoveredObjectId:t.Dw,seriesData:e,sourceEvent:t.Vw}}$g(t){let e=this.$u.get(t);return e||(e=new El(this.Wf,i=>this.qg(i),t,this),this.$u.set(t,e)),e}}function Bl(s){if(Be(s)){const t=document.getElementById(s);return U(t!==null,`Cannot find element in DOM with id=${s}`),t}return s}function Il(s,t,e){const i=Bl(s),n=new Nl(i,t,e);return t.setOptions(n.options()),n}function Wl(s,t){return Il(s,new Tn,Tn.ad(t))}class Vl extends zo{constructor(t,e){super(t,e,!0)}ug(t,e,i){e._u(this.sg,ys(this.ng)),t.$l(this.sg,i,ys(this.ng))}Yg(t,e){return{wt:t,gt:e,_t:NaN,ut:NaN}}og(){const t=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map(e=>{const i=e.Wt[3];return this.jg(e.Re,i,t)})}}function Yl(s,t,e,i,n,r,o){if(t.length===0||i.from>=t.length||i.to<=0)return;const{context:h,horizontalPixelRatio:a,verticalPixelRatio:l}=s,c=t[i.from];let d=r(s,c),f=c;if(i.to-i.from<2){const g=n/2;h.beginPath();const p={_t:c._t-g,ut:c.ut},m={_t:c._t+g,ut:c.ut};h.moveTo(p._t*a,p.ut*l),h.lineTo(m._t*a,m.ut*l),o(s,d,p,m)}else{const g=(m,x)=>{o(s,d,f,x),h.beginPath(),d=m,f=x};let p=f;h.beginPath(),h.moveTo(c._t*a,c.ut*l);for(let m=i.from+1;m<i.to;++m){p=t[m];const x=r(s,p);switch(e){case 0:h.lineTo(p._t*a,p.ut*l);break;case 1:h.lineTo(p._t*a,t[m-1].ut*l),x!==d&&(g(x,p),h.lineTo(p._t*a,t[m-1].ut*l)),h.lineTo(p._t*a,p.ut*l);break;case 2:{const[b,v]=$l(t,m-1,m);h.bezierCurveTo(b._t*a,b.ut*l,v._t*a,v.ut*l,p._t*a,p.ut*l);break}}e!==1&&x!==d&&(g(x,p),h.moveTo(p._t*a,p.ut*l))}(f!==p||f===p&&e===1)&&o(s,d,f,p)}}const Kn=6;function rs(s,t){return{_t:s._t-t._t,ut:s.ut-t.ut}}function Gn(s,t){return{_t:s._t/t,ut:s.ut/t}}function $l(s,t,e){const i=Math.max(0,t-1),n=Math.min(s.length-1,e+1);var r,o;return[(r=s[t],o=Gn(rs(s[e],s[i]),Kn),{_t:r._t+o._t,ut:r.ut+o.ut}),rs(s[e],Gn(rs(s[n],s[t]),Kn))]}function Hl(s,t){const e=s.context;e.strokeStyle=t,e.stroke()}class ql extends le{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Kg:n,Xg:r,ct:o,Xt:h,Zg:a}=this.rt;if(i===null)return;const l=t.context;l.lineCap="butt",l.lineWidth=o*t.verticalPixelRatio,se(l,h),l.lineJoin="round";const c=this.Gg.bind(this);r!==void 0&&Yl(t,e,r,i,n,c,Hl),a&&function(d,f,g,p,m){if(p.to-p.from<=0)return;const{horizontalPixelRatio:x,verticalPixelRatio:b,context:v}=d;let y=null;const w=Math.max(1,Math.floor(x))%2/2,S=g*b+w;for(let P=p.to-1;P>=p.from;--P){const M=f[P];if(M){const k=m(d,M);k!==y&&(v.beginPath(),y!==null&&v.fill(),v.fillStyle=k,y=k);const C=Math.round(M._t*x)+w,z=M.ut*b;v.moveTo(C,z),v.arc(C,z,S,0,2*Math.PI)}}v.fill()}(t,e,a,i,c)}}class Ul extends ql{Gg(t,e){return e.vt}}class Xl extends Vl{constructor(){super(...arguments),this.hg=new Ul}jg(t,e,i){return{...this.Yg(t,e),...i.Dr(t)}}cg(){const t=this.Jn.N(),e={ot:this.sg,Xt:t.lineStyle,Xg:t.lineVisible?t.lineType:void 0,ct:t.lineWidth,Zg:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,lt:this.ng,Kg:this.Qn.Et().vu()};this.hg.ht(e)}}const Ql={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Fg:(s,t)=>new Xl(s,t)};({...fo});const Kl=s=>{const t=R.useRef(null),e=R.useRef(null),i=R.useRef(null),n=R.useRef(new Map),r=R.useCallback(()=>{var f,g,p,m,x,b;if(!t.current)return;e.current&&e.current.remove();const d={width:s.width,height:s.height,layout:{background:{type:_s.Solid,color:((f=s.layout)==null?void 0:f.backgroundColor)||"#ffffff"},textColor:((g=s.layout)==null?void 0:g.textColor)||"#333333"},grid:{vertLines:{color:((p=s.grid)==null?void 0:p.vertLines.color)||"#f0f0f0"},horzLines:{color:((m=s.grid)==null?void 0:m.horzLines.color)||"#f0f0f0"}},timeScale:{timeVisible:((x=s.timeScale)==null?void 0:x.timeVisible)??!0,secondsVisible:((b=s.timeScale)==null?void 0:b.secondsVisible)??!1}};return e.current=Wl(t.current,d),()=>{e.current&&(e.current.remove(),e.current=null,i.current=null,n.current.clear())}},[s]);R.useEffect(()=>r(),[r]);const o=R.useCallback(d=>{if(!e.current)return null;const f={color:d.color,lineWidth:d.lineWidth||2,title:d.title},g=e.current.addSeries(Ql,f);return d.id&&n.current.set(d.id,g),i.current||(i.current=g),g},[]),h=R.useCallback((d,f)=>{const g=f?n.current.get(f):i.current;g&&g.setData(d)},[]),a=R.useCallback((d,f)=>{const g=f?n.current.get(f):i.current;g&&g.update(d)},[]),l=R.useCallback(()=>{if(e.current){if(n.current.forEach(d=>{var f;(f=e.current)==null||f.removeSeries(d)}),i.current)try{e.current.removeSeries(i.current)}catch{}i.current=null,n.current.clear()}},[]),c=R.useCallback((d,f)=>{e.current&&e.current.applyOptions({width:d,height:f})},[]);return{chartContainerRef:t,chart:e.current,addLineSeries:o,updateSeriesData:h,addDataPoint:a,clearAllSeries:l,resizeChart:c}},Gl=({simulationResults:s,width:t=800,height:e=400,showPaths:i=10,showStatistics:n=!0,isLoading:r=!1})=>{const[o,h]=R.useState({width:t,height:e}),a=R.useMemo(()=>({width:o.width,height:o.height,layout:{backgroundColor:"#ffffff",textColor:"#333333"},grid:{vertLines:{color:"#f0f0f0"},horzLines:{color:"#f0f0f0"}},timeScale:{timeVisible:!1,secondsVisible:!1}}),[o]),{chartContainerRef:l,chart:c,addLineSeries:d,clearAllSeries:f,resizeChart:g}=Kl(a),p=R.useMemo(()=>{if(!s||!s.equity_paths.length)return null;const m=s.params.weeks*s.params.trades_per_week,x=[],b=[],v=[];for(let y=0;y<=m;y++){const w=s.equity_paths.map(k=>k[y]||k[k.length-1]).filter(k=>typeof k=="number");if(w.length===0)continue;w.sort((k,C)=>k-C);const S=w.reduce((k,C)=>k+C,0)/w.length,P=Math.floor(w.length*.25),M=Math.floor(w.length*.75);x.push(S),b.push(w[P]??S),v.push(w[M]??S)}return{individualPaths:s.equity_paths.slice(0,i),meanPath:x,p25Path:b,p75Path:v}},[s,i]);return R.useEffect(()=>{if(!c||!p)return;f();const{individualPaths:m,meanPath:x,p25Path:b,p75Path:v}=p;m.forEach((P,M)=>{const k=d({color:"rgba(128, 128, 128, 0.3)",lineWidth:1,title:`Path ${M+1}`,id:`path-${M}`});if(k){const C=P.map((z,j)=>({time:j,value:z}));k.setData(C)}});const y=d({color:"#4CAF50",lineWidth:2,title:"75th Percentile",id:"p75"}),w=d({color:"#F44336",lineWidth:2,title:"25th Percentile",id:"p25"}),S=d({color:"#2196F3",lineWidth:3,title:"Mean Path",id:"mean"});if(y){const P=v.map((M,k)=>({time:k,value:M}));y.setData(P)}if(w){const P=b.map((M,k)=>({time:k,value:M}));w.setData(P)}if(S){const P=x.map((M,k)=>({time:k,value:M}));S.setData(P)}},[c,p,d,f]),R.useEffect(()=>{const m=()=>{var b;const x=(b=l.current)==null?void 0:b.parentElement;if(x){const v=x.clientWidth,y=Math.min(v-32,t);h({width:y,height:e}),g(y,e)}};return window.addEventListener("resize",m),m(),()=>window.removeEventListener("resize",m)},[t,e,g,l]),r?u.jsx("div",{className:"flex items-center justify-center bg-gray-50 border border-gray-200 rounded-lg",style:{width:o.width,height:o.height},children:u.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Generating equity curves..."})]})}):!s||!p?u.jsx("div",{className:"flex items-center justify-center bg-gray-50 border border-gray-200 rounded-lg",style:{width:o.width,height:o.height},children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-gray-400 mb-2",children:"📈"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Run a simulation to see equity curves"})]})}):u.jsxs("div",{className:"equity-curve-chart",children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Monte Carlo Equity Curves"}),u.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[u.jsxs("span",{children:["📊 Showing ",i," sample paths"]}),u.jsxs("span",{children:["📈 ",s.equity_paths.length," total simulations"]}),u.jsxs("span",{children:["⏱️ ",s.params.weeks," weeks × ",s.params.trades_per_week," trades/week"]})]})]}),u.jsxs("div",{className:"chart-container bg-white border border-gray-200 rounded-lg p-4",children:[u.jsx("div",{ref:l}),u.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 pt-3 border-t border-gray-100 text-xs",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:"w-3 h-0.5 bg-blue-500"}),u.jsx("span",{children:"Mean Path"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:"w-3 h-0.5 bg-green-500"}),u.jsx("span",{children:"75th Percentile"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:"w-3 h-0.5 bg-red-500"}),u.jsx("span",{children:"25th Percentile"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:"w-3 h-0.5 bg-gray-400 opacity-50"}),u.jsx("span",{children:"Sample Paths"})]})]})]}),n&&s.statistics&&u.jsxs("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:[u.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Simulation Statistics"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Mean Final Equity"}),u.jsxs("div",{className:"font-semibold",children:["$",s.statistics.mean_final_equity.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Median Final Equity"}),u.jsxs("div",{className:"font-semibold",children:["$",s.statistics.median_final_equity.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"P(≥2×)"}),u.jsxs("div",{className:"font-semibold text-green-600",children:[(s.statistics.prob_2x*100).toFixed(1),"%"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"P(≥3×)"}),u.jsxs("div",{className:"font-semibold text-green-600",children:[(s.statistics.prob_3x*100).toFixed(1),"%"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Max Drawdown (P95)"}),u.jsxs("div",{className:"font-semibold text-red-600",children:[(s.statistics.p95_max_drawdown*100).toFixed(1),"%"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Sharpe Ratio"}),u.jsx("div",{className:"font-semibold",children:s.statistics.sharpe_ratio.toFixed(2)})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Profit Factor"}),u.jsx("div",{className:"font-semibold",children:s.statistics.profit_factor.toFixed(2)})]})]})]}),u.jsx("div",{className:"text-xs text-gray-400 mt-2 text-center",children:"Powered by TradingView Lightweight Charts"})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ie(s){return s+.5|0}const Pt=(s,t,e)=>Math.max(Math.min(s,e),t);function we(s){return Pt(Ie(s*2.55),0,255)}function jt(s){return Pt(Ie(s*255),0,255)}function bt(s){return Pt(Ie(s/2.55)/100,0,1)}function Zn(s){return Pt(Ie(s*100),0,100)}const st={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Cs=[..."0123456789ABCDEF"],Zl=s=>Cs[s&15],Jl=s=>Cs[(s&240)>>4]+Cs[s&15],Ge=s=>(s&240)>>4===(s&15),tc=s=>Ge(s.r)&&Ge(s.g)&&Ge(s.b)&&Ge(s.a);function ec(s){var t=s.length,e;return s[0]==="#"&&(t===4||t===5?e={r:255&st[s[1]]*17,g:255&st[s[2]]*17,b:255&st[s[3]]*17,a:t===5?st[s[4]]*17:255}:(t===7||t===9)&&(e={r:st[s[1]]<<4|st[s[2]],g:st[s[3]]<<4|st[s[4]],b:st[s[5]]<<4|st[s[6]],a:t===9?st[s[7]]<<4|st[s[8]]:255})),e}const ic=(s,t)=>s<255?t(s):"";function sc(s){var t=tc(s)?Zl:Jl;return s?"#"+t(s.r)+t(s.g)+t(s.b)+ic(s.a,t):void 0}const nc=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Eo(s,t,e){const i=t*Math.min(e,1-e),n=(r,o=(r+s/30)%12)=>e-i*Math.max(Math.min(o-3,9-o,1),-1);return[n(0),n(8),n(4)]}function rc(s,t,e){const i=(n,r=(n+s/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function oc(s,t,e){const i=Eo(s,1,.5);let n;for(t+e>1&&(n=1/(t+e),t*=n,e*=n),n=0;n<3;n++)i[n]*=1-t-e,i[n]+=t;return i}function hc(s,t,e,i,n){return s===n?(t-e)/i+(t<e?6:0):t===n?(e-s)/i+2:(s-t)/i+4}function Vs(s){const e=s.r/255,i=s.g/255,n=s.b/255,r=Math.max(e,i,n),o=Math.min(e,i,n),h=(r+o)/2;let a,l,c;return r!==o&&(c=r-o,l=h>.5?c/(2-r-o):c/(r+o),a=hc(e,i,n,c,r),a=a*60+.5),[a|0,l||0,h]}function Ys(s,t,e,i){return(Array.isArray(t)?s(t[0],t[1],t[2]):s(t,e,i)).map(jt)}function $s(s,t,e){return Ys(Eo,s,t,e)}function ac(s,t,e){return Ys(oc,s,t,e)}function lc(s,t,e){return Ys(rc,s,t,e)}function Lo(s){return(s%360+360)%360}function cc(s){const t=nc.exec(s);let e=255,i;if(!t)return;t[5]!==i&&(e=t[6]?we(+t[5]):jt(+t[5]));const n=Lo(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?i=ac(n,r,o):t[1]==="hsv"?i=lc(n,r,o):i=$s(n,r,o),{r:i[0],g:i[1],b:i[2],a:e}}function dc(s,t){var e=Vs(s);e[0]=Lo(e[0]+t),e=$s(e),s.r=e[0],s.g=e[1],s.b=e[2]}function uc(s){if(!s)return;const t=Vs(s),e=t[0],i=Zn(t[1]),n=Zn(t[2]);return s.a<255?`hsla(${e}, ${i}%, ${n}%, ${bt(s.a)})`:`hsl(${e}, ${i}%, ${n}%)`}const Jn={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},tr={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function fc(){const s={},t=Object.keys(tr),e=Object.keys(Jn);let i,n,r,o,h;for(i=0;i<t.length;i++){for(o=h=t[i],n=0;n<e.length;n++)r=e[n],h=h.replace(r,Jn[r]);r=parseInt(tr[o],16),s[h]=[r>>16&255,r>>8&255,r&255]}return s}let Ze;function gc(s){Ze||(Ze=fc(),Ze.transparent=[0,0,0,0]);const t=Ze[s.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const pc=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function mc(s){const t=pc.exec(s);let e=255,i,n,r;if(t){if(t[7]!==i){const o=+t[7];e=t[8]?we(o):Pt(o*255,0,255)}return i=+t[1],n=+t[3],r=+t[5],i=255&(t[2]?we(i):Pt(i,0,255)),n=255&(t[4]?we(n):Pt(n,0,255)),r=255&(t[6]?we(r):Pt(r,0,255)),{r:i,g:n,b:r,a:e}}}function xc(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${bt(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const os=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,Gt=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function bc(s,t,e){const i=Gt(bt(s.r)),n=Gt(bt(s.g)),r=Gt(bt(s.b));return{r:jt(os(i+e*(Gt(bt(t.r))-i))),g:jt(os(n+e*(Gt(bt(t.g))-n))),b:jt(os(r+e*(Gt(bt(t.b))-r))),a:s.a+e*(t.a-s.a)}}function Je(s,t,e){if(s){let i=Vs(s);i[t]=Math.max(0,Math.min(i[t]+i[t]*e,t===0?360:1)),i=$s(i),s.r=i[0],s.g=i[1],s.b=i[2]}}function Fo(s,t){return s&&Object.assign(t||{},s)}function er(s){var t={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(t={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(t.a=jt(s[3]))):(t=Fo(s,{r:0,g:0,b:0,a:1}),t.a=jt(t.a)),t}function vc(s){return s.charAt(0)==="r"?mc(s):cc(s)}class Le{constructor(t){if(t instanceof Le)return t;const e=typeof t;let i;e==="object"?i=er(t):e==="string"&&(i=ec(t)||gc(t)||vc(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Fo(this._rgb);return t&&(t.a=bt(t.a)),t}set rgb(t){this._rgb=er(t)}rgbString(){return this._valid?xc(this._rgb):void 0}hexString(){return this._valid?sc(this._rgb):void 0}hslString(){return this._valid?uc(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,n=t.rgb;let r;const o=e===r?.5:e,h=2*o-1,a=i.a-n.a,l=((h*a===-1?h:(h+a)/(1+h*a))+1)/2;r=1-l,i.r=255&l*i.r+r*n.r+.5,i.g=255&l*i.g+r*n.g+.5,i.b=255&l*i.b+r*n.b+.5,i.a=o*i.a+(1-o)*n.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=bc(this._rgb,t._rgb,e)),this}clone(){return new Le(this.rgb)}alpha(t){return this._rgb.a=jt(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Ie(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Je(this._rgb,2,t),this}darken(t){return Je(this._rgb,2,-t),this}saturate(t){return Je(this._rgb,1,t),this}desaturate(t){return Je(this._rgb,1,-t),this}rotate(t){return dc(this._rgb,t),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function pt(){}const yc=(()=>{let s=0;return()=>s++})();function A(s){return s==null}function Y(s){if(Array.isArray&&Array.isArray(s))return!0;const t=Object.prototype.toString.call(s);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function E(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function rt(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function ut(s,t){return rt(s)?s:t}function L(s,t){return typeof s>"u"?t:s}const _c=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*t:+s;function B(s,t,e){if(s&&typeof s.call=="function")return s.apply(e,t)}function F(s,t,e,i){let n,r,o;if(Y(s))for(r=s.length,n=0;n<r;n++)t.call(e,s[n],n);else if(E(s))for(o=Object.keys(s),r=o.length,n=0;n<r;n++)t.call(e,s[o[n]],o[n])}function wi(s,t){let e,i,n,r;if(!s||!t||s.length!==t.length)return!1;for(e=0,i=s.length;e<i;++e)if(n=s[e],r=t[e],n.datasetIndex!==r.datasetIndex||n.index!==r.index)return!1;return!0}function Si(s){if(Y(s))return s.map(Si);if(E(s)){const t=Object.create(null),e=Object.keys(s),i=e.length;let n=0;for(;n<i;++n)t[e[n]]=Si(s[e[n]]);return t}return s}function Oo(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function wc(s,t,e,i){if(!Oo(s))return;const n=t[s],r=e[s];E(n)&&E(r)?Fe(n,r,i):t[s]=Si(r)}function Fe(s,t,e){const i=Y(t)?t:[t],n=i.length;if(!E(s))return s;e=e||{};const r=e.merger||wc;let o;for(let h=0;h<n;++h){if(o=i[h],!E(o))continue;const a=Object.keys(o);for(let l=0,c=a.length;l<c;++l)r(a[l],s,o,e)}return s}function Re(s,t){return Fe(s,t,{merger:Sc})}function Sc(s,t,e){if(!Oo(s))return;const i=t[s],n=e[s];E(i)&&E(n)?Re(i,n):Object.prototype.hasOwnProperty.call(t,s)||(t[s]=Si(n))}const ir={"":s=>s,x:s=>s.x,y:s=>s.y};function kc(s){const t=s.split("."),e=[];let i="";for(const n of t)i+=n,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}function Mc(s){const t=kc(s);return e=>{for(const i of t){if(i==="")break;e=e&&e[i]}return e}}function he(s,t){return(ir[t]||(ir[t]=Mc(t)))(s)}function Hs(s){return s.charAt(0).toUpperCase()+s.slice(1)}const Oe=s=>typeof s<"u",Dt=s=>typeof s=="function",sr=(s,t)=>{if(s.size!==t.size)return!1;for(const e of s)if(!t.has(e))return!1;return!0};function Pc(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const K=Math.PI,Rt=2*K,ki=Number.POSITIVE_INFINITY,Cc=K/180,at=K/2,Ot=K/4,nr=K*2/3,Ao=Math.log10,zt=Math.sign;function di(s,t,e){return Math.abs(s-t)<e}function rr(s){const t=Math.round(s);s=di(s,t,s/1e3)?t:s;const e=Math.pow(10,Math.floor(Ao(s))),i=s/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function jc(s){const t=[],e=Math.sqrt(s);let i;for(i=1;i<e;i++)s%i===0&&(t.push(i),t.push(s/i));return e===(e|0)&&t.push(e),t.sort((n,r)=>n-r).pop(),t}function Rc(s){return typeof s=="symbol"||typeof s=="object"&&s!==null&&!(Symbol.toPrimitive in s||"toString"in s||"valueOf"in s)}function Mi(s){return!Rc(s)&&!isNaN(parseFloat(s))&&isFinite(s)}function zc(s,t){const e=Math.round(s);return e-t<=s&&e+t>=s}function Dc(s,t,e){let i,n,r;for(i=0,n=s.length;i<n;i++)r=s[i][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function Vt(s){return s*(K/180)}function Tc(s){return s*(180/K)}function or(s){if(!rt(s))return;let t=1,e=0;for(;Math.round(s*t)/t!==s;)t*=10,e++;return e}function Ec(s,t){const e=t.x-s.x,i=t.y-s.y,n=Math.sqrt(e*e+i*i);let r=Math.atan2(i,e);return r<-.5*K&&(r+=Rt),{angle:r,distance:n}}function Lc(s,t){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function At(s){return(s%Rt+Rt)%Rt}function Fc(s,t,e,i){const n=At(s),r=At(t),o=At(e),h=At(r-n),a=At(o-n),l=At(n-r),c=At(n-o);return n===r||n===o||i||h>a&&l<c}function lt(s,t,e){return Math.max(t,Math.min(e,s))}function Oc(s){return lt(s,-32768,32767)}function Jt(s,t,e,i=1e-6){return s>=Math.min(t,e)-i&&s<=Math.max(t,e)+i}function qs(s,t,e){e=e||(o=>s[o]<t);let i=s.length-1,n=0,r;for(;i-n>1;)r=n+i>>1,e(r)?n=r:i=r;return{lo:n,hi:i}}const js=(s,t,e,i)=>qs(s,e,i?n=>{const r=s[n][t];return r<e||r===e&&s[n+1][t]===e}:n=>s[n][t]<e),Ac=(s,t,e)=>qs(s,e,i=>s[i][t]>=e);function Nc(s,t,e){let i=0,n=s.length;for(;i<n&&s[i]<t;)i++;for(;n>i&&s[n-1]>e;)n--;return i>0||n<s.length?s.slice(i,n):s}const No=["push","pop","shift","splice","unshift"];function Bc(s,t){if(s._chartjs){s._chartjs.listeners.push(t);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),No.forEach(e=>{const i="_onData"+Hs(e),n=s[e];Object.defineProperty(s,e,{configurable:!0,enumerable:!1,value(...r){const o=n.apply(this,r);return s._chartjs.listeners.forEach(h=>{typeof h[i]=="function"&&h[i](...r)}),o}})})}function hr(s,t){const e=s._chartjs;if(!e)return;const i=e.listeners,n=i.indexOf(t);n!==-1&&i.splice(n,1),!(i.length>0)&&(No.forEach(r=>{delete s[r]}),delete s._chartjs)}function Bo(s){const t=new Set(s);return t.size===s.length?s:Array.from(t)}const Io=function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame}();function Wo(s,t){let e=[],i=!1;return function(...n){e=n,i||(i=!0,Io.call(window,()=>{i=!1,s.apply(t,e)}))}}function Ic(s,t){let e;return function(...i){return t?(clearTimeout(e),e=setTimeout(s,t,i)):s.apply(this,i),t}}const Us=s=>s==="start"?"left":s==="end"?"right":"center",X=(s,t,e)=>s==="start"?t:s==="end"?e:(t+e)/2,Wc=(s,t,e,i)=>s===(i?"left":"right")?e:s==="center"?(t+e)/2:t,ti=s=>s===0||s===1,ar=(s,t,e)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-t)*Rt/e)),lr=(s,t,e)=>Math.pow(2,-10*s)*Math.sin((s-t)*Rt/e)+1,ze={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*at)+1,easeOutSine:s=>Math.sin(s*at),easeInOutSine:s=>-.5*(Math.cos(K*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>ti(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>ti(s)?s:ar(s,.075,.3),easeOutElastic:s=>ti(s)?s:lr(s,.075,.3),easeInOutElastic(s){return ti(s)?s:s<.5?.5*ar(s*2,.1125,.45):.5+.5*lr(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let t=1.70158;return(s/=.5)<1?.5*(s*s*(((t*=1.525)+1)*s-t)):.5*((s-=2)*s*(((t*=1.525)+1)*s+t)+2)},easeInBounce:s=>1-ze.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?ze.easeInBounce(s*2)*.5:ze.easeOutBounce(s*2-1)*.5+.5};function Vo(s){if(s&&typeof s=="object"){const t=s.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function cr(s){return Vo(s)?s:new Le(s)}function hs(s){return Vo(s)?s:new Le(s).saturate(.5).darken(.1).hexString()}const Vc=["x","y","borderWidth","radius","tension"],Yc=["color","borderColor","backgroundColor"];function $c(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),s.set("animations",{colors:{type:"color",properties:Yc},numbers:{type:"number",properties:Vc}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Hc(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const dr=new Map;function qc(s,t){t=t||{};const e=s+JSON.stringify(t);let i=dr.get(e);return i||(i=new Intl.NumberFormat(s,t),dr.set(e,i)),i}function Yo(s,t,e){return qc(t,e).format(s)}const Uc={values(s){return Y(s)?s:""+s},numeric(s,t,e){if(s===0)return"0";const i=this.chart.options.locale;let n,r=s;if(e.length>1){const l=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(l<1e-4||l>1e15)&&(n="scientific"),r=Xc(s,e)}const o=Ao(Math.abs(r)),h=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),a={notation:n,minimumFractionDigits:h,maximumFractionDigits:h};return Object.assign(a,this.options.ticks.format),Yo(s,i,a)}};function Xc(s,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&s!==Math.floor(s)&&(e=s-Math.floor(s)),e}var $o={formatters:Uc};function Qc(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:$o.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Xt=Object.create(null),Rs=Object.create(null);function De(s,t){if(!t)return s;const e=t.split(".");for(let i=0,n=e.length;i<n;++i){const r=e[i];s=s[r]||(s[r]=Object.create(null))}return s}function as(s,t,e){return typeof t=="string"?Fe(De(s,t),e):Fe(De(s,""),t)}class Kc{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,n)=>hs(n.backgroundColor),this.hoverBorderColor=(i,n)=>hs(n.borderColor),this.hoverColor=(i,n)=>hs(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return as(this,t,e)}get(t){return De(this,t)}describe(t,e){return as(Rs,t,e)}override(t,e){return as(Xt,t,e)}route(t,e,i,n){const r=De(this,t),o=De(this,i),h="_"+e;Object.defineProperties(r,{[h]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const a=this[h],l=o[n];return E(a)?Object.assign({},l,a):L(a,l)},set(a){this[h]=a}}})}apply(t){t.forEach(e=>e(this))}}var I=new Kc({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[$c,Hc,Qc]);function Gc(s){return!s||A(s.size)||A(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function ur(s,t,e,i,n){let r=t[n];return r||(r=t[n]=s.measureText(n).width,e.push(n)),r>i&&(i=r),i}function Nt(s,t,e){const i=s.currentDevicePixelRatio,n=e!==0?Math.max(e/2,.5):0;return Math.round((t-n)*i)/i+n}function fr(s,t){!t&&!s||(t=t||s.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,s.width,s.height),t.restore())}function gr(s,t,e,i){Ho(s,t,e,i,null)}function Ho(s,t,e,i,n){let r,o,h,a,l,c,d,f;const g=t.pointStyle,p=t.rotation,m=t.radius;let x=(p||0)*Cc;if(g&&typeof g=="object"&&(r=g.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){s.save(),s.translate(e,i),s.rotate(x),s.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),s.restore();return}if(!(isNaN(m)||m<=0)){switch(s.beginPath(),g){default:n?s.ellipse(e,i,n/2,m,0,0,Rt):s.arc(e,i,m,0,Rt),s.closePath();break;case"triangle":c=n?n/2:m,s.moveTo(e+Math.sin(x)*c,i-Math.cos(x)*m),x+=nr,s.lineTo(e+Math.sin(x)*c,i-Math.cos(x)*m),x+=nr,s.lineTo(e+Math.sin(x)*c,i-Math.cos(x)*m),s.closePath();break;case"rectRounded":l=m*.516,a=m-l,o=Math.cos(x+Ot)*a,d=Math.cos(x+Ot)*(n?n/2-l:a),h=Math.sin(x+Ot)*a,f=Math.sin(x+Ot)*(n?n/2-l:a),s.arc(e-d,i-h,l,x-K,x-at),s.arc(e+f,i-o,l,x-at,x),s.arc(e+d,i+h,l,x,x+at),s.arc(e-f,i+o,l,x+at,x+K),s.closePath();break;case"rect":if(!p){a=Math.SQRT1_2*m,c=n?n/2:a,s.rect(e-c,i-a,2*c,2*a);break}x+=Ot;case"rectRot":d=Math.cos(x)*(n?n/2:m),o=Math.cos(x)*m,h=Math.sin(x)*m,f=Math.sin(x)*(n?n/2:m),s.moveTo(e-d,i-h),s.lineTo(e+f,i-o),s.lineTo(e+d,i+h),s.lineTo(e-f,i+o),s.closePath();break;case"crossRot":x+=Ot;case"cross":d=Math.cos(x)*(n?n/2:m),o=Math.cos(x)*m,h=Math.sin(x)*m,f=Math.sin(x)*(n?n/2:m),s.moveTo(e-d,i-h),s.lineTo(e+d,i+h),s.moveTo(e+f,i-o),s.lineTo(e-f,i+o);break;case"star":d=Math.cos(x)*(n?n/2:m),o=Math.cos(x)*m,h=Math.sin(x)*m,f=Math.sin(x)*(n?n/2:m),s.moveTo(e-d,i-h),s.lineTo(e+d,i+h),s.moveTo(e+f,i-o),s.lineTo(e-f,i+o),x+=Ot,d=Math.cos(x)*(n?n/2:m),o=Math.cos(x)*m,h=Math.sin(x)*m,f=Math.sin(x)*(n?n/2:m),s.moveTo(e-d,i-h),s.lineTo(e+d,i+h),s.moveTo(e+f,i-o),s.lineTo(e-f,i+o);break;case"line":o=n?n/2:Math.cos(x)*m,h=Math.sin(x)*m,s.moveTo(e-o,i-h),s.lineTo(e+o,i+h);break;case"dash":s.moveTo(e,i),s.lineTo(e+Math.cos(x)*(n?n/2:m),i+Math.sin(x)*m);break;case!1:s.closePath();break}s.fill(),t.borderWidth>0&&s.stroke()}}function qo(s,t,e){return e=e||.5,!t||s&&s.x>t.left-e&&s.x<t.right+e&&s.y>t.top-e&&s.y<t.bottom+e}function Xs(s,t){s.save(),s.beginPath(),s.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),s.clip()}function Qs(s){s.restore()}function Zc(s,t){t.translation&&s.translate(t.translation[0],t.translation[1]),A(t.rotation)||s.rotate(t.rotation),t.color&&(s.fillStyle=t.color),t.textAlign&&(s.textAlign=t.textAlign),t.textBaseline&&(s.textBaseline=t.textBaseline)}function Jc(s,t,e,i,n){if(n.strikethrough||n.underline){const r=s.measureText(i),o=t-r.actualBoundingBoxLeft,h=t+r.actualBoundingBoxRight,a=e-r.actualBoundingBoxAscent,l=e+r.actualBoundingBoxDescent,c=n.strikethrough?(a+l)/2:l;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=n.decorationWidth||2,s.moveTo(o,c),s.lineTo(h,c),s.stroke()}}function td(s,t){const e=s.fillStyle;s.fillStyle=t.color,s.fillRect(t.left,t.top,t.width,t.height),s.fillStyle=e}function Ae(s,t,e,i,n,r={}){const o=Y(t)?t:[t],h=r.strokeWidth>0&&r.strokeColor!=="";let a,l;for(s.save(),s.font=n.string,Zc(s,r),a=0;a<o.length;++a)l=o[a],r.backdrop&&td(s,r.backdrop),h&&(r.strokeColor&&(s.strokeStyle=r.strokeColor),A(r.strokeWidth)||(s.lineWidth=r.strokeWidth),s.strokeText(l,e,i,r.maxWidth)),s.fillText(l,e,i,r.maxWidth),Jc(s,e,i,l,r),i+=Number(n.lineHeight);s.restore()}function Pi(s,t){const{x:e,y:i,w:n,h:r,radius:o}=t;s.arc(e+o.topLeft,i+o.topLeft,o.topLeft,1.5*K,K,!0),s.lineTo(e,i+r-o.bottomLeft),s.arc(e+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,K,at,!0),s.lineTo(e+n-o.bottomRight,i+r),s.arc(e+n-o.bottomRight,i+r-o.bottomRight,o.bottomRight,at,0,!0),s.lineTo(e+n,i+o.topRight),s.arc(e+n-o.topRight,i+o.topRight,o.topRight,0,-at,!0),s.lineTo(e+o.topLeft,i)}const ed=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,id=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function sd(s,t){const e=(""+s).match(ed);if(!e||e[1]==="normal")return t*1.2;switch(s=+e[2],e[3]){case"px":return s;case"%":s/=100;break}return t*s}const nd=s=>+s||0;function Uo(s,t){const e={},i=E(t),n=i?Object.keys(t):t,r=E(s)?i?o=>L(s[o],s[t[o]]):o=>s[o]:()=>s;for(const o of n)e[o]=nd(r(o));return e}function Xo(s){return Uo(s,{top:"y",right:"x",bottom:"y",left:"x"})}function ee(s){return Uo(s,["topLeft","topRight","bottomLeft","bottomRight"])}function ot(s){const t=Xo(s);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Q(s,t){s=s||{},t=t||I.font;let e=L(s.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let i=L(s.style,t.style);i&&!(""+i).match(id)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const n={family:L(s.family,t.family),lineHeight:sd(L(s.lineHeight,t.lineHeight),e),size:e,style:i,weight:L(s.weight,t.weight),string:""};return n.string=Gc(n),n}function ei(s,t,e,i){let n,r,o;for(n=0,r=s.length;n<r;++n)if(o=s[n],o!==void 0&&o!==void 0)return o}function rd(s,t,e){const{min:i,max:n}=s,r=_c(t,(n-i)/2),o=(h,a)=>e&&h===0?0:h+a;return{min:o(i,-Math.abs(r)),max:o(n,r)}}function ce(s,t){return Object.assign(Object.create(s),t)}function Ks(s,t=[""],e,i,n=()=>s[0]){const r=e||s;typeof i>"u"&&(i=Zo("_fallback",s));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:r,_fallback:i,_getTarget:n,override:h=>Ks([h,...s],t,r,i)};return new Proxy(o,{deleteProperty(h,a){return delete h[a],delete h._keys,delete s[0][a],!0},get(h,a){return Ko(h,a,()=>fd(a,t,s,h))},getOwnPropertyDescriptor(h,a){return Reflect.getOwnPropertyDescriptor(h._scopes[0],a)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(h,a){return mr(h).includes(a)},ownKeys(h){return mr(h)},set(h,a,l){const c=h._storage||(h._storage=n());return h[a]=c[a]=l,delete h._keys,!0}})}function ae(s,t,e,i){const n={_cacheable:!1,_proxy:s,_context:t,_subProxy:e,_stack:new Set,_descriptors:Qo(s,i),setContext:r=>ae(s,r,e,i),override:r=>ae(s.override(r),t,e,i)};return new Proxy(n,{deleteProperty(r,o){return delete r[o],delete s[o],!0},get(r,o,h){return Ko(r,o,()=>hd(r,o,h))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(s,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,o)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(r,o){return Reflect.has(s,o)},ownKeys(){return Reflect.ownKeys(s)},set(r,o,h){return s[o]=h,delete r[o],!0}})}function Qo(s,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:i=t.indexable,_allKeys:n=t.allKeys}=s;return{allKeys:n,scriptable:e,indexable:i,isScriptable:Dt(e)?e:()=>e,isIndexable:Dt(i)?i:()=>i}}const od=(s,t)=>s?s+Hs(t):t,Gs=(s,t)=>E(t)&&s!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Ko(s,t,e){if(Object.prototype.hasOwnProperty.call(s,t)||t==="constructor")return s[t];const i=e();return s[t]=i,i}function hd(s,t,e){const{_proxy:i,_context:n,_subProxy:r,_descriptors:o}=s;let h=i[t];return Dt(h)&&o.isScriptable(t)&&(h=ad(t,h,s,e)),Y(h)&&h.length&&(h=ld(t,h,s,o.isIndexable)),Gs(t,h)&&(h=ae(h,n,r&&r[t],o)),h}function ad(s,t,e,i){const{_proxy:n,_context:r,_subProxy:o,_stack:h}=e;if(h.has(s))throw new Error("Recursion detected: "+Array.from(h).join("->")+"->"+s);h.add(s);let a=t(r,o||i);return h.delete(s),Gs(s,a)&&(a=Zs(n._scopes,n,s,a)),a}function ld(s,t,e,i){const{_proxy:n,_context:r,_subProxy:o,_descriptors:h}=e;if(typeof r.index<"u"&&i(s))return t[r.index%t.length];if(E(t[0])){const a=t,l=n._scopes.filter(c=>c!==a);t=[];for(const c of a){const d=Zs(l,n,s,c);t.push(ae(d,r,o&&o[s],h))}}return t}function Go(s,t,e){return Dt(s)?s(t,e):s}const cd=(s,t)=>s===!0?t:typeof s=="string"?he(t,s):void 0;function dd(s,t,e,i,n){for(const r of t){const o=cd(e,r);if(o){s.add(o);const h=Go(o._fallback,e,n);if(typeof h<"u"&&h!==e&&h!==i)return h}else if(o===!1&&typeof i<"u"&&e!==i)return null}return!1}function Zs(s,t,e,i){const n=t._rootScopes,r=Go(t._fallback,e,i),o=[...s,...n],h=new Set;h.add(i);let a=pr(h,o,e,r||e,i);return a===null||typeof r<"u"&&r!==e&&(a=pr(h,o,r,a,i),a===null)?!1:Ks(Array.from(h),[""],n,r,()=>ud(t,e,i))}function pr(s,t,e,i,n){for(;e;)e=dd(s,t,e,i,n);return e}function ud(s,t,e){const i=s._getTarget();t in i||(i[t]={});const n=i[t];return Y(n)&&E(e)?e:n||{}}function fd(s,t,e,i){let n;for(const r of t)if(n=Zo(od(r,s),e),typeof n<"u")return Gs(s,n)?Zs(e,i,s,n):n}function Zo(s,t){for(const e of t){if(!e)continue;const i=e[s];if(typeof i<"u")return i}}function mr(s){let t=s._keys;return t||(t=s._keys=gd(s._scopes)),t}function gd(s){const t=new Set;for(const e of s)for(const i of Object.keys(e).filter(n=>!n.startsWith("_")))t.add(i);return Array.from(t)}function Js(){return typeof window<"u"&&typeof document<"u"}function tn(s){let t=s.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Ci(s,t,e){let i;return typeof s=="string"?(i=parseInt(s,10),s.indexOf("%")!==-1&&(i=i/100*t.parentNode[e])):i=s,i}const Ni=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function pd(s,t){return Ni(s).getPropertyValue(t)}const md=["top","right","bottom","left"];function $t(s,t,e){const i={};e=e?"-"+e:"";for(let n=0;n<4;n++){const r=md[n];i[r]=parseFloat(s[t+"-"+r+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const xd=(s,t,e)=>(s>0||t>0)&&(!e||!e.shadowRoot);function bd(s,t){const e=s.touches,i=e&&e.length?e[0]:s,{offsetX:n,offsetY:r}=i;let o=!1,h,a;if(xd(n,r,s.target))h=n,a=r;else{const l=t.getBoundingClientRect();h=i.clientX-l.left,a=i.clientY-l.top,o=!0}return{x:h,y:a,box:o}}function It(s,t){if("native"in s)return s;const{canvas:e,currentDevicePixelRatio:i}=t,n=Ni(e),r=n.boxSizing==="border-box",o=$t(n,"padding"),h=$t(n,"border","width"),{x:a,y:l,box:c}=bd(s,e),d=o.left+(c&&h.left),f=o.top+(c&&h.top);let{width:g,height:p}=t;return r&&(g-=o.width+h.width,p-=o.height+h.height),{x:Math.round((a-d)/g*e.width/i),y:Math.round((l-f)/p*e.height/i)}}function vd(s,t,e){let i,n;if(t===void 0||e===void 0){const r=s&&tn(s);if(!r)t=s.clientWidth,e=s.clientHeight;else{const o=r.getBoundingClientRect(),h=Ni(r),a=$t(h,"border","width"),l=$t(h,"padding");t=o.width-l.width-a.width,e=o.height-l.height-a.height,i=Ci(h.maxWidth,r,"clientWidth"),n=Ci(h.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:i||ki,maxHeight:n||ki}}const ii=s=>Math.round(s*10)/10;function yd(s,t,e,i){const n=Ni(s),r=$t(n,"margin"),o=Ci(n.maxWidth,s,"clientWidth")||ki,h=Ci(n.maxHeight,s,"clientHeight")||ki,a=vd(s,t,e);let{width:l,height:c}=a;if(n.boxSizing==="content-box"){const f=$t(n,"border","width"),g=$t(n,"padding");l-=g.width+f.width,c-=g.height+f.height}return l=Math.max(0,l-r.width),c=Math.max(0,i?l/i:c-r.height),l=ii(Math.min(l,o,a.maxWidth)),c=ii(Math.min(c,h,a.maxHeight)),l&&!c&&(c=ii(l/2)),(t!==void 0||e!==void 0)&&i&&a.height&&c>a.height&&(c=a.height,l=ii(Math.floor(c*i))),{width:l,height:c}}function xr(s,t,e){const i=t||1,n=Math.floor(s.height*i),r=Math.floor(s.width*i);s.height=Math.floor(s.height),s.width=Math.floor(s.width);const o=s.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${s.height}px`,o.style.width=`${s.width}px`),s.currentDevicePixelRatio!==i||o.height!==n||o.width!==r?(s.currentDevicePixelRatio=i,o.height=n,o.width=r,s.ctx.setTransform(i,0,0,i,0,0),!0):!1}const _d=function(){let s=!1;try{const t={get passive(){return s=!0,!1}};Js()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return s}();function br(s,t){const e=pd(s,t),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}const wd=function(s,t){return{x(e){return s+s+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,i){return e-i},leftForLtr(e,i){return e-i}}},Sd=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,t){return s+t},leftForLtr(s,t){return s}}};function ie(s,t,e){return s?wd(t,e):Sd()}function Jo(s,t){let e,i;(t==="ltr"||t==="rtl")&&(e=s.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),s.prevTextDirection=i)}function th(s,t){t!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",t[0],t[1]))}function si(s,t,e){return s.options.clip?s[e]:t[e]}function kd(s,t){const{xScale:e,yScale:i}=s;return e&&i?{left:si(e,t,"left"),right:si(e,t,"right"),top:si(i,t,"top"),bottom:si(i,t,"bottom")}:t}function Md(s,t){const e=t._clip;if(e.disabled)return!1;const i=kd(t,s.chartArea);return{left:e.left===!1?0:i.left-(e.left===!0?0:e.left),right:e.right===!1?s.width:i.right+(e.right===!0?0:e.right),top:e.top===!1?0:i.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?s.height:i.bottom+(e.bottom===!0?0:e.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Pd{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,n){const r=e.listeners[n],o=e.duration;r.forEach(h=>h({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(i-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Io.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,n)=>{if(!i.running||!i.items.length)return;const r=i.items;let o=r.length-1,h=!1,a;for(;o>=0;--o)a=r[o],a._active?(a._total>i.duration&&(i.duration=a._total),a.tick(t),h=!0):(r[o]=r[r.length-1],r.pop());h&&(n.draw(),this._notify(n,i,t,"progress")),r.length||(i.running=!1,this._notify(n,i,t,"complete"),i.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,n)=>Math.max(i,n._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let n=i.length-1;for(;n>=0;--n)i[n].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var mt=new Pd;const vr="transparent",Cd={boolean(s,t,e){return e>.5?t:s},color(s,t,e){const i=cr(s||vr),n=i.valid&&cr(t||vr);return n&&n.valid?n.mix(i,e).hexString():t},number(s,t,e){return s+(t-s)*e}};class jd{constructor(t,e,i,n){const r=e[i];n=ei([t.to,n,r,t.from]);const o=ei([t.from,r,n]);this._active=!0,this._fn=t.fn||Cd[t.type||typeof o],this._easing=ze[t.easing]||ze.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=n,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const n=this._target[this._prop],r=i-this._start,o=this._duration-r;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=ei([t.to,e,n,t.from]),this._from=ei([t.from,n,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,n=this._prop,r=this._from,o=this._loop,h=this._to;let a;if(this._active=r!==h&&(o||e<i),!this._active){this._target[n]=h,this._notify(!0);return}if(e<0){this._target[n]=r;return}a=e/i%2,a=o&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[n]=this._fn(r,h,a)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let n=0;n<i.length;n++)i[n][e]()}}class eh{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!E(t))return;const e=Object.keys(I.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(n=>{const r=t[n];if(!E(r))return;const o={};for(const h of e)o[h]=r[h];(Y(r.properties)&&r.properties||[n]).forEach(h=>{(h===n||!i.has(h))&&i.set(h,o)})})}_animateOptions(t,e){const i=e.options,n=zd(t,i);if(!n)return[];const r=this._createAnimations(n,i);return i.$shared&&Rd(t.options.$animations,i).then(()=>{t.options=i},()=>{}),r}_createAnimations(t,e){const i=this._properties,n=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),h=Date.now();let a;for(a=o.length-1;a>=0;--a){const l=o[a];if(l.charAt(0)==="$")continue;if(l==="options"){n.push(...this._animateOptions(t,e));continue}const c=e[l];let d=r[l];const f=i.get(l);if(d)if(f&&d.active()){d.update(f,c,h);continue}else d.cancel();if(!f||!f.duration){t[l]=c;continue}r[l]=d=new jd(f,t,l,c),n.push(d)}return n}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const i=this._createAnimations(t,e);if(i.length)return mt.add(this._chart,i),!0}}function Rd(s,t){const e=[],i=Object.keys(t);for(let n=0;n<i.length;n++){const r=s[i[n]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function zd(s,t){if(!t)return;let e=s.options;if(!e){s.options=t;return}return e.$shared&&(s.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function yr(s,t){const e=s&&s.options||{},i=e.reverse,n=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:i?r:n,end:i?n:r}}function Dd(s,t,e){if(e===!1)return!1;const i=yr(s,e),n=yr(t,e);return{top:n.end,right:i.end,bottom:n.start,left:i.start}}function Td(s){let t,e,i,n;return E(s)?(t=s.top,e=s.right,i=s.bottom,n=s.left):t=e=i=n=s,{top:t,right:e,bottom:i,left:n,disabled:s===!1}}function ih(s,t){const e=[],i=s._getSortedDatasetMetas(t);let n,r;for(n=0,r=i.length;n<r;++n)e.push(i[n].index);return e}function _r(s,t,e,i={}){const n=s.keys,r=i.mode==="single";let o,h,a,l;if(t===null)return;let c=!1;for(o=0,h=n.length;o<h;++o){if(a=+n[o],a===e){if(c=!0,i.all)continue;break}l=s.values[a],rt(l)&&(r||t===0||zt(t)===zt(l))&&(t+=l)}return!c&&!i.all?0:t}function Ed(s,t){const{iScale:e,vScale:i}=t,n=e.axis==="x"?"x":"y",r=i.axis==="x"?"x":"y",o=Object.keys(s),h=new Array(o.length);let a,l,c;for(a=0,l=o.length;a<l;++a)c=o[a],h[a]={[n]:c,[r]:s[c]};return h}function ls(s,t){const e=s&&s.options.stacked;return e||e===void 0&&t.stack!==void 0}function Ld(s,t,e){return`${s.id}.${t.id}.${e.stack||e.type}`}function Fd(s){const{min:t,max:e,minDefined:i,maxDefined:n}=s.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:n?e:Number.POSITIVE_INFINITY}}function Od(s,t,e){const i=s[t]||(s[t]={});return i[e]||(i[e]={})}function wr(s,t,e,i){for(const n of t.getMatchingVisibleMetas(i).reverse()){const r=s[n.index];if(e&&r>0||!e&&r<0)return n.index}return null}function Sr(s,t){const{chart:e,_cachedMeta:i}=s,n=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:h}=i,a=r.axis,l=o.axis,c=Ld(r,o,i),d=t.length;let f;for(let g=0;g<d;++g){const p=t[g],{[a]:m,[l]:x}=p,b=p._stacks||(p._stacks={});f=b[l]=Od(n,c,m),f[h]=x,f._top=wr(f,o,!0,i.type),f._bottom=wr(f,o,!1,i.type);const v=f._visualValues||(f._visualValues={});v[h]=x}}function cs(s,t){const e=s.scales;return Object.keys(e).filter(i=>e[i].axis===t).shift()}function Ad(s,t){return ce(s,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Nd(s,t,e){return ce(s,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function me(s,t){const e=s.controller.index,i=s.vScale&&s.vScale.axis;if(i){t=t||s._parsed;for(const n of t){const r=n._stacks;if(!r||r[i]===void 0||r[i][e]===void 0)return;delete r[i][e],r[i]._visualValues!==void 0&&r[i]._visualValues[e]!==void 0&&delete r[i]._visualValues[e]}}}const ds=s=>s==="reset"||s==="none",kr=(s,t)=>t?s:Object.assign({},s),Bd=(s,t,e)=>s&&!t.hidden&&t._stacked&&{keys:ih(e,!0),values:null};class Te{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=ls(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&me(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),n=(d,f,g,p)=>d==="x"?f:d==="r"?p:g,r=e.xAxisID=L(i.xAxisID,cs(t,"x")),o=e.yAxisID=L(i.yAxisID,cs(t,"y")),h=e.rAxisID=L(i.rAxisID,cs(t,"r")),a=e.indexAxis,l=e.iAxisID=n(a,r,o,h),c=e.vAxisID=n(a,o,r,h);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(h),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&hr(this._data,this),t._stacked&&me(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(E(e)){const n=this._cachedMeta;this._data=Ed(e,n)}else if(i!==e){if(i){hr(i,this);const n=this._cachedMeta;me(n),n._parsed=[]}e&&Object.isExtensible(e)&&Bc(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let n=!1;this._dataCheck();const r=e._stacked;e._stacked=ls(e.vScale,e),e.stack!==i.stack&&(n=!0,me(e),e.stack=i.stack),this._resyncElements(t),(n||r!==e._stacked)&&(Sr(this,e._parsed),e._stacked=ls(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:n}=this,{iScale:r,_stacked:o}=i,h=r.axis;let a=t===0&&e===n.length?!0:i._sorted,l=t>0&&i._parsed[t-1],c,d,f;if(this._parsing===!1)i._parsed=n,i._sorted=!0,f=n;else{Y(n[t])?f=this.parseArrayData(i,n,t,e):E(n[t])?f=this.parseObjectData(i,n,t,e):f=this.parsePrimitiveData(i,n,t,e);const g=()=>d[h]===null||l&&d[h]<l[h];for(c=0;c<e;++c)i._parsed[c+t]=d=f[c],a&&(g()&&(a=!1),l=d);i._sorted=a}o&&Sr(this,f)}parsePrimitiveData(t,e,i,n){const{iScale:r,vScale:o}=t,h=r.axis,a=o.axis,l=r.getLabels(),c=r===o,d=new Array(n);let f,g,p;for(f=0,g=n;f<g;++f)p=f+i,d[f]={[h]:c||r.parse(l[p],p),[a]:o.parse(e[p],p)};return d}parseArrayData(t,e,i,n){const{xScale:r,yScale:o}=t,h=new Array(n);let a,l,c,d;for(a=0,l=n;a<l;++a)c=a+i,d=e[c],h[a]={x:r.parse(d[0],c),y:o.parse(d[1],c)};return h}parseObjectData(t,e,i,n){const{xScale:r,yScale:o}=t,{xAxisKey:h="x",yAxisKey:a="y"}=this._parsing,l=new Array(n);let c,d,f,g;for(c=0,d=n;c<d;++c)f=c+i,g=e[f],l[c]={x:r.parse(he(g,h),f),y:o.parse(he(g,a),f)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const n=this.chart,r=this._cachedMeta,o=e[t.axis],h={keys:ih(n,!0),values:e._stacks[t.axis]._visualValues};return _r(h,o,r.index,{mode:i})}updateRangeFromParsed(t,e,i,n){const r=i[e.axis];let o=r===null?NaN:r;const h=n&&i._stacks[e.axis];n&&h&&(n.values=h,o=_r(n,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const i=this._cachedMeta,n=i._parsed,r=i._sorted&&t===i.iScale,o=n.length,h=this._getOtherScale(t),a=Bd(e,i,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=Fd(h);let f,g;function p(){g=n[f];const m=g[h.axis];return!rt(g[t.axis])||c>m||d<m}for(f=0;f<o&&!(!p()&&(this.updateRangeFromParsed(l,t,g,a),r));++f);if(r){for(f=o-1;f>=0;--f)if(!p()){this.updateRangeFromParsed(l,t,g,a);break}}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let n,r,o;for(n=0,r=e.length;n<r;++n)o=e[n][t.axis],rt(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,n=e.vScale,r=this.getParsed(t);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:n?""+n.getLabelForValue(r[n.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=Td(L(this.options.clip,Dd(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,n=i.data||[],r=e.chartArea,o=[],h=this._drawStart||0,a=this._drawCount||n.length-h,l=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(t,r,h,a),c=h;c<h+a;++c){const d=n[c];d.hidden||(d.active&&l?o.push(d):d.draw(t,r))}for(c=0;c<o.length;++c)o[c].draw(t,r)}getStyle(t,e){const i=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const n=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=Nd(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=n.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=Ad(this.chart.getContext(),this.index)),r.dataset=n,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=i,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const n=e==="active",r=this._cachedDataOpts,o=t+"-"+e,h=r[o],a=this.enableOptionSharing&&Oe(i);if(h)return kr(h,a);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),d=n?[`${t}Hover`,"hover",t,""]:[t,""],f=l.getOptionScopes(this.getDataset(),c),g=Object.keys(I.elements[t]),p=()=>this.getContext(i,n,e),m=l.resolveNamedOptions(f,g,p,d);return m.$shared&&(m.$shared=a,r[o]=Object.freeze(kr(m,a))),m}_resolveAnimations(t,e,i){const n=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,h=r[o];if(h)return h;let a;if(n.options.animation!==!1){const c=this.chart.config,d=c.datasetAnimationScopeKeys(this._type,e),f=c.getOptionScopes(this.getDataset(),d);a=c.createResolver(f,this.getContext(t,i,e))}const l=new eh(n,a&&a.animations);return a&&a._cacheable&&(r[o]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||ds(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),n=this._sharedOptions,r=this.getSharedOptions(i),o=this.includeOptions(e,r)||r!==n;return this.updateSharedOptions(r,e,i),{sharedOptions:r,includeOptions:o}}updateElement(t,e,i,n){ds(n)?Object.assign(t,i):this._resolveAnimations(e,n).update(t,i)}updateSharedOptions(t,e,i){t&&!ds(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,n){t.active=n;const r=this.getStyle(e,n);this._resolveAnimations(e,i,n).update(t,{options:!n&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[h,a,l]of this._syncList)this[h](a,l);this._syncList=[];const n=i.length,r=e.length,o=Math.min(r,n);o&&this.parse(0,o),r>n?this._insertElements(n,r-n,t):r<n&&this._removeElements(r,n-r)}_insertElements(t,e,i=!0){const n=this._cachedMeta,r=n.data,o=t+e;let h;const a=l=>{for(l.length+=e,h=l.length-1;h>=o;h--)l[h]=l[h-e]};for(a(r),h=t;h<o;++h)r[h]=new this.dataElementType;this._parsing&&a(n._parsed),this.parse(t,e),i&&this.updateElements(r,t,e,"reset")}updateElements(t,e,i,n){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const n=i._parsed.splice(t,e);i._stacked&&me(i,n)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,n]=t;this[e](i,n)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}T(Te,"defaults",{}),T(Te,"datasetElementType",null),T(Te,"dataElementType",null);function Id(s,t){if(!s._cache.$bar){const e=s.getMatchingVisibleMetas(t);let i=[];for(let n=0,r=e.length;n<r;n++)i=i.concat(e[n].controller.getAllParsedValues(s));s._cache.$bar=Bo(i.sort((n,r)=>n-r))}return s._cache.$bar}function Wd(s){const t=s.iScale,e=Id(t,s.type);let i=t._length,n,r,o,h;const a=()=>{o===32767||o===-32768||(Oe(h)&&(i=Math.min(i,Math.abs(o-h)||i)),h=o)};for(n=0,r=e.length;n<r;++n)o=t.getPixelForValue(e[n]),a();for(h=void 0,n=0,r=t.ticks.length;n<r;++n)o=t.getPixelForTick(n),a();return i}function Vd(s,t,e,i){const n=e.barThickness;let r,o;return A(n)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=n*i,o=1),{chunk:r/i,ratio:o,start:t.pixels[s]-r/2}}function Yd(s,t,e,i){const n=t.pixels,r=n[s];let o=s>0?n[s-1]:null,h=s<n.length-1?n[s+1]:null;const a=e.categoryPercentage;o===null&&(o=r-(h===null?t.end-t.start:h-r)),h===null&&(h=r+r-o);const l=r-(r-Math.min(o,h))/2*a;return{chunk:Math.abs(h-o)/2*a/i,ratio:e.barPercentage,start:l}}function $d(s,t,e,i){const n=e.parse(s[0],i),r=e.parse(s[1],i),o=Math.min(n,r),h=Math.max(n,r);let a=o,l=h;Math.abs(o)>Math.abs(h)&&(a=h,l=o),t[e.axis]=l,t._custom={barStart:a,barEnd:l,start:n,end:r,min:o,max:h}}function sh(s,t,e,i){return Y(s)?$d(s,t,e,i):t[e.axis]=e.parse(s,i),t}function Mr(s,t,e,i){const n=s.iScale,r=s.vScale,o=n.getLabels(),h=n===r,a=[];let l,c,d,f;for(l=e,c=e+i;l<c;++l)f=t[l],d={},d[n.axis]=h||n.parse(o[l],l),a.push(sh(f,d,r,l));return a}function us(s){return s&&s.barStart!==void 0&&s.barEnd!==void 0}function Hd(s,t,e){return s!==0?zt(s):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function qd(s){let t,e,i,n,r;return s.horizontal?(t=s.base>s.x,e="left",i="right"):(t=s.base<s.y,e="bottom",i="top"),t?(n="end",r="start"):(n="start",r="end"),{start:e,end:i,reverse:t,top:n,bottom:r}}function Ud(s,t,e,i){let n=t.borderSkipped;const r={};if(!n){s.borderSkipped=r;return}if(n===!0){s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:h,reverse:a,top:l,bottom:c}=qd(s);n==="middle"&&e&&(s.enableBorderRadius=!0,(e._top||0)===i?n=l:(e._bottom||0)===i?n=c:(r[Pr(c,o,h,a)]=!0,n=l)),r[Pr(n,o,h,a)]=!0,s.borderSkipped=r}function Pr(s,t,e,i){return i?(s=Xd(s,t,e),s=Cr(s,e,t)):s=Cr(s,t,e),s}function Xd(s,t,e){return s===t?e:s===e?t:s}function Cr(s,t,e){return s==="start"?t:s==="end"?e:s}function Qd(s,{inflateAmount:t},e){s.inflateAmount=t==="auto"?e===1?.33:0:t}class ui extends Te{parsePrimitiveData(t,e,i,n){return Mr(t,e,i,n)}parseArrayData(t,e,i,n){return Mr(t,e,i,n)}parseObjectData(t,e,i,n){const{iScale:r,vScale:o}=t,{xAxisKey:h="x",yAxisKey:a="y"}=this._parsing,l=r.axis==="x"?h:a,c=o.axis==="x"?h:a,d=[];let f,g,p,m;for(f=i,g=i+n;f<g;++f)m=e[f],p={},p[r.axis]=r.parse(he(m,l),f),d.push(sh(he(m,c),p,o,f));return d}updateRangeFromParsed(t,e,i,n){super.updateRangeFromParsed(t,e,i,n);const r=i._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:n}=e,r=this.getParsed(t),o=r._custom,h=us(o)?"["+o.start+", "+o.end+"]":""+n.getLabelForValue(r[n.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:h}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,n){const r=n==="reset",{index:o,_cachedMeta:{vScale:h}}=this,a=h.getBasePixel(),l=h.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:f}=this._getSharedOptions(e,n);for(let g=e;g<e+i;g++){const p=this.getParsed(g),m=r||A(p[h.axis])?{base:a,head:a}:this._calculateBarValuePixels(g),x=this._calculateBarIndexPixels(g,c),b=(p._stacks||{})[h.axis],v={horizontal:l,base:m.base,enableBorderRadius:!b||us(p._custom)||o===b._top||o===b._bottom,x:l?m.head:x.center,y:l?x.center:m.head,height:l?x.size:Math.abs(m.size),width:l?Math.abs(m.size):x.size};f&&(v.options=d||this.resolveDataElementOptions(g,t[g].active?"active":n));const y=v.options||t[g].options;Ud(v,y,b,o),Qd(v,y,c.ratio),this.updateElement(t[g],g,v,n)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,n=i.getMatchingVisibleMetas(this._type).filter(c=>c.controller.options.grouped),r=i.options.stacked,o=[],h=this._cachedMeta.controller.getParsed(e),a=h&&h[i.axis],l=c=>{const d=c._parsed.find(g=>g[i.axis]===a),f=d&&d[c.vScale.axis];if(A(f)||isNaN(f))return!0};for(const c of n)if(!(e!==void 0&&l(c))&&((r===!1||o.indexOf(c.stack)===-1||r===void 0&&c.stack===void 0)&&o.push(c.stack),c.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(i=>t[i].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)t[L(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,i){const n=this._getStacks(t,i),r=e!==void 0?n.indexOf(e):-1;return r===-1?n.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,n=[];let r,o;for(r=0,o=e.data.length;r<o;++r)n.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const h=t.barThickness;return{min:h||Wd(e),pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:h?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:n},options:{base:r,minBarLength:o}}=this,h=r||0,a=this.getParsed(t),l=a._custom,c=us(l);let d=a[e.axis],f=0,g=i?this.applyStack(e,a,i):d,p,m;g!==d&&(f=g-d,g=d),c&&(d=l.barStart,g=l.barEnd-l.barStart,d!==0&&zt(d)!==zt(l.barEnd)&&(f=0),f+=d);const x=!A(r)&&!c?r:f;let b=e.getPixelForValue(x);if(this.chart.getDataVisibility(t)?p=e.getPixelForValue(f+g):p=b,m=p-b,Math.abs(m)<o){m=Hd(m,e,h)*o,d===h&&(b-=m/2);const v=e.getPixelForDecimal(0),y=e.getPixelForDecimal(1),w=Math.min(v,y),S=Math.max(v,y);b=Math.max(Math.min(b,S),w),p=b+m,i&&!c&&(a._stacks[e.axis]._visualValues[n]=e.getValueForPixel(p)-e.getValueForPixel(b))}if(b===e.getPixelForValue(h)){const v=zt(m)*e.getLineWidthForValue(h)/2;b+=v,m-=v}return{size:m,base:b,head:p,center:p+m/2}}_calculateBarIndexPixels(t,e){const i=e.scale,n=this.options,r=n.skipNull,o=L(n.maxBarThickness,1/0);let h,a;const l=this._getAxisCount();if(e.grouped){const c=r?this._getStackCount(t):e.stackCount,d=n.barThickness==="flex"?Yd(t,e,n,c*l):Vd(t,e,n,c*l),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,g=this._getAxis().indexOf(L(f,this.getFirstScaleIdForIndexAxis())),p=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0)+g;h=d.start+d.chunk*p+d.chunk/2,a=Math.min(o,d.chunk*d.ratio)}else h=i.getPixelForValue(this.getParsed(t)[i.axis],t),a=Math.min(o,e.min*e.ratio);return{base:h-a/2,head:h+a/2,center:h,size:a}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,n=i.length;let r=0;for(;r<n;++r)this.getParsed(r)[e.axis]!==null&&!i[r].hidden&&i[r].draw(this._ctx)}}T(ui,"id","bar"),T(ui,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),T(ui,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function Bt(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class en{constructor(t){T(this,"options");this.options=t||{}}static override(t){Object.assign(en.prototype,t)}init(){}formats(){return Bt()}parse(){return Bt()}format(){return Bt()}add(){return Bt()}diff(){return Bt()}startOf(){return Bt()}endOf(){return Bt()}}var Kd={_date:en};function Gd(s,t,e,i){const{controller:n,data:r,_sorted:o}=s,h=n._cachedMeta.iScale,a=s.dataset&&s.dataset.options?s.dataset.options.spanGaps:null;if(h&&t===h.axis&&t!=="r"&&o&&r.length){const l=h._reversePixels?Ac:js;if(i){if(n._sharedOptions){const c=r[0],d=typeof c.getRange=="function"&&c.getRange(t);if(d){const f=l(r,t,e-d),g=l(r,t,e+d);return{lo:f.lo,hi:g.hi}}}}else{const c=l(r,t,e);if(a){const{vScale:d}=n._cachedMeta,{_parsed:f}=s,g=f.slice(0,c.lo+1).reverse().findIndex(m=>!A(m[d.axis]));c.lo-=Math.max(0,g);const p=f.slice(c.hi).findIndex(m=>!A(m[d.axis]));c.hi+=Math.max(0,p)}return c}}return{lo:0,hi:r.length-1}}function Bi(s,t,e,i,n){const r=s.getSortedVisibleDatasetMetas(),o=e[t];for(let h=0,a=r.length;h<a;++h){const{index:l,data:c}=r[h],{lo:d,hi:f}=Gd(r[h],t,o,n);for(let g=d;g<=f;++g){const p=c[g];p.skip||i(p,l,g)}}}function Zd(s){const t=s.indexOf("x")!==-1,e=s.indexOf("y")!==-1;return function(i,n){const r=t?Math.abs(i.x-n.x):0,o=e?Math.abs(i.y-n.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function fs(s,t,e,i,n){const r=[];return!n&&!s.isPointInArea(t)||Bi(s,e,t,function(h,a,l){!n&&!qo(h,s.chartArea,0)||h.inRange(t.x,t.y,i)&&r.push({element:h,datasetIndex:a,index:l})},!0),r}function Jd(s,t,e,i){let n=[];function r(o,h,a){const{startAngle:l,endAngle:c}=o.getProps(["startAngle","endAngle"],i),{angle:d}=Ec(o,{x:t.x,y:t.y});Fc(d,l,c)&&n.push({element:o,datasetIndex:h,index:a})}return Bi(s,e,t,r),n}function tu(s,t,e,i,n,r){let o=[];const h=Zd(e);let a=Number.POSITIVE_INFINITY;function l(c,d,f){const g=c.inRange(t.x,t.y,n);if(i&&!g)return;const p=c.getCenterPoint(n);if(!(!!r||s.isPointInArea(p))&&!g)return;const x=h(t,p);x<a?(o=[{element:c,datasetIndex:d,index:f}],a=x):x===a&&o.push({element:c,datasetIndex:d,index:f})}return Bi(s,e,t,l),o}function gs(s,t,e,i,n,r){return!r&&!s.isPointInArea(t)?[]:e==="r"&&!i?Jd(s,t,e,n):tu(s,t,e,i,n,r)}function jr(s,t,e,i,n){const r=[],o=e==="x"?"inXRange":"inYRange";let h=!1;return Bi(s,e,t,(a,l,c)=>{a[o]&&a[o](t[e],n)&&(r.push({element:a,datasetIndex:l,index:c}),h=h||a.inRange(t.x,t.y,n))}),i&&!h?[]:r}var eu={modes:{index(s,t,e,i){const n=It(t,s),r=e.axis||"x",o=e.includeInvisible||!1,h=e.intersect?fs(s,n,r,i,o):gs(s,n,r,!1,i,o),a=[];return h.length?(s.getSortedVisibleDatasetMetas().forEach(l=>{const c=h[0].index,d=l.data[c];d&&!d.skip&&a.push({element:d,datasetIndex:l.index,index:c})}),a):[]},dataset(s,t,e,i){const n=It(t,s),r=e.axis||"xy",o=e.includeInvisible||!1;let h=e.intersect?fs(s,n,r,i,o):gs(s,n,r,!1,i,o);if(h.length>0){const a=h[0].datasetIndex,l=s.getDatasetMeta(a).data;h=[];for(let c=0;c<l.length;++c)h.push({element:l[c],datasetIndex:a,index:c})}return h},point(s,t,e,i){const n=It(t,s),r=e.axis||"xy",o=e.includeInvisible||!1;return fs(s,n,r,i,o)},nearest(s,t,e,i){const n=It(t,s),r=e.axis||"xy",o=e.includeInvisible||!1;return gs(s,n,r,e.intersect,i,o)},x(s,t,e,i){const n=It(t,s);return jr(s,n,"x",e.intersect,i)},y(s,t,e,i){const n=It(t,s);return jr(s,n,"y",e.intersect,i)}}};const nh=["left","top","right","bottom"];function xe(s,t){return s.filter(e=>e.pos===t)}function Rr(s,t){return s.filter(e=>nh.indexOf(e.pos)===-1&&e.box.axis===t)}function be(s,t){return s.sort((e,i)=>{const n=t?i:e,r=t?e:i;return n.weight===r.weight?n.index-r.index:n.weight-r.weight})}function iu(s){const t=[];let e,i,n,r,o,h;for(e=0,i=(s||[]).length;e<i;++e)n=s[e],{position:r,options:{stack:o,stackWeight:h=1}}=n,t.push({index:e,box:n,pos:r,horizontal:n.isHorizontal(),weight:n.weight,stack:o&&r+o,stackWeight:h});return t}function su(s){const t={};for(const e of s){const{stack:i,pos:n,stackWeight:r}=e;if(!i||!nh.includes(n))continue;const o=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function nu(s,t){const e=su(s),{vBoxMaxWidth:i,hBoxMaxHeight:n}=t;let r,o,h;for(r=0,o=s.length;r<o;++r){h=s[r];const{fullSize:a}=h.box,l=e[h.stack],c=l&&h.stackWeight/l.weight;h.horizontal?(h.width=c?c*i:a&&t.availableWidth,h.height=n):(h.width=i,h.height=c?c*n:a&&t.availableHeight)}return e}function ru(s){const t=iu(s),e=be(t.filter(l=>l.box.fullSize),!0),i=be(xe(t,"left"),!0),n=be(xe(t,"right")),r=be(xe(t,"top"),!0),o=be(xe(t,"bottom")),h=Rr(t,"x"),a=Rr(t,"y");return{fullSize:e,leftAndTop:i.concat(r),rightAndBottom:n.concat(a).concat(o).concat(h),chartArea:xe(t,"chartArea"),vertical:i.concat(n).concat(a),horizontal:r.concat(o).concat(h)}}function zr(s,t,e,i){return Math.max(s[e],t[e])+Math.max(s[i],t[i])}function rh(s,t){s.top=Math.max(s.top,t.top),s.left=Math.max(s.left,t.left),s.bottom=Math.max(s.bottom,t.bottom),s.right=Math.max(s.right,t.right)}function ou(s,t,e,i){const{pos:n,box:r}=e,o=s.maxPadding;if(!E(n)){e.size&&(s[n]-=e.size);const d=i[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,s[n]+=e.size}r.getPadding&&rh(o,r.getPadding());const h=Math.max(0,t.outerWidth-zr(o,s,"left","right")),a=Math.max(0,t.outerHeight-zr(o,s,"top","bottom")),l=h!==s.w,c=a!==s.h;return s.w=h,s.h=a,e.horizontal?{same:l,other:c}:{same:c,other:l}}function hu(s){const t=s.maxPadding;function e(i){const n=Math.max(t[i]-s[i],0);return s[i]+=n,n}s.y+=e("top"),s.x+=e("left"),e("right"),e("bottom")}function au(s,t){const e=t.maxPadding;function i(n){const r={left:0,top:0,right:0,bottom:0};return n.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return i(s?["left","right"]:["top","bottom"])}function Se(s,t,e,i){const n=[];let r,o,h,a,l,c;for(r=0,o=s.length,l=0;r<o;++r){h=s[r],a=h.box,a.update(h.width||t.w,h.height||t.h,au(h.horizontal,t));const{same:d,other:f}=ou(t,e,h,i);l|=d&&n.length,c=c||f,a.fullSize||n.push(h)}return l&&Se(n,t,e,i)||c}function ni(s,t,e,i,n){s.top=e,s.left=t,s.right=t+i,s.bottom=e+n,s.width=i,s.height=n}function Dr(s,t,e,i){const n=e.padding;let{x:r,y:o}=t;for(const h of s){const a=h.box,l=i[h.stack]||{placed:0,weight:1},c=h.stackWeight/l.weight||1;if(h.horizontal){const d=t.w*c,f=l.size||a.height;Oe(l.start)&&(o=l.start),a.fullSize?ni(a,n.left,o,e.outerWidth-n.right-n.left,f):ni(a,t.left+l.placed,o,d,f),l.start=o,l.placed+=d,o=a.bottom}else{const d=t.h*c,f=l.size||a.width;Oe(l.start)&&(r=l.start),a.fullSize?ni(a,r,n.top,f,e.outerHeight-n.bottom-n.top):ni(a,r,t.top+l.placed,f,d),l.start=r,l.placed+=d,r=a.right}}t.x=r,t.y=o}var nt={addBox(s,t){s.boxes||(s.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},s.boxes.push(t)},removeBox(s,t){const e=s.boxes?s.boxes.indexOf(t):-1;e!==-1&&s.boxes.splice(e,1)},configure(s,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(s,t,e,i){if(!s)return;const n=ot(s.options.layout.padding),r=Math.max(t-n.width,0),o=Math.max(e-n.height,0),h=ru(s.boxes),a=h.vertical,l=h.horizontal;F(s.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const c=a.reduce((m,x)=>x.box.options&&x.box.options.display===!1?m:m+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:n,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/c,hBoxMaxHeight:o/2}),f=Object.assign({},n);rh(f,ot(i));const g=Object.assign({maxPadding:f,w:r,h:o,x:n.left,y:n.top},n),p=nu(a.concat(l),d);Se(h.fullSize,g,d,p),Se(a,g,d,p),Se(l,g,d,p)&&Se(a,g,d,p),hu(g),Dr(h.leftAndTop,g,d,p),g.x+=g.w,g.y+=g.h,Dr(h.rightAndBottom,g,d,p),s.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},F(h.chartArea,m=>{const x=m.box;Object.assign(x,s.chartArea),x.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class oh{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,n){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,n?Math.floor(e/n):i)}}isAttached(t){return!0}updateConfig(t){}}class lu extends oh{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const fi="$chartjs",cu={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Tr=s=>s===null||s==="";function du(s,t){const e=s.style,i=s.getAttribute("height"),n=s.getAttribute("width");if(s[fi]={initial:{height:i,width:n,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Tr(n)){const r=br(s,"width");r!==void 0&&(s.width=r)}if(Tr(i))if(s.style.height==="")s.height=s.width/(t||2);else{const r=br(s,"height");r!==void 0&&(s.height=r)}return s}const hh=_d?{passive:!0}:!1;function uu(s,t,e){s&&s.addEventListener(t,e,hh)}function fu(s,t,e){s&&s.canvas&&s.canvas.removeEventListener(t,e,hh)}function gu(s,t){const e=cu[s.type]||s.type,{x:i,y:n}=It(s,t);return{type:e,chart:t,native:s,x:i!==void 0?i:null,y:n!==void 0?n:null}}function ji(s,t){for(const e of s)if(e===t||e.contains(t))return!0}function pu(s,t,e){const i=s.canvas,n=new MutationObserver(r=>{let o=!1;for(const h of r)o=o||ji(h.addedNodes,i),o=o&&!ji(h.removedNodes,i);o&&e()});return n.observe(document,{childList:!0,subtree:!0}),n}function mu(s,t,e){const i=s.canvas,n=new MutationObserver(r=>{let o=!1;for(const h of r)o=o||ji(h.removedNodes,i),o=o&&!ji(h.addedNodes,i);o&&e()});return n.observe(document,{childList:!0,subtree:!0}),n}const Ne=new Map;let Er=0;function ah(){const s=window.devicePixelRatio;s!==Er&&(Er=s,Ne.forEach((t,e)=>{e.currentDevicePixelRatio!==s&&t()}))}function xu(s,t){Ne.size||window.addEventListener("resize",ah),Ne.set(s,t)}function bu(s){Ne.delete(s),Ne.size||window.removeEventListener("resize",ah)}function vu(s,t,e){const i=s.canvas,n=i&&tn(i);if(!n)return;const r=Wo((h,a)=>{const l=n.clientWidth;e(h,a),l<n.clientWidth&&e()},window),o=new ResizeObserver(h=>{const a=h[0],l=a.contentRect.width,c=a.contentRect.height;l===0&&c===0||r(l,c)});return o.observe(n),xu(s,r),o}function ps(s,t,e){e&&e.disconnect(),t==="resize"&&bu(s)}function yu(s,t,e){const i=s.canvas,n=Wo(r=>{s.ctx!==null&&e(gu(r,s))},s);return uu(i,t,n),n}class _u extends oh{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(du(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[fi])return!1;const i=e[fi].initial;["height","width"].forEach(r=>{const o=i[r];A(o)?e.removeAttribute(r):e.setAttribute(r,o)});const n=i.style||{};return Object.keys(n).forEach(r=>{e.style[r]=n[r]}),e.width=e.width,delete e[fi],!0}addEventListener(t,e,i){this.removeEventListener(t,e);const n=t.$proxies||(t.$proxies={}),o={attach:pu,detach:mu,resize:vu}[e]||yu;n[e]=o(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),n=i[e];if(!n)return;({attach:ps,detach:ps,resize:ps}[e]||fu)(t,e,n),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,n){return yd(t,e,i,n)}isAttached(t){const e=t&&tn(t);return!!(e&&e.isConnected)}}function wu(s){return!Js()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?lu:_u}class Tt{constructor(){T(this,"x");T(this,"y");T(this,"active",!1);T(this,"options");T(this,"$animations")}tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return Mi(this.x)&&Mi(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const n={};return t.forEach(r=>{n[r]=i[r]&&i[r].active()?i[r]._to:this[r]}),n}}T(Tt,"defaults",{}),T(Tt,"defaultRoutes");function Su(s,t){const e=s.options.ticks,i=ku(s),n=Math.min(e.maxTicksLimit||i,i),r=e.major.enabled?Pu(t):[],o=r.length,h=r[0],a=r[o-1],l=[];if(o>n)return Cu(t,l,r,o/n),l;const c=Mu(r,t,n);if(o>0){let d,f;const g=o>1?Math.round((a-h)/(o-1)):null;for(ri(t,l,c,A(g)?0:h-g,h),d=0,f=o-1;d<f;d++)ri(t,l,c,r[d],r[d+1]);return ri(t,l,c,a,A(g)?t.length:a+g),l}return ri(t,l,c),l}function ku(s){const t=s.options.offset,e=s._tickSize(),i=s._length/e+(t?0:1),n=s._maxLength/e;return Math.floor(Math.min(i,n))}function Mu(s,t,e){const i=ju(s),n=t.length/e;if(!i)return Math.max(n,1);const r=jc(i);for(let o=0,h=r.length-1;o<h;o++){const a=r[o];if(a>n)return a}return Math.max(n,1)}function Pu(s){const t=[];let e,i;for(e=0,i=s.length;e<i;e++)s[e].major&&t.push(e);return t}function Cu(s,t,e,i){let n=0,r=e[0],o;for(i=Math.ceil(i),o=0;o<s.length;o++)o===r&&(t.push(s[o]),n++,r=e[n*i])}function ri(s,t,e,i,n){const r=L(i,0),o=Math.min(L(n,s.length),s.length);let h=0,a,l,c;for(e=Math.ceil(e),n&&(a=n-i,e=a/Math.floor(a/e)),c=r;c<0;)h++,c=Math.round(r+h*e);for(l=Math.max(r,0);l<o;l++)l===c&&(t.push(s[l]),h++,c=Math.round(r+h*e))}function ju(s){const t=s.length;let e,i;if(t<2)return!1;for(i=s[0],e=1;e<t;++e)if(s[e]-s[e-1]!==i)return!1;return i}const Ru=s=>s==="left"?"right":s==="right"?"left":s,Lr=(s,t,e)=>t==="top"||t==="left"?s[t]+e:s[t]-e,Fr=(s,t)=>Math.min(t||s,s);function Or(s,t){const e=[],i=s.length/t,n=s.length;let r=0;for(;r<n;r+=i)e.push(s[Math.floor(r)]);return e}function zu(s,t,e){const i=s.ticks.length,n=Math.min(t,i-1),r=s._startPixel,o=s._endPixel,h=1e-6;let a=s.getPixelForTick(n),l;if(!(e&&(i===1?l=Math.max(a-r,o-a):t===0?l=(s.getPixelForTick(1)-a)/2:l=(a-s.getPixelForTick(n-1))/2,a+=n<t?l:-l,a<r-h||a>o+h)))return a}function Du(s,t){F(s,e=>{const i=e.gc,n=i.length/2;let r;if(n>t){for(r=0;r<n;++r)delete e.data[i[r]];i.splice(0,n)}})}function ve(s){return s.drawTicks?s.tickLength:0}function Ar(s,t){if(!s.display)return 0;const e=Q(s.font,t),i=ot(s.padding);return(Y(s.text)?s.text.length:1)*e.lineHeight+i.height}function Tu(s,t){return ce(s,{scale:t,type:"scale"})}function Eu(s,t,e){return ce(s,{tick:e,index:t,type:"tick"})}function Lu(s,t,e){let i=Us(s);return(e&&t!=="right"||!e&&t==="right")&&(i=Ru(i)),i}function Fu(s,t,e,i){const{top:n,left:r,bottom:o,right:h,chart:a}=s,{chartArea:l,scales:c}=a;let d=0,f,g,p;const m=o-n,x=h-r;if(s.isHorizontal()){if(g=X(i,r,h),E(e)){const b=Object.keys(e)[0],v=e[b];p=c[b].getPixelForValue(v)+m-t}else e==="center"?p=(l.bottom+l.top)/2+m-t:p=Lr(s,e,t);f=h-r}else{if(E(e)){const b=Object.keys(e)[0],v=e[b];g=c[b].getPixelForValue(v)-x+t}else e==="center"?g=(l.left+l.right)/2-x+t:g=Lr(s,e,t);p=X(i,o,n),d=e==="left"?-at:at}return{titleX:g,titleY:p,maxWidth:f,rotation:d}}class de extends Tt{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:n}=this;return t=ut(t,Number.POSITIVE_INFINITY),e=ut(e,Number.NEGATIVE_INFINITY),i=ut(i,Number.POSITIVE_INFINITY),n=ut(n,Number.NEGATIVE_INFINITY),{min:ut(t,i),max:ut(e,n),minDefined:rt(t),maxDefined:rt(e)}}getMinMax(t){let{min:e,max:i,minDefined:n,maxDefined:r}=this.getUserBounds(),o;if(n&&r)return{min:e,max:i};const h=this.getMatchingVisibleMetas();for(let a=0,l=h.length;a<l;++a)o=h[a].controller.getMinMax(this,t),n||(e=Math.min(e,o.min)),r||(i=Math.max(i,o.max));return e=r&&e>i?i:e,i=n&&e>i?e:i,{min:ut(e,ut(i,e)),max:ut(i,ut(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){B(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:n,grace:r,ticks:o}=this.options,h=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=rd(this,r,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=h<this.ticks.length;this._convertTicksToLabels(a?Or(this.ticks,h):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Su(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,i;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,t=!t),this._startPixel=e,this._endPixel=i,this._reversePixels=t,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){B(this.options.afterUpdate,[this])}beforeSetDimensions(){B(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){B(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),B(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){B(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,n,r;for(i=0,n=t.length;i<n;i++)r=t[i],r.label=B(e.callback,[r.value,i,t],this)}afterTickToLabelConversion(){B(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){B(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=Fr(this.ticks.length,t.ticks.maxTicksLimit),n=e.minRotation||0,r=e.maxRotation;let o=n,h,a,l;if(!this._isVisible()||!e.display||n>=r||i<=1||!this.isHorizontal()){this.labelRotation=n;return}const c=this._getLabelSizes(),d=c.widest.width,f=c.highest.height,g=lt(this.chart.width-d,0,this.maxWidth);h=t.offset?this.maxWidth/i:g/(i-1),d+6>h&&(h=g/(i-(t.offset?.5:1)),a=this.maxHeight-ve(t.grid)-e.padding-Ar(t.title,this.chart.options.font),l=Math.sqrt(d*d+f*f),o=Tc(Math.min(Math.asin(lt((c.highest.height+6)/h,-1,1)),Math.asin(lt(a/l,-1,1))-Math.asin(lt(f/l,-1,1)))),o=Math.max(n,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){B(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){B(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:n,grid:r}}=this,o=this._isVisible(),h=this.isHorizontal();if(o){const a=Ar(n,e.options.font);if(h?(t.width=this.maxWidth,t.height=ve(r)+a):(t.height=this.maxHeight,t.width=ve(r)+a),i.display&&this.ticks.length){const{first:l,last:c,widest:d,highest:f}=this._getLabelSizes(),g=i.padding*2,p=Vt(this.labelRotation),m=Math.cos(p),x=Math.sin(p);if(h){const b=i.mirror?0:x*d.width+m*f.height;t.height=Math.min(this.maxHeight,t.height+b+g)}else{const b=i.mirror?0:m*d.width+x*f.height;t.width=Math.min(this.maxWidth,t.width+b+g)}this._calculatePadding(l,c,x,m)}}this._handleMargins(),h?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,n){const{ticks:{align:r,padding:o},position:h}=this.options,a=this.labelRotation!==0,l=h!=="top"&&this.axis==="x";if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,g=0;a?l?(f=n*t.width,g=i*e.height):(f=i*t.height,g=n*e.width):r==="start"?g=e.width:r==="end"?f=t.width:r!=="inner"&&(f=t.width/2,g=e.width/2),this.paddingLeft=Math.max((f-c+o)*this.width/(this.width-c),0),this.paddingRight=Math.max((g-d+o)*this.width/(this.width-d),0)}else{let c=e.height/2,d=t.height/2;r==="start"?(c=0,d=t.height):r==="end"&&(c=e.height,d=0),this.paddingTop=c+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){B(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,i;for(e=0,i=t.length;e<i;e++)A(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=Or(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:n,_longestTextCache:r}=this,o=[],h=[],a=Math.floor(e/Fr(e,i));let l=0,c=0,d,f,g,p,m,x,b,v,y,w,S;for(d=0;d<e;d+=a){if(p=t[d].label,m=this._resolveTickFontOptions(d),n.font=x=m.string,b=r[x]=r[x]||{data:{},gc:[]},v=m.lineHeight,y=w=0,!A(p)&&!Y(p))y=ur(n,b.data,b.gc,y,p),w=v;else if(Y(p))for(f=0,g=p.length;f<g;++f)S=p[f],!A(S)&&!Y(S)&&(y=ur(n,b.data,b.gc,y,S),w+=v);o.push(y),h.push(w),l=Math.max(y,l),c=Math.max(w,c)}Du(r,e);const P=o.indexOf(l),M=h.indexOf(c),k=C=>({width:o[C]||0,height:h[C]||0});return{first:k(0),last:k(e-1),widest:k(P),highest:k(M),widths:o,heights:h}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Oc(this._alignToPixels?Nt(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=Eu(this.getContext(),t,i))}return this.$context||(this.$context=Tu(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=Vt(this.labelRotation),i=Math.abs(Math.cos(e)),n=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,h=r?r.widest.width+o:0,a=r?r.highest.height+o:0;return this.isHorizontal()?a*i>h*n?h/i:a/n:a*n<h*i?a/i:h/n}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,n=this.options,{grid:r,position:o,border:h}=n,a=r.offset,l=this.isHorizontal(),d=this.ticks.length+(a?1:0),f=ve(r),g=[],p=h.setContext(this.getContext()),m=p.display?p.width:0,x=m/2,b=function(V){return Nt(i,V,m)};let v,y,w,S,P,M,k,C,z,j,D,$;if(o==="top")v=b(this.bottom),M=this.bottom-f,C=v-x,j=b(t.top)+x,$=t.bottom;else if(o==="bottom")v=b(this.top),j=t.top,$=b(t.bottom)-x,M=v+x,C=this.top+f;else if(o==="left")v=b(this.right),P=this.right-f,k=v-x,z=b(t.left)+x,D=t.right;else if(o==="right")v=b(this.left),z=t.left,D=b(t.right)-x,P=v+x,k=this.left+f;else if(e==="x"){if(o==="center")v=b((t.top+t.bottom)/2+.5);else if(E(o)){const V=Object.keys(o)[0],H=o[V];v=b(this.chart.scales[V].getPixelForValue(H))}j=t.top,$=t.bottom,M=v+x,C=M+f}else if(e==="y"){if(o==="center")v=b((t.left+t.right)/2);else if(E(o)){const V=Object.keys(o)[0],H=o[V];v=b(this.chart.scales[V].getPixelForValue(H))}P=v-x,k=P-f,z=t.left,D=t.right}const et=L(n.ticks.maxTicksLimit,d),N=Math.max(1,Math.ceil(d/et));for(y=0;y<d;y+=N){const V=this.getContext(y),H=r.setContext(V),_t=h.setContext(V),wt=H.lineWidth,ct=H.color,We=_t.dash||[],Qt=_t.dashOffset,ue=H.tickWidth,Et=H.tickColor,fe=H.tickBorderDash||[],Lt=H.tickBorderDashOffset;w=zu(this,y,a),w!==void 0&&(S=Nt(i,w,wt),l?P=k=z=D=S:M=C=j=$=S,g.push({tx1:P,ty1:M,tx2:k,ty2:C,x1:z,y1:j,x2:D,y2:$,width:wt,color:ct,borderDash:We,borderDashOffset:Qt,tickWidth:ue,tickColor:Et,tickBorderDash:fe,tickBorderDashOffset:Lt}))}return this._ticksLength=d,this._borderValue=v,g}_computeLabelItems(t){const e=this.axis,i=this.options,{position:n,ticks:r}=i,o=this.isHorizontal(),h=this.ticks,{align:a,crossAlign:l,padding:c,mirror:d}=r,f=ve(i.grid),g=f+c,p=d?-c:g,m=-Vt(this.labelRotation),x=[];let b,v,y,w,S,P,M,k,C,z,j,D,$="middle";if(n==="top")P=this.bottom-p,M=this._getXAxisLabelAlignment();else if(n==="bottom")P=this.top+p,M=this._getXAxisLabelAlignment();else if(n==="left"){const N=this._getYAxisLabelAlignment(f);M=N.textAlign,S=N.x}else if(n==="right"){const N=this._getYAxisLabelAlignment(f);M=N.textAlign,S=N.x}else if(e==="x"){if(n==="center")P=(t.top+t.bottom)/2+g;else if(E(n)){const N=Object.keys(n)[0],V=n[N];P=this.chart.scales[N].getPixelForValue(V)+g}M=this._getXAxisLabelAlignment()}else if(e==="y"){if(n==="center")S=(t.left+t.right)/2-g;else if(E(n)){const N=Object.keys(n)[0],V=n[N];S=this.chart.scales[N].getPixelForValue(V)}M=this._getYAxisLabelAlignment(f).textAlign}e==="y"&&(a==="start"?$="top":a==="end"&&($="bottom"));const et=this._getLabelSizes();for(b=0,v=h.length;b<v;++b){y=h[b],w=y.label;const N=r.setContext(this.getContext(b));k=this.getPixelForTick(b)+r.labelOffset,C=this._resolveTickFontOptions(b),z=C.lineHeight,j=Y(w)?w.length:1;const V=j/2,H=N.color,_t=N.textStrokeColor,wt=N.textStrokeWidth;let ct=M;o?(S=k,M==="inner"&&(b===v-1?ct=this.options.reverse?"left":"right":b===0?ct=this.options.reverse?"right":"left":ct="center"),n==="top"?l==="near"||m!==0?D=-j*z+z/2:l==="center"?D=-et.highest.height/2-V*z+z:D=-et.highest.height+z/2:l==="near"||m!==0?D=z/2:l==="center"?D=et.highest.height/2-V*z:D=et.highest.height-j*z,d&&(D*=-1),m!==0&&!N.showLabelBackdrop&&(S+=z/2*Math.sin(m))):(P=k,D=(1-j)*z/2);let We;if(N.showLabelBackdrop){const Qt=ot(N.backdropPadding),ue=et.heights[b],Et=et.widths[b];let fe=D-Qt.top,Lt=0-Qt.left;switch($){case"middle":fe-=ue/2;break;case"bottom":fe-=ue;break}switch(M){case"center":Lt-=Et/2;break;case"right":Lt-=Et;break;case"inner":b===v-1?Lt-=Et:b>0&&(Lt-=Et/2);break}We={left:Lt,top:fe,width:Et+Qt.width,height:ue+Qt.height,color:N.backdropColor}}x.push({label:w,font:C,textOffset:D,options:{rotation:m,color:H,strokeColor:_t,strokeWidth:wt,textAlign:ct,textBaseline:$,translation:[S,P],backdrop:We}})}return x}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Vt(this.labelRotation))return t==="top"?"left":"right";let n="center";return e.align==="start"?n="left":e.align==="end"?n="right":e.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:n,padding:r}}=this.options,o=this._getLabelSizes(),h=t+r,a=o.widest.width;let l,c;return e==="left"?n?(c=this.right+r,i==="near"?l="left":i==="center"?(l="center",c+=a/2):(l="right",c+=a)):(c=this.right-h,i==="near"?l="right":i==="center"?(l="center",c-=a/2):(l="left",c=this.left)):e==="right"?n?(c=this.left+r,i==="near"?l="right":i==="center"?(l="center",c-=a/2):(l="left",c-=a)):(c=this.left+h,i==="near"?l="left":i==="center"?(l="center",c+=a/2):(l="right",c=this.right)):l="right",{textAlign:l,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:n,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,n,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex(r=>r.value===t);return n>=0?e.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const h=(a,l,c)=>{!c.width||!c.color||(i.save(),i.lineWidth=c.width,i.strokeStyle=c.color,i.setLineDash(c.borderDash||[]),i.lineDashOffset=c.borderDashOffset,i.beginPath(),i.moveTo(a.x,a.y),i.lineTo(l.x,l.y),i.stroke(),i.restore())};if(e.display)for(r=0,o=n.length;r<o;++r){const a=n[r];e.drawOnChartArea&&h({x:a.x1,y:a.y1},{x:a.x2,y:a.y2},a),e.drawTicks&&h({x:a.tx1,y:a.ty1},{x:a.tx2,y:a.ty2},{color:a.tickColor,width:a.tickWidth,borderDash:a.tickBorderDash,borderDashOffset:a.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:n}}=this,r=i.setContext(this.getContext()),o=i.display?r.width:0;if(!o)return;const h=n.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,d,f;this.isHorizontal()?(l=Nt(t,this.left,o)-o/2,c=Nt(t,this.right,h)+h/2,d=f=a):(d=Nt(t,this.top,o)-o/2,f=Nt(t,this.bottom,h)+h/2,l=c=a),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(l,d),e.lineTo(c,f),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,n=this._computeLabelArea();n&&Xs(i,n);const r=this.getLabelItems(t);for(const o of r){const h=o.options,a=o.font,l=o.label,c=o.textOffset;Ae(i,l,0,c,a,h)}n&&Qs(i)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:n}}=this;if(!i.display)return;const r=Q(i.font),o=ot(i.padding),h=i.align;let a=r.lineHeight/2;e==="bottom"||e==="center"||E(e)?(a+=o.bottom,Y(i.text)&&(a+=r.lineHeight*(i.text.length-1))):a+=o.top;const{titleX:l,titleY:c,maxWidth:d,rotation:f}=Fu(this,a,e,h);Ae(t,i.text,0,0,r,{color:i.color,maxWidth:d,rotation:f,textAlign:Lu(h,e,n),textBaseline:"middle",translation:[l,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=L(t.grid&&t.grid.z,-1),n=L(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==de.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",n=[];let r,o;for(r=0,o=e.length;r<o;++r){const h=e[r];h[i]===this.id&&(!t||h.type===t)&&n.push(h)}return n}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return Q(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class oi{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;Nu(e)&&(i=this.register(e));const n=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in n||(n[r]=t,Ou(t,o,i),this.override&&I.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,n=this.scope;i in e&&delete e[i],n&&i in I[n]&&(delete I[n][i],this.override&&delete Xt[i])}}function Ou(s,t,e){const i=Fe(Object.create(null),[e?I.get(e):{},I.get(t),s.defaults]);I.set(t,i),s.defaultRoutes&&Au(t,s.defaultRoutes),s.descriptors&&I.describe(t,s.descriptors)}function Au(s,t){Object.keys(t).forEach(e=>{const i=e.split("."),n=i.pop(),r=[s].concat(i).join("."),o=t[e].split("."),h=o.pop(),a=o.join(".");I.route(r,n,a,h)})}function Nu(s){return"id"in s&&"defaults"in s}class Bu{constructor(){this.controllers=new oi(Te,"datasets",!0),this.elements=new oi(Tt,"elements"),this.plugins=new oi(Object,"plugins"),this.scales=new oi(de,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(n=>{const r=i||this._getRegistryForType(n);i||r.isForType(n)||r===this.plugins&&n.id?this._exec(t,r,n):F(n,o=>{const h=i||this._getRegistryForType(o);this._exec(t,h,o)})})}_exec(t,e,i){const n=Hs(t);B(i["before"+n],[],i),e[t](i),B(i["after"+n],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const n=e.get(t);if(n===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return n}}var gt=new Bu;class Iu{constructor(){this._init=[]}notify(t,e,i,n){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=n?this._descriptors(t).filter(n):this._descriptors(t),o=this._notify(r,t,e,i);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,i,n){n=n||{};for(const r of t){const o=r.plugin,h=o[i],a=[e,n,r.options];if(B(h,a,o)===!1&&n.cancelable)return!1}return!0}invalidate(){A(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,n=L(i.options&&i.options.plugins,{}),r=Wu(i);return n===!1&&!e?[]:Yu(t,r,n,e)}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,n=(r,o)=>r.filter(h=>!o.some(a=>h.plugin.id===a.plugin.id));this._notify(n(e,i),t,"stop"),this._notify(n(i,e),t,"start")}}function Wu(s){const t={},e=[],i=Object.keys(gt.plugins.items);for(let r=0;r<i.length;r++)e.push(gt.getPlugin(i[r]));const n=s.plugins||[];for(let r=0;r<n.length;r++){const o=n[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function Vu(s,t){return!t&&s===!1?null:s===!0?{}:s}function Yu(s,{plugins:t,localIds:e},i,n){const r=[],o=s.getContext();for(const h of t){const a=h.id,l=Vu(i[a],n);l!==null&&r.push({plugin:h,options:$u(s.config,{plugin:h,local:e[a]},l,o)})}return r}function $u(s,{plugin:t,local:e},i,n){const r=s.pluginScopeKeys(t),o=s.getOptionScopes(i,r);return e&&t.defaults&&o.push(t.defaults),s.createResolver(o,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function zs(s,t){const e=I.datasets[s]||{};return((t.datasets||{})[s]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function Hu(s,t){let e=s;return s==="_index_"?e=t:s==="_value_"&&(e=t==="x"?"y":"x"),e}function qu(s,t){return s===t?"_index_":"_value_"}function Nr(s){if(s==="x"||s==="y"||s==="r")return s}function Uu(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function Ds(s,...t){if(Nr(s))return s;for(const e of t){const i=e.axis||Uu(e.position)||s.length>1&&Nr(s[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function Br(s,t,e){if(e[t+"AxisID"]===s)return{axis:t}}function Xu(s,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(i=>i.xAxisID===s||i.yAxisID===s);if(e.length)return Br(s,"x",e[0])||Br(s,"y",e[0])}return{}}function Qu(s,t){const e=Xt[s.type]||{scales:{}},i=t.scales||{},n=zs(s.type,t),r=Object.create(null);return Object.keys(i).forEach(o=>{const h=i[o];if(!E(h))return console.error(`Invalid scale configuration for scale: ${o}`);if(h._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const a=Ds(o,h,Xu(o,s),I.scales[h.type]),l=qu(a,n),c=e.scales||{};r[o]=Re(Object.create(null),[{axis:a},h,c[a],c[l]])}),s.data.datasets.forEach(o=>{const h=o.type||s.type,a=o.indexAxis||zs(h,t),c=(Xt[h]||{}).scales||{};Object.keys(c).forEach(d=>{const f=Hu(d,a),g=o[f+"AxisID"]||f;r[g]=r[g]||Object.create(null),Re(r[g],[{axis:f},i[g],c[d]])})}),Object.keys(r).forEach(o=>{const h=r[o];Re(h,[I.scales[h.type],I.scale])}),r}function lh(s){const t=s.options||(s.options={});t.plugins=L(t.plugins,{}),t.scales=Qu(s,t)}function ch(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function Ku(s){return s=s||{},s.data=ch(s.data),lh(s),s}const Ir=new Map,dh=new Set;function hi(s,t){let e=Ir.get(s);return e||(e=t(),Ir.set(s,e),dh.add(e)),e}const ye=(s,t,e)=>{const i=he(t,e);i!==void 0&&s.add(i)};class Gu{constructor(t){this._config=Ku(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=ch(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),lh(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return hi(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return hi(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return hi(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,i=this.type;return hi(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const i=this._scopeCache;let n=i.get(t);return(!n||e)&&(n=new Map,i.set(t,n)),n}getOptionScopes(t,e,i){const{options:n,type:r}=this,o=this._cachedScopes(t,i),h=o.get(e);if(h)return h;const a=new Set;e.forEach(c=>{t&&(a.add(t),c.forEach(d=>ye(a,t,d))),c.forEach(d=>ye(a,n,d)),c.forEach(d=>ye(a,Xt[r]||{},d)),c.forEach(d=>ye(a,I,d)),c.forEach(d=>ye(a,Rs,d))});const l=Array.from(a);return l.length===0&&l.push(Object.create(null)),dh.has(e)&&o.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,Xt[e]||{},I.datasets[e]||{},{type:e},I,Rs]}resolveNamedOptions(t,e,i,n=[""]){const r={$shared:!0},{resolver:o,subPrefixes:h}=Wr(this._resolverCache,t,n);let a=o;if(Ju(o,e)){r.$shared=!1,i=Dt(i)?i():i;const l=this.createResolver(t,i,h);a=ae(o,i,l)}for(const l of e)r[l]=a[l];return r}createResolver(t,e,i=[""],n){const{resolver:r}=Wr(this._resolverCache,t,i);return E(e)?ae(r,e,void 0,n):r}}function Wr(s,t,e){let i=s.get(t);i||(i=new Map,s.set(t,i));const n=e.join();let r=i.get(n);return r||(r={resolver:Ks(t,e),subPrefixes:e.filter(h=>!h.toLowerCase().includes("hover"))},i.set(n,r)),r}const Zu=s=>E(s)&&Object.getOwnPropertyNames(s).some(t=>Dt(s[t]));function Ju(s,t){const{isScriptable:e,isIndexable:i}=Qo(s);for(const n of t){const r=e(n),o=i(n),h=(o||r)&&s[n];if(r&&(Dt(h)||Zu(h))||o&&Y(h))return!0}return!1}var tf="4.5.0";const ef=["top","bottom","left","right","chartArea"];function Vr(s,t){return s==="top"||s==="bottom"||ef.indexOf(s)===-1&&t==="x"}function Yr(s,t){return function(e,i){return e[s]===i[s]?e[t]-i[t]:e[s]-i[s]}}function $r(s){const t=s.chart,e=t.options.animation;t.notifyPlugins("afterRender"),B(e&&e.onComplete,[s],t)}function sf(s){const t=s.chart,e=t.options.animation;B(e&&e.onProgress,[s],t)}function uh(s){return Js()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const gi={},Hr=s=>{const t=uh(s);return Object.values(gi).filter(e=>e.canvas===t).pop()};function nf(s,t,e){const i=Object.keys(s);for(const n of i){const r=+n;if(r>=t){const o=s[n];delete s[n],(e>0||r>t)&&(s[r+e]=o)}}}function rf(s,t,e,i){return!e||s.type==="mouseout"?null:i?t:s}var kt;let Ii=(kt=class{static register(...t){gt.add(...t),qr()}static unregister(...t){gt.remove(...t),qr()}constructor(t,e){const i=this.config=new Gu(e),n=uh(t),r=Hr(n);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||wu(n)),this.platform.updateConfig(i);const h=this.platform.acquireContext(n,o.aspectRatio),a=h&&h.canvas,l=a&&a.height,c=a&&a.width;if(this.id=yc(),this.ctx=h,this.canvas=a,this.width=c,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Iu,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Ic(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],gi[this.id]=this,!h||!a){console.error("Failed to create chart: can't acquire context from the given item");return}mt.listen(this,"complete",$r),mt.listen(this,"progress",sf),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:n,_aspectRatio:r}=this;return A(t)?e&&r?r:n?i/n:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return gt}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():xr(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return fr(this.canvas,this.ctx),this}stop(){return mt.stop(this),this}resize(t,e){mt.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,n=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(n,t,e,r),h=i.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,xr(this,h,!0)&&(this.notifyPlugins("resize",{size:o}),B(i.onResize,[this,o],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};F(e,(i,n)=>{i.id=n})}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,n=Object.keys(i).reduce((o,h)=>(o[h]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const h=e[o],a=Ds(o,h),l=a==="r",c=a==="x";return{options:h,dposition:l?"chartArea":c?"bottom":"left",dtype:l?"radialLinear":c?"category":"linear"}}))),F(r,o=>{const h=o.options,a=h.id,l=Ds(a,h),c=L(h.type,o.dtype);(h.position===void 0||Vr(h.position,l)!==Vr(o.dposition))&&(h.position=o.dposition),n[a]=!0;let d=null;if(a in i&&i[a].type===c)d=i[a];else{const f=gt.getScale(c);d=new f({id:a,type:c,ctx:this.ctx,chart:this}),i[d.id]=d}d.init(h,t)}),F(n,(o,h)=>{o||delete i[h]}),F(i,o=>{nt.configure(this,o,o.options),nt.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort((n,r)=>n.index-r.index),i>e){for(let n=e;n<i;++n)this._destroyDatasetMeta(n);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(Yr("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((i,n)=>{e.filter(r=>r===i._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,n;for(this._removeUnreferencedMetasets(),i=0,n=e.length;i<n;i++){const r=e[i];let o=this.getDatasetMeta(i);const h=r.type||this.config.type;if(o.type&&o.type!==h&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=h,o.indexAxis=r.indexAxis||zs(h,this.options),o.order=r.order||0,o.index=i,o.label=""+r.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const a=gt.getController(h),{datasetElementType:l,dataElementType:c}=I.datasets[h];Object.assign(a,{dataElementType:gt.getElement(c),datasetElementType:l&&gt.getElement(l)}),o.controller=new a(this,i),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){F(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:d}=this.getDatasetMeta(l),f=!n&&r.indexOf(d)===-1;d.buildOrUpdateElements(f),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),n||F(r,l=>{l.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Yr("z","_idx"));const{_active:h,_lastEvent:a}=this;a?this._eventHandler(a,!0):h.length&&this._updateHoverStyles(h,h,!0),this.render()}_updateScales(){F(this.scales,t=>{nt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!sr(e,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:n,count:r}of e){const o=i==="_removeElements"?-r:r;nf(t,n,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=r=>new Set(t.filter(o=>o[0]===r).map((o,h)=>h+","+o.splice(1).join(","))),n=i(0);for(let r=1;r<e;r++)if(!sr(n,i(r)))return;return Array.from(n).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;nt.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],F(this.boxes,n=>{i&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,r)=>{n._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,i=this.data.datasets.length;e<i;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,Dt(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),n={meta:i,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(i.controller._update(e),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(mt.has(this)?this.attached&&!mt.running(this)&&mt.start(this):(this.draw(),$r({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:n}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,n)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let n,r;for(n=0,r=e.length;n<r;++n){const o=e[n];(!t||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i={meta:t,index:t.index,cancelable:!0},n=Md(this,t);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(n&&Xs(e,n),t.controller.draw(),n&&Qs(e),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(t){return qo(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,n){const r=eu.modes[e];return typeof r=="function"?r(this,t,i,n):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let n=i.filter(r=>r&&r._dataset===e).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(n)),n}getContext(){return this.$context||(this.$context=ce(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!e.hidden}setDatasetVisibility(t,e){const i=this.getDatasetMeta(t);i.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const n=i?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,n);Oe(e)?(r.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(r,{visible:i}),this.update(h=>h.datasetIndex===t?n:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),mt.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),fr(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete gi[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},n=(r,o,h)=>{r.offsetX=o,r.offsetY=h,this._eventHandler(r)};F(this.options.events,r=>i(r,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(a,l)=>{e.addEventListener(this,a,l),t[a]=l},n=(a,l)=>{t[a]&&(e.removeEventListener(this,a,l),delete t[a])},r=(a,l)=>{this.canvas&&this.resize(a,l)};let o;const h=()=>{n("attach",h),this.attached=!0,this.resize(),i("resize",r),i("detach",o)};o=()=>{this.attached=!1,n("resize",r),this._stop(),this._resize(0,0),i("attach",h)},e.isAttached(this.canvas)?h():o()}unbindEvents(){F(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},F(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const n=i?"set":"remove";let r,o,h,a;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+n+"DatasetHoverStyle"]()),h=0,a=t.length;h<a;++h){o=t[h];const l=o&&this.getDatasetMeta(o.datasetIndex).controller;l&&l[n+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map(({datasetIndex:r,index:o})=>{const h=this.getDatasetMeta(r);if(!h)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:h.data[o],index:o}});!wi(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,i){const n=this.options.hover,r=(a,l)=>a.filter(c=>!l.some(d=>c.datasetIndex===d.datasetIndex&&c.index===d.index)),o=r(e,t),h=i?t:r(t,e);o.length&&this.updateHoverStyle(o,n.mode,!1),h.length&&n.mode&&this.updateHoverStyle(h,n.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,n)===!1)return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,n),(r||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:n=[],options:r}=this,o=e,h=this._getActiveElements(t,n,i,o),a=Pc(t),l=rf(t,this._lastEvent,i,a);i&&(this._lastEvent=null,B(r.onHover,[t,h,this],this),a&&B(r.onClick,[t,h,this],this));const c=!wi(h,n);return(c||e)&&(this._active=h,this._updateHoverStyles(h,n,e)),this._lastEvent=l,c}_getActiveElements(t,e,i,n){if(t.type==="mouseout")return[];if(!i)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,n)}},T(kt,"defaults",I),T(kt,"instances",gi),T(kt,"overrides",Xt),T(kt,"registry",gt),T(kt,"version",tf),T(kt,"getChart",Hr),kt);function qr(){return F(Ii.instances,s=>s._plugins.invalidate())}function fh(s,t){const{x:e,y:i,base:n,width:r,height:o}=s.getProps(["x","y","base","width","height"],t);let h,a,l,c,d;return s.horizontal?(d=o/2,h=Math.min(e,n),a=Math.max(e,n),l=i-d,c=i+d):(d=r/2,h=e-d,a=e+d,l=Math.min(i,n),c=Math.max(i,n)),{left:h,top:l,right:a,bottom:c}}function Ct(s,t,e,i){return s?0:lt(t,e,i)}function of(s,t,e){const i=s.options.borderWidth,n=s.borderSkipped,r=Xo(i);return{t:Ct(n.top,r.top,0,e),r:Ct(n.right,r.right,0,t),b:Ct(n.bottom,r.bottom,0,e),l:Ct(n.left,r.left,0,t)}}function hf(s,t,e){const{enableBorderRadius:i}=s.getProps(["enableBorderRadius"]),n=s.options.borderRadius,r=ee(n),o=Math.min(t,e),h=s.borderSkipped,a=i||E(n);return{topLeft:Ct(!a||h.top||h.left,r.topLeft,0,o),topRight:Ct(!a||h.top||h.right,r.topRight,0,o),bottomLeft:Ct(!a||h.bottom||h.left,r.bottomLeft,0,o),bottomRight:Ct(!a||h.bottom||h.right,r.bottomRight,0,o)}}function af(s){const t=fh(s),e=t.right-t.left,i=t.bottom-t.top,n=of(s,e/2,i/2),r=hf(s,e/2,i/2);return{outer:{x:t.left,y:t.top,w:e,h:i,radius:r},inner:{x:t.left+n.l,y:t.top+n.t,w:e-n.l-n.r,h:i-n.t-n.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,r.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(n.b,n.r))}}}}function ms(s,t,e,i){const n=t===null,r=e===null,h=s&&!(n&&r)&&fh(s,i);return h&&(n||Jt(t,h.left,h.right))&&(r||Jt(e,h.top,h.bottom))}function lf(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}function cf(s,t){s.rect(t.x,t.y,t.w,t.h)}function xs(s,t,e={}){const i=s.x!==e.x?-t:0,n=s.y!==e.y?-t:0,r=(s.x+s.w!==e.x+e.w?t:0)-i,o=(s.y+s.h!==e.y+e.h?t:0)-n;return{x:s.x+i,y:s.y+n,w:s.w+r,h:s.h+o,radius:s.radius}}class pi extends Tt{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:n}}=this,{inner:r,outer:o}=af(this),h=lf(o.radius)?Pi:cf;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),h(t,xs(o,e,r)),t.clip(),h(t,xs(r,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),h(t,xs(r,e)),t.fillStyle=n,t.fill(),t.restore()}inRange(t,e,i){return ms(this,t,e,i)}inXRange(t,e){return ms(this,t,null,e)}inYRange(t,e){return ms(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:n,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+n)/2:e,y:r?i:(i+n)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}T(pi,"id","bar"),T(pi,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),T(pi,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Ur=(s,t)=>{let{boxHeight:e=t,boxWidth:i=t}=s;return s.usePointStyle&&(e=Math.min(e,t),i=s.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(t,e)}},df=(s,t)=>s!==null&&t!==null&&s.datasetIndex===t.datasetIndex&&s.index===t.index;class Xr extends Tt{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=B(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(i=>t.filter(i,this.chart.data))),t.sort&&(e=e.sort((i,n)=>t.sort(i,n,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,n=Q(i.font),r=n.size,o=this._computeTitleHeight(),{boxWidth:h,itemHeight:a}=Ur(i,r);let l,c;e.font=n.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(o,r,h,a)+10):(c=this.maxHeight,l=this._fitCols(o,n,h,a)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,n){const{ctx:r,maxWidth:o,options:{labels:{padding:h}}}=this,a=this.legendHitBoxes=[],l=this.lineWidths=[0],c=n+h;let d=t;r.textAlign="left",r.textBaseline="middle";let f=-1,g=-c;return this.legendItems.forEach((p,m)=>{const x=i+e/2+r.measureText(p.text).width;(m===0||l[l.length-1]+x+2*h>o)&&(d+=c,l[l.length-(m>0?0:1)]=0,g+=c,f++),a[m]={left:0,top:g,row:f,width:x,height:n},l[l.length-1]+=x+h}),d}_fitCols(t,e,i,n){const{ctx:r,maxHeight:o,options:{labels:{padding:h}}}=this,a=this.legendHitBoxes=[],l=this.columnSizes=[],c=o-t;let d=h,f=0,g=0,p=0,m=0;return this.legendItems.forEach((x,b)=>{const{itemWidth:v,itemHeight:y}=uf(i,e,r,x,n);b>0&&g+y+2*h>c&&(d+=f+h,l.push({width:f,height:g}),p+=f+h,m++,f=g=0),a[b]={left:p,top:g,col:m,width:v,height:y},f=Math.max(f,v),g+=y+h}),d+=f,l.push({width:f,height:g}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:n},rtl:r}}=this,o=ie(r,this.left,this.width);if(this.isHorizontal()){let h=0,a=X(i,this.left+n,this.right-this.lineWidths[h]);for(const l of e)h!==l.row&&(h=l.row,a=X(i,this.left+n,this.right-this.lineWidths[h])),l.top+=this.top+t+n,l.left=o.leftForLtr(o.x(a),l.width),a+=l.width+n}else{let h=0,a=X(i,this.top+t+n,this.bottom-this.columnSizes[h].height);for(const l of e)l.col!==h&&(h=l.col,a=X(i,this.top+t+n,this.bottom-this.columnSizes[h].height)),l.top=a,l.left+=this.left+n,l.left=o.leftForLtr(o.x(l.left),l.width),a+=l.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Xs(t,this),this._draw(),Qs(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:n}=this,{align:r,labels:o}=t,h=I.color,a=ie(t.rtl,this.left,this.width),l=Q(o.font),{padding:c}=o,d=l.size,f=d/2;let g;this.drawTitle(),n.textAlign=a.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=l.string;const{boxWidth:p,boxHeight:m,itemHeight:x}=Ur(o,d),b=function(P,M,k){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;n.save();const C=L(k.lineWidth,1);if(n.fillStyle=L(k.fillStyle,h),n.lineCap=L(k.lineCap,"butt"),n.lineDashOffset=L(k.lineDashOffset,0),n.lineJoin=L(k.lineJoin,"miter"),n.lineWidth=C,n.strokeStyle=L(k.strokeStyle,h),n.setLineDash(L(k.lineDash,[])),o.usePointStyle){const z={radius:m*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:C},j=a.xPlus(P,p/2),D=M+f;Ho(n,z,j,D,o.pointStyleWidth&&p)}else{const z=M+Math.max((d-m)/2,0),j=a.leftForLtr(P,p),D=ee(k.borderRadius);n.beginPath(),Object.values(D).some($=>$!==0)?Pi(n,{x:j,y:z,w:p,h:m,radius:D}):n.rect(j,z,p,m),n.fill(),C!==0&&n.stroke()}n.restore()},v=function(P,M,k){Ae(n,k.text,P,M+x/2,l,{strikethrough:k.hidden,textAlign:a.textAlign(k.textAlign)})},y=this.isHorizontal(),w=this._computeTitleHeight();y?g={x:X(r,this.left+c,this.right-i[0]),y:this.top+c+w,line:0}:g={x:this.left+c,y:X(r,this.top+w+c,this.bottom-e[0].height),line:0},Jo(this.ctx,t.textDirection);const S=x+c;this.legendItems.forEach((P,M)=>{n.strokeStyle=P.fontColor,n.fillStyle=P.fontColor;const k=n.measureText(P.text).width,C=a.textAlign(P.textAlign||(P.textAlign=o.textAlign)),z=p+f+k;let j=g.x,D=g.y;a.setWidth(this.width),y?M>0&&j+z+c>this.right&&(D=g.y+=S,g.line++,j=g.x=X(r,this.left+c,this.right-i[g.line])):M>0&&D+S>this.bottom&&(j=g.x=j+e[g.line].width+c,g.line++,D=g.y=X(r,this.top+w+c,this.bottom-e[g.line].height));const $=a.x(j);if(b($,D,P),j=Wc(C,j+p+f,y?j+z:this.right,t.rtl),v(a.x(j),D,P),y)g.x+=z+c;else if(typeof P.text!="string"){const et=l.lineHeight;g.y+=gh(P,et)+c}else g.y+=S}),th(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=Q(e.font),n=ot(e.padding);if(!e.display)return;const r=ie(t.rtl,this.left,this.width),o=this.ctx,h=e.position,a=i.size/2,l=n.top+a;let c,d=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),c=this.top+l,d=X(t.align,d,this.right-f);else{const p=this.columnSizes.reduce((m,x)=>Math.max(m,x.height),0);c=l+X(t.align,this.top,this.bottom-p-t.labels.padding-this._computeTitleHeight())}const g=X(h,d,d+f);o.textAlign=r.textAlign(Us(h)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,Ae(o,e.text,g,c,i)}_computeTitleHeight(){const t=this.options.title,e=Q(t.font),i=ot(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,n,r;if(Jt(t,this.left,this.right)&&Jt(e,this.top,this.bottom)){for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(n=r[i],Jt(t,n.left,n.left+n.width)&&Jt(e,n.top,n.top+n.height))return this.legendItems[i]}return null}handleEvent(t){const e=this.options;if(!pf(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const n=this._hoveredItem,r=df(n,i);n&&!r&&B(e.onLeave,[t,n,this],this),this._hoveredItem=i,i&&!r&&B(e.onHover,[t,i,this],this)}else i&&B(e.onClick,[t,i,this],this)}}function uf(s,t,e,i,n){const r=ff(i,s,t,e),o=gf(n,i,t.lineHeight);return{itemWidth:r,itemHeight:o}}function ff(s,t,e,i){let n=s.text;return n&&typeof n!="string"&&(n=n.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+i.measureText(n).width}function gf(s,t,e){let i=s;return typeof t.text!="string"&&(i=gh(t,e)),i}function gh(s,t){const e=s.text?s.text.length:0;return t*e}function pf(s,t){return!!((s==="mousemove"||s==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(s==="click"||s==="mouseup"))}var mf={id:"legend",_element:Xr,start(s,t,e){const i=s.legend=new Xr({ctx:s.ctx,options:e,chart:s});nt.configure(s,i,e),nt.addBox(s,i)},stop(s){nt.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,t,e){const i=s.legend;nt.configure(s,i,e),i.options=e},afterUpdate(s){const t=s.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(s,t){t.replay||s.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,t,e){const i=t.datasetIndex,n=e.chart;n.isDatasetVisible(i)?(n.hide(i),t.hidden=!0):(n.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const t=s.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:n,color:r,useBorderRadius:o,borderRadius:h}}=s.legend.options;return s._getSortedDatasetMetas().map(a=>{const l=a.controller.getStyle(e?0:void 0),c=ot(l.borderWidth);return{text:t[a.index].label,fillStyle:l.backgroundColor,fontColor:r,hidden:!a.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:n||l.textAlign,borderRadius:o&&(h||l.borderRadius),datasetIndex:a.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class ph extends Tt{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const n=Y(i.text)?i.text.length:1;this._padding=ot(i.padding);const r=n*Q(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:i,bottom:n,right:r,options:o}=this,h=o.align;let a=0,l,c,d;return this.isHorizontal()?(c=X(h,i,r),d=e+t,l=r-i):(o.position==="left"?(c=i+t,d=X(h,n,e),a=K*-.5):(c=r-t,d=X(h,e,n),a=K*.5),l=n-e),{titleX:c,titleY:d,maxWidth:l,rotation:a}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=Q(e.font),r=i.lineHeight/2+this._padding.top,{titleX:o,titleY:h,maxWidth:a,rotation:l}=this._drawArgs(r);Ae(t,e.text,0,0,i,{color:e.color,maxWidth:a,rotation:l,textAlign:Us(e.align),textBaseline:"middle",translation:[o,h]})}}function xf(s,t){const e=new ph({ctx:s.ctx,options:t,chart:s});nt.configure(s,e,t),nt.addBox(s,e),s.titleBlock=e}var bf={id:"title",_element:ph,start(s,t,e){xf(s,e)},stop(s){const t=s.titleBlock;nt.removeBox(s,t),delete s.titleBlock},beforeUpdate(s,t,e){const i=s.titleBlock;nt.configure(s,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ke={average(s){if(!s.length)return!1;let t,e,i=new Set,n=0,r=0;for(t=0,e=s.length;t<e;++t){const h=s[t].element;if(h&&h.hasValue()){const a=h.tooltipPosition();i.add(a.x),n+=a.y,++r}}return r===0||i.size===0?!1:{x:[...i].reduce((h,a)=>h+a)/i.size,y:n/r}},nearest(s,t){if(!s.length)return!1;let e=t.x,i=t.y,n=Number.POSITIVE_INFINITY,r,o,h;for(r=0,o=s.length;r<o;++r){const a=s[r].element;if(a&&a.hasValue()){const l=a.getCenterPoint(),c=Lc(t,l);c<n&&(n=c,h=a)}}if(h){const a=h.tooltipPosition();e=a.x,i=a.y}return{x:e,y:i}}};function ft(s,t){return t&&(Y(t)?Array.prototype.push.apply(s,t):s.push(t)),s}function xt(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function vf(s,t){const{element:e,datasetIndex:i,index:n}=t,r=s.getDatasetMeta(i).controller,{label:o,value:h}=r.getLabelAndValue(n);return{chart:s,label:o,parsed:r.getParsed(n),raw:s.data.datasets[i].data[n],formattedValue:h,dataset:r.getDataset(),dataIndex:n,datasetIndex:i,element:e}}function Qr(s,t){const e=s.chart.ctx,{body:i,footer:n,title:r}=s,{boxWidth:o,boxHeight:h}=t,a=Q(t.bodyFont),l=Q(t.titleFont),c=Q(t.footerFont),d=r.length,f=n.length,g=i.length,p=ot(t.padding);let m=p.height,x=0,b=i.reduce((w,S)=>w+S.before.length+S.lines.length+S.after.length,0);if(b+=s.beforeBody.length+s.afterBody.length,d&&(m+=d*l.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),b){const w=t.displayColors?Math.max(h,a.lineHeight):a.lineHeight;m+=g*w+(b-g)*a.lineHeight+(b-1)*t.bodySpacing}f&&(m+=t.footerMarginTop+f*c.lineHeight+(f-1)*t.footerSpacing);let v=0;const y=function(w){x=Math.max(x,e.measureText(w).width+v)};return e.save(),e.font=l.string,F(s.title,y),e.font=a.string,F(s.beforeBody.concat(s.afterBody),y),v=t.displayColors?o+2+t.boxPadding:0,F(i,w=>{F(w.before,y),F(w.lines,y),F(w.after,y)}),v=0,e.font=c.string,F(s.footer,y),e.restore(),x+=p.width,{width:x,height:m}}function yf(s,t){const{y:e,height:i}=t;return e<i/2?"top":e>s.height-i/2?"bottom":"center"}function _f(s,t,e,i){const{x:n,width:r}=i,o=e.caretSize+e.caretPadding;if(s==="left"&&n+r+o>t.width||s==="right"&&n-r-o<0)return!0}function wf(s,t,e,i){const{x:n,width:r}=e,{width:o,chartArea:{left:h,right:a}}=s;let l="center";return i==="center"?l=n<=(h+a)/2?"left":"right":n<=r/2?l="left":n>=o-r/2&&(l="right"),_f(l,s,t,e)&&(l="center"),l}function Kr(s,t,e){const i=e.yAlign||t.yAlign||yf(s,e);return{xAlign:e.xAlign||t.xAlign||wf(s,t,e,i),yAlign:i}}function Sf(s,t){let{x:e,width:i}=s;return t==="right"?e-=i:t==="center"&&(e-=i/2),e}function kf(s,t,e){let{y:i,height:n}=s;return t==="top"?i+=e:t==="bottom"?i-=n+e:i-=n/2,i}function Gr(s,t,e,i){const{caretSize:n,caretPadding:r,cornerRadius:o}=s,{xAlign:h,yAlign:a}=e,l=n+r,{topLeft:c,topRight:d,bottomLeft:f,bottomRight:g}=ee(o);let p=Sf(t,h);const m=kf(t,a,l);return a==="center"?h==="left"?p+=l:h==="right"&&(p-=l):h==="left"?p-=Math.max(c,f)+n:h==="right"&&(p+=Math.max(d,g)+n),{x:lt(p,0,i.width-t.width),y:lt(m,0,i.height-t.height)}}function ai(s,t,e){const i=ot(e.padding);return t==="center"?s.x+s.width/2:t==="right"?s.x+s.width-i.right:s.x+i.left}function Zr(s){return ft([],xt(s))}function Mf(s,t,e){return ce(s,{tooltip:t,tooltipItems:e,type:"tooltip"})}function Jr(s,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?s.override(e):s}const mh={beforeTitle:pt,title(s){if(s.length>0){const t=s[0],e=t.chart.data.labels,i=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return e[t.dataIndex]}return""},afterTitle:pt,beforeBody:pt,beforeLabel:pt,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let t=s.dataset.label||"";t&&(t+=": ");const e=s.formattedValue;return A(e)||(t+=e),t},labelColor(s){const e=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const e=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:pt,afterBody:pt,beforeFooter:pt,footer:pt,afterFooter:pt};function Z(s,t,e,i){const n=s[t].call(e,i);return typeof n>"u"?mh[t].call(e,i):n}class Ts extends Tt{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),n=i.enabled&&e.options.animation&&i.animations,r=new eh(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=Mf(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:i}=e,n=Z(i,"beforeTitle",this,t),r=Z(i,"title",this,t),o=Z(i,"afterTitle",this,t);let h=[];return h=ft(h,xt(n)),h=ft(h,xt(r)),h=ft(h,xt(o)),h}getBeforeBody(t,e){return Zr(Z(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,n=[];return F(t,r=>{const o={before:[],lines:[],after:[]},h=Jr(i,r);ft(o.before,xt(Z(h,"beforeLabel",this,r))),ft(o.lines,Z(h,"label",this,r)),ft(o.after,xt(Z(h,"afterLabel",this,r))),n.push(o)}),n}getAfterBody(t,e){return Zr(Z(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,n=Z(i,"beforeFooter",this,t),r=Z(i,"footer",this,t),o=Z(i,"afterFooter",this,t);let h=[];return h=ft(h,xt(n)),h=ft(h,xt(r)),h=ft(h,xt(o)),h}_createItems(t){const e=this._active,i=this.chart.data,n=[],r=[],o=[];let h=[],a,l;for(a=0,l=e.length;a<l;++a)h.push(vf(this.chart,e[a]));return t.filter&&(h=h.filter((c,d,f)=>t.filter(c,d,f,i))),t.itemSort&&(h=h.sort((c,d)=>t.itemSort(c,d,i))),F(h,c=>{const d=Jr(t.callbacks,c);n.push(Z(d,"labelColor",this,c)),r.push(Z(d,"labelPointStyle",this,c)),o.push(Z(d,"labelTextColor",this,c))}),this.labelColors=n,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=h,h}update(t,e){const i=this.options.setContext(this.getContext()),n=this._active;let r,o=[];if(!n.length)this.opacity!==0&&(r={opacity:0});else{const h=ke[i.position].call(this,n,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const a=this._size=Qr(this,i),l=Object.assign({},h,a),c=Kr(this.chart,i,l),d=Gr(i,l,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,r={opacity:1,x:d.x,y:d.y,width:a.width,height:a.height,caretX:h.x,caretY:h.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,n){const r=this.getCaretPosition(t,i,n);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,i){const{xAlign:n,yAlign:r}=this,{caretSize:o,cornerRadius:h}=i,{topLeft:a,topRight:l,bottomLeft:c,bottomRight:d}=ee(h),{x:f,y:g}=t,{width:p,height:m}=e;let x,b,v,y,w,S;return r==="center"?(w=g+m/2,n==="left"?(x=f,b=x-o,y=w+o,S=w-o):(x=f+p,b=x+o,y=w-o,S=w+o),v=x):(n==="left"?b=f+Math.max(a,c)+o:n==="right"?b=f+p-Math.max(l,d)-o:b=this.caretX,r==="top"?(y=g,w=y-o,x=b-o,v=b+o):(y=g+m,w=y+o,x=b+o,v=b-o),S=y),{x1:x,x2:b,x3:v,y1:y,y2:w,y3:S}}drawTitle(t,e,i){const n=this.title,r=n.length;let o,h,a;if(r){const l=ie(i.rtl,this.x,this.width);for(t.x=ai(this,i.titleAlign,i),e.textAlign=l.textAlign(i.titleAlign),e.textBaseline="middle",o=Q(i.titleFont),h=i.titleSpacing,e.fillStyle=i.titleColor,e.font=o.string,a=0;a<r;++a)e.fillText(n[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+h,a+1===r&&(t.y+=i.titleMarginBottom-h)}}_drawColorBox(t,e,i,n,r){const o=this.labelColors[i],h=this.labelPointStyles[i],{boxHeight:a,boxWidth:l}=r,c=Q(r.bodyFont),d=ai(this,"left",r),f=n.x(d),g=a<c.lineHeight?(c.lineHeight-a)/2:0,p=e.y+g;if(r.usePointStyle){const m={radius:Math.min(l,a)/2,pointStyle:h.pointStyle,rotation:h.rotation,borderWidth:1},x=n.leftForLtr(f,l)+l/2,b=p+a/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,gr(t,m,x,b),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,gr(t,m,x,b)}else{t.lineWidth=E(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const m=n.leftForLtr(f,l),x=n.leftForLtr(n.xPlus(f,1),l-2),b=ee(o.borderRadius);Object.values(b).some(v=>v!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,Pi(t,{x:m,y:p,w:l,h:a,radius:b}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Pi(t,{x,y:p+1,w:l-2,h:a-2,radius:b}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(m,p,l,a),t.strokeRect(m,p,l,a),t.fillStyle=o.backgroundColor,t.fillRect(x,p+1,l-2,a-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:n}=this,{bodySpacing:r,bodyAlign:o,displayColors:h,boxHeight:a,boxWidth:l,boxPadding:c}=i,d=Q(i.bodyFont);let f=d.lineHeight,g=0;const p=ie(i.rtl,this.x,this.width),m=function(k){e.fillText(k,p.x(t.x+g),t.y+f/2),t.y+=f+r},x=p.textAlign(o);let b,v,y,w,S,P,M;for(e.textAlign=o,e.textBaseline="middle",e.font=d.string,t.x=ai(this,x,i),e.fillStyle=i.bodyColor,F(this.beforeBody,m),g=h&&x!=="right"?o==="center"?l/2+c:l+2+c:0,w=0,P=n.length;w<P;++w){for(b=n[w],v=this.labelTextColors[w],e.fillStyle=v,F(b.before,m),y=b.lines,h&&y.length&&(this._drawColorBox(e,t,w,p,i),f=Math.max(d.lineHeight,a)),S=0,M=y.length;S<M;++S)m(y[S]),f=d.lineHeight;F(b.after,m)}g=0,f=d.lineHeight,F(this.afterBody,m),t.y-=r}drawFooter(t,e,i){const n=this.footer,r=n.length;let o,h;if(r){const a=ie(i.rtl,this.x,this.width);for(t.x=ai(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=a.textAlign(i.footerAlign),e.textBaseline="middle",o=Q(i.footerFont),e.fillStyle=i.footerColor,e.font=o.string,h=0;h<r;++h)e.fillText(n[h],a.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+i.footerSpacing}}drawBackground(t,e,i,n){const{xAlign:r,yAlign:o}=this,{x:h,y:a}=t,{width:l,height:c}=i,{topLeft:d,topRight:f,bottomLeft:g,bottomRight:p}=ee(n.cornerRadius);e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.beginPath(),e.moveTo(h+d,a),o==="top"&&this.drawCaret(t,e,i,n),e.lineTo(h+l-f,a),e.quadraticCurveTo(h+l,a,h+l,a+f),o==="center"&&r==="right"&&this.drawCaret(t,e,i,n),e.lineTo(h+l,a+c-p),e.quadraticCurveTo(h+l,a+c,h+l-p,a+c),o==="bottom"&&this.drawCaret(t,e,i,n),e.lineTo(h+g,a+c),e.quadraticCurveTo(h,a+c,h,a+c-g),o==="center"&&r==="left"&&this.drawCaret(t,e,i,n),e.lineTo(h,a+d),e.quadraticCurveTo(h,a,h+d,a),e.closePath(),e.fill(),n.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,n=i&&i.x,r=i&&i.y;if(n||r){const o=ke[t.position].call(this,this._active,this._eventPosition);if(!o)return;const h=this._size=Qr(this,t),a=Object.assign({},o,this._size),l=Kr(e,t,a),c=Gr(t,a,l,e);(n._to!==c.x||r._to!==c.y)&&(this.xAlign=l.xAlign,this.yAlign=l.yAlign,this.width=h.width,this.height=h.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,c))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const n={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=ot(e.padding),h=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&h&&(t.save(),t.globalAlpha=i,this.drawBackground(r,t,n,e),Jo(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),th(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,n=t.map(({datasetIndex:h,index:a})=>{const l=this.chart.getDatasetMeta(h);if(!l)throw new Error("Cannot find a dataset at index "+h);return{datasetIndex:h,element:l.data[a],index:a}}),r=!wi(i,n),o=this._positionChanged(n,e);(r||o)&&(this._active=n,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,i),h=this._positionChanged(o,t),a=e||!wi(o,r)||h;return a&&(this._active=o,(n.enabled||n.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),a}_getActiveElements(t,e,i,n){const r=this.options;if(t.type==="mouseout")return[];if(!n)return e.filter(h=>this.chart.data.datasets[h.datasetIndex]&&this.chart.getDatasetMeta(h.datasetIndex).controller.getParsed(h.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,i);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:i,caretY:n,options:r}=this,o=ke[r.position].call(this,t,e);return o!==!1&&(i!==o.x||n!==o.y)}}T(Ts,"positioners",ke);var Pf={id:"tooltip",_element:Ts,positioners:ke,afterInit(s,t,e){e&&(s.tooltip=new Ts({chart:s,options:e}))},beforeUpdate(s,t,e){s.tooltip&&s.tooltip.initialize(e)},reset(s,t,e){s.tooltip&&s.tooltip.initialize(e)},afterDraw(s){const t=s.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(s.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",e)}},afterEvent(s,t){if(s.tooltip){const e=t.replay;s.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,t)=>t.bodyFont.size,boxWidth:(s,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:mh},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Cf=(s,t,e,i)=>(typeof t=="string"?(e=s.push(t)-1,i.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function jf(s,t,e,i){const n=s.indexOf(t);if(n===-1)return Cf(s,t,e,i);const r=s.lastIndexOf(t);return n!==r?e:n}const Rf=(s,t)=>s===null?null:lt(Math.round(s),0,t);function to(s){const t=this.getLabels();return s>=0&&s<t.length?t[s]:s}class Es extends de{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const i=this.getLabels();for(const{index:n,label:r}of e)i[n]===r&&i.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(A(t))return null;const i=this.getLabels();return e=isFinite(e)&&i[e]===t?e:jf(i,t,L(e,t),this._addedLabels),Rf(e,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:n}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),e||(n=this.getLabels().length-1)),this.min=i,this.max=n}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,n=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=t;o<=e;o++)n.push({value:o});return n}getLabelForValue(t){return to.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}T(Es,"id","category"),T(Es,"defaults",{ticks:{callback:to}});function zf(s,t){const e=[],{bounds:n,step:r,min:o,max:h,precision:a,count:l,maxTicks:c,maxDigits:d,includeBounds:f}=s,g=r||1,p=c-1,{min:m,max:x}=t,b=!A(o),v=!A(h),y=!A(l),w=(x-m)/(d+1);let S=rr((x-m)/p/g)*g,P,M,k,C;if(S<1e-14&&!b&&!v)return[{value:m},{value:x}];C=Math.ceil(x/S)-Math.floor(m/S),C>p&&(S=rr(C*S/p/g)*g),A(a)||(P=Math.pow(10,a),S=Math.ceil(S*P)/P),n==="ticks"?(M=Math.floor(m/S)*S,k=Math.ceil(x/S)*S):(M=m,k=x),b&&v&&r&&zc((h-o)/r,S/1e3)?(C=Math.round(Math.min((h-o)/S,c)),S=(h-o)/C,M=o,k=h):y?(M=b?o:M,k=v?h:k,C=l-1,S=(k-M)/C):(C=(k-M)/S,di(C,Math.round(C),S/1e3)?C=Math.round(C):C=Math.ceil(C));const z=Math.max(or(S),or(M));P=Math.pow(10,A(a)?z:a),M=Math.round(M*P)/P,k=Math.round(k*P)/P;let j=0;for(b&&(f&&M!==o?(e.push({value:o}),M<o&&j++,di(Math.round((M+j*S)*P)/P,o,eo(o,w,s))&&j++):M<o&&j++);j<C;++j){const D=Math.round((M+j*S)*P)/P;if(v&&D>h)break;e.push({value:D})}return v&&f&&k!==h?e.length&&di(e[e.length-1].value,h,eo(h,w,s))?e[e.length-1].value=h:e.push({value:h}):(!v||k===h)&&e.push({value:k}),e}function eo(s,t,{horizontal:e,minRotation:i}){const n=Vt(i),r=(e?Math.sin(n):Math.cos(n))||.001,o=.75*t*(""+s).length;return Math.min(t/r,o)}class Df extends de{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return A(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:n,max:r}=this;const o=a=>n=e?n:a,h=a=>r=i?r:a;if(t){const a=zt(n),l=zt(r);a<0&&l<0?h(0):a>0&&l>0&&o(0)}if(n===r){let a=r===0?1:Math.abs(r*.05);h(r+a),t||o(n-a)}this.min=n,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:i}=t,n;return i?(n=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),e=e||11),e&&(n=Math.min(e,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const n={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=zf(n,r);return t.bounds==="ticks"&&Dc(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const n=(i-e)/Math.max(t.length-1,1)/2;e-=n,i+=n}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return Yo(t,this.chart.options.locale,this.options.ticks.format)}}class Ls extends Df{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=rt(t)?t:0,this.max=rt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=Vt(this.options.ticks.minRotation),n=(t?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/n))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}T(Ls,"id","linear"),T(Ls,"defaults",{ticks:{callback:$o.formatters.numeric}});const Wi={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},J=Object.keys(Wi);function io(s,t){return s-t}function so(s,t){if(A(t))return null;const e=s._adapter,{parser:i,round:n,isoWeekday:r}=s._parseOpts;let o=t;return typeof i=="function"&&(o=i(o)),rt(o)||(o=typeof i=="string"?e.parse(o,i):e.parse(o)),o===null?null:(n&&(o=n==="week"&&(Mi(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,n)),+o)}function no(s,t,e,i){const n=J.length;for(let r=J.indexOf(s);r<n-1;++r){const o=Wi[J[r]],h=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(h*o.size))<=i)return J[r]}return J[n-1]}function Tf(s,t,e,i,n){for(let r=J.length-1;r>=J.indexOf(e);r--){const o=J[r];if(Wi[o].common&&s._adapter.diff(n,i,o)>=t-1)return o}return J[e?J.indexOf(e):0]}function Ef(s){for(let t=J.indexOf(s)+1,e=J.length;t<e;++t)if(Wi[J[t]].common)return J[t]}function ro(s,t,e){if(!e)s[t]=!0;else if(e.length){const{lo:i,hi:n}=qs(e,t),r=e[i]>=t?e[i]:e[n];s[r]=!0}}function Lf(s,t,e,i){const n=s._adapter,r=+n.startOf(t[0].value,i),o=t[t.length-1].value;let h,a;for(h=r;h<=o;h=+n.add(h,1,i))a=e[h],a>=0&&(t[a].major=!0);return t}function oo(s,t,e){const i=[],n={},r=t.length;let o,h;for(o=0;o<r;++o)h=t[o],n[h]=o,i.push({value:h,major:!1});return r===0||!e?i:Lf(s,i,n,e)}class Ri extends de{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const i=t.time||(t.time={}),n=this._adapter=new Kd._date(t.adapters.date);n.init(e),Re(i.displayFormats,n.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:so(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:n,max:r,minDefined:o,maxDefined:h}=this.getUserBounds();function a(l){!o&&!isNaN(l.min)&&(n=Math.min(n,l.min)),!h&&!isNaN(l.max)&&(r=Math.max(r,l.max))}(!o||!h)&&(a(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&a(this.getMinMax(!1))),n=rt(n)&&!isNaN(n)?n:+e.startOf(Date.now(),i),r=rt(r)&&!isNaN(r)?r:+e.endOf(Date.now(),i)+1,this.min=Math.min(n,r-1),this.max=Math.max(n+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,n=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const r=this.min,o=this.max,h=Nc(n,r,o);return this._unit=e.unit||(i.autoSkip?no(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):Tf(this,h.length,e.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:Ef(this._unit),this.initOffsets(n),t.reverse&&h.reverse(),oo(this,h,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,i=0,n,r;this.options.offset&&t.length&&(n=this.getDecimalForValue(t[0]),t.length===1?e=1-n:e=(this.getDecimalForValue(t[1])-n)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?i=r:i=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=lt(e,0,o),i=lt(i,0,o),this._offsets={start:e,end:i,factor:1/(e+1+i)}}_generate(){const t=this._adapter,e=this.min,i=this.max,n=this.options,r=n.time,o=r.unit||no(r.minUnit,e,i,this._getLabelCapacity(e)),h=L(n.ticks.stepSize,1),a=o==="week"?r.isoWeekday:!1,l=Mi(a)||a===!0,c={};let d=e,f,g;if(l&&(d=+t.startOf(d,"isoWeek",a)),d=+t.startOf(d,l?"day":o),t.diff(i,e,o)>1e5*h)throw new Error(e+" and "+i+" are too far apart with stepSize of "+h+" "+o);const p=n.ticks.source==="data"&&this.getDataTimestamps();for(f=d,g=0;f<i;f=+t.add(f,h,o),g++)ro(c,f,p);return(f===i||n.bounds==="ticks"||g===1)&&ro(c,f,p),Object.keys(c).sort(io).map(m=>+m)}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const n=this.options.time.displayFormats,r=this._unit,o=e||n[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,i,n){const r=this.options,o=r.ticks.callback;if(o)return B(o,[t,e,i],this);const h=r.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&h[a],d=l&&h[l],f=i[e],g=l&&d&&f&&f.major;return this._adapter.format(t,n||(g?d:c))}generateTickLabels(t){let e,i,n;for(e=0,i=t.length;e<i;++e)n=t[e],n.label=this._tickFormatFunction(n.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,n=Vt(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(n),o=Math.sin(n),h=this._resolveTickFontOptions(0).size;return{w:i*r+h*o,h:i*o+h*r}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,n=i[e.unit]||i.millisecond,r=this._tickFormatFunction(t,0,oo(this,[t],this._majorUnit),n),o=this._getLabelSize(r),h=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return h>0?h:1}getDataTimestamps(){let t=this._cache.data||[],e,i;if(t.length)return t;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(e=0,i=n.length;e<i;++e)t=t.concat(n[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const n=this.getLabels();for(e=0,i=n.length;e<i;++e)t.push(so(this,n[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Bo(t.sort(io))}}T(Ri,"id","time"),T(Ri,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function li(s,t,e){let i=0,n=s.length-1,r,o,h,a;e?(t>=s[i].pos&&t<=s[n].pos&&({lo:i,hi:n}=js(s,"pos",t)),{pos:r,time:h}=s[i],{pos:o,time:a}=s[n]):(t>=s[i].time&&t<=s[n].time&&({lo:i,hi:n}=js(s,"time",t)),{time:r,pos:h}=s[i],{time:o,pos:a}=s[n]);const l=o-r;return l?h+(a-h)*(t-r)/l:h}class ho extends Ri{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=li(e,this.min),this._tableRange=li(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,n=[],r=[];let o,h,a,l,c;for(o=0,h=t.length;o<h;++o)l=t[o],l>=e&&l<=i&&n.push(l);if(n.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(o=0,h=n.length;o<h;++o)c=n[o+1],a=n[o-1],l=n[o],Math.round((c+a)/2)!==l&&r.push({time:l,pos:o/(h-1)});return r}_generate(){const t=this.min,e=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(e)||i.length===1)&&i.push(e),i.sort((n,r)=>n-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return e.length&&i.length?t=this.normalize(e.concat(i)):t=e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(li(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return li(this._table,i*this._tableRange+this._minPos,!0)}}T(ho,"id","timeseries"),T(ho,"defaults",Ri.defaults);const xh="label";function ao(s,t){typeof s=="function"?s(t):s&&(s.current=t)}function Ff(s,t){const e=s.options;e&&t&&Object.assign(e,t)}function bh(s,t){s.labels=t}function vh(s,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xh;const i=[];s.datasets=t.map(n=>{const r=s.datasets.find(o=>o[e]===n[e]);return!r||!n.data||i.includes(r)?{...n}:(i.push(r),Object.assign(r,n),r)})}function Of(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xh;const e={labels:[],datasets:[]};return bh(e,s.labels),vh(e,s.datasets,t),e}function Af(s,t){const{height:e=150,width:i=300,redraw:n=!1,datasetIdKey:r,type:o,data:h,options:a,plugins:l=[],fallbackContent:c,updateMode:d,...f}=s,g=R.useRef(null),p=R.useRef(null),m=()=>{g.current&&(p.current=new Ii(g.current,{type:o,data:Of(h,r),options:a&&{...a},plugins:l}),ao(t,p.current))},x=()=>{ao(t,null),p.current&&(p.current.destroy(),p.current=null)};return R.useEffect(()=>{!n&&p.current&&a&&Ff(p.current,a)},[n,a]),R.useEffect(()=>{!n&&p.current&&bh(p.current.config.data,h.labels)},[n,h.labels]),R.useEffect(()=>{!n&&p.current&&h.datasets&&vh(p.current.config.data,h.datasets,r)},[n,h.datasets]),R.useEffect(()=>{p.current&&(n?(x(),setTimeout(m)):p.current.update(d))},[n,a,h.labels,h.datasets,d]),R.useEffect(()=>{p.current&&(x(),setTimeout(m))},[o]),R.useEffect(()=>(m(),()=>x()),[]),Os.createElement("canvas",{ref:g,role:"img",height:e,width:i,...f},c)}const Nf=R.forwardRef(Af);function Bf(s,t){return Ii.register(t),R.forwardRef((e,i)=>Os.createElement(Nf,{...e,ref:i,type:s}))}const If=Bf("bar",ui);Ii.register(Es,Ls,pi,bf,Pf,mf);const Wf=({finalEquityData:s,binCount:t=30,width:e=600,height:i=400,showStatistics:n=!0,isLoading:r=!1})=>{var l,c,d;const o=R.useMemo(()=>{if(!s||s.length===0)return null;const f=[...s].sort((b,v)=>b-v),g=Math.min(...f),p=Math.max(...f),m=(p-g)/t,x=[];for(let b=0;b<t;b++){const v=g+b*m,y=g+(b+1)*m;x.push({min:v,max:y,count:0,percentage:0,midpoint:(v+y)/2})}return f.forEach(b=>{let v=Math.floor((b-g)/m);if(v>=t&&(v=t-1),v>=0&&v<x.length){const y=x[v];y&&y.count++}}),x.forEach(b=>{b.percentage=b.count/f.length*100}),{bins:x,statistics:{min:g,max:p,mean:f.reduce((b,v)=>b+v,0)/f.length,median:f[Math.floor(f.length/2)],p25:f[Math.floor(f.length*.25)],p75:f[Math.floor(f.length*.75)],stdDev:Math.sqrt(f.reduce((b,v)=>{const y=f.reduce((w,S)=>w+S,0)/f.length;return b+Math.pow(v-y,2)},0)/f.length)}}},[s,t]),h=R.useMemo(()=>o?{labels:o.bins.map(g=>`$${(g.midpoint/1e3).toFixed(0)}K`),datasets:[{label:"Frequency",data:o.bins.map(g=>g.count),backgroundColor:"rgba(33, 150, 243, 0.6)",borderColor:"rgba(33, 150, 243, 1)",borderWidth:1,borderRadius:2}]}:{labels:[],datasets:[]},[o]),a=R.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Final Equity Distribution",font:{size:16,weight:"bold"},color:"#374151"},tooltip:{callbacks:{title:f=>{var m;if(!f||f.length===0)return"";const g=(m=f[0])==null?void 0:m.dataIndex,p=o==null?void 0:o.bins[g??-1];return p?`$${(p.min/1e3).toFixed(0)}K - $${(p.max/1e3).toFixed(0)}K`:""},label:f=>{const g=f.dataIndex,p=o==null?void 0:o.bins[g];return p?[`Count: ${p.count}`,`Percentage: ${p.percentage.toFixed(1)}%`]:""}}}},scales:{x:{title:{display:!0,text:"Final Portfolio Value",font:{size:12,weight:"bold"},color:"#6B7280"},grid:{color:"rgba(0, 0, 0, 0.1)"}},y:{title:{display:!0,text:"Frequency",font:{size:12,weight:"bold"},color:"#6B7280"},grid:{color:"rgba(0, 0, 0, 0.1)"},beginAtZero:!0}}}),[o]);return r?u.jsx("div",{className:"flex items-center justify-center bg-gray-50 border border-gray-200 rounded-lg",style:{width:e,height:i},children:u.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Generating distribution..."})]})}):!s||!o?u.jsx("div",{className:"flex items-center justify-center bg-gray-50 border border-gray-200 rounded-lg",style:{width:e,height:i},children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-gray-400 mb-2",children:"📊"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Run a simulation to see distribution"})]})}):u.jsxs("div",{className:"histogram-chart",children:[u.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:u.jsx("div",{style:{width:e,height:i},children:u.jsx(If,{data:h,options:a})})}),n&&o.statistics&&u.jsxs("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:[u.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Distribution Statistics"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Mean"}),u.jsxs("div",{className:"font-semibold",children:["$",o.statistics.mean.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Median"}),u.jsxs("div",{className:"font-semibold",children:["$",((l=o.statistics.median)==null?void 0:l.toLocaleString())??"N/A"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Standard Deviation"}),u.jsxs("div",{className:"font-semibold",children:["$",o.statistics.stdDev.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Range"}),u.jsxs("div",{className:"font-semibold",children:["$",(o.statistics.min/1e3).toFixed(0),"K - $",(o.statistics.max/1e3).toFixed(0),"K"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"25th Percentile"}),u.jsxs("div",{className:"font-semibold",children:["$",((c=o.statistics.p25)==null?void 0:c.toLocaleString())??"N/A"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"75th Percentile"}),u.jsxs("div",{className:"font-semibold",children:["$",((d=o.statistics.p75)==null?void 0:d.toLocaleString())??"N/A"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Sample Size"}),u.jsx("div",{className:"font-semibold",children:s.length.toLocaleString()})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"Bins"}),u.jsx("div",{className:"font-semibold",children:t})]})]})]}),u.jsx("div",{className:"text-xs text-gray-400 mt-2 text-center",children:"Distribution of final portfolio values across all simulation runs"})]})},Vf="/api/v1/risk";class mi extends Error{constructor(t,e,i,n){super(i),this.status=t,this.statusText=e,this.details=n,this.name="RiskApiError"}}async function Yf(s,t){const e=`${Vf}${s}`;try{const i=await fetch(e,{headers:{"Content-Type":"application/json",...t==null?void 0:t.headers},...t});if(!i.ok){let n;try{n=await i.json()}catch{n={message:"Unknown error"}}throw new mi(i.status,i.statusText,n.message||`API request failed: ${i.status} ${i.statusText}`,n.details)}return await i.json()}catch(i){throw i instanceof mi?i:new mi(0,"Network Error",i instanceof Error?i.message:"An unknown error occurred")}}async function $f(s){return Yf("/montecarlo",{method:"POST",body:JSON.stringify(s)})}function Hf(s){return s instanceof mi?s.status===400?`Invalid parameters: ${s.message}`:s.status===422?`Validation error: ${s.message}`:s.status===500?`Simulation error: ${s.message}`:s.status===0?"Network error: Please check your connection and try again":s.message:s instanceof Error?s.message:"An unexpected error occurred"}const ht={p_win:{min:.1,max:.9,step:.01,default:.45,label:"Win Rate",format:s=>`${(s*100).toFixed(0)}%`,description:"Probability of winning each trade"},r_win:{min:1,max:5,step:.1,default:2.5,label:"Risk:Reward Ratio",format:s=>`${s.toFixed(1)}:1`,description:"Risk-to-reward ratio for winning trades"},risk_pct:{min:.001,max:.05,step:5e-4,default:.005,label:"Risk Per Trade",format:s=>`${(s*100).toFixed(1)}%`,description:"Percentage of account risked per trade"},trades_per_week:{min:1,max:50,step:1,default:10,label:"Trades Per Week",format:s=>`${s}`,description:"Number of trades executed per week"},weeks:{min:4,max:260,step:1,default:52,label:"Simulation Period",format:s=>`${s} weeks`,description:"Duration of simulation in weeks"},cost_per_trade_usd:{min:0,max:10,step:.25,default:1,label:"Cost Per Trade",format:s=>`$${s.toFixed(2)}`,description:"Fixed cost per trade (commissions, fees)"},slippage_bps:{min:0,max:100,step:5,default:10,label:"Slippage",format:s=>`${s} bps`,description:"Expected slippage in basis points"},starting_capital:{min:1e3,max:1e6,step:1e3,default:1e4,label:"Starting Capital",format:s=>`$${s.toLocaleString()}`,description:"Initial account size"},num_simulations:{min:100,max:5e3,step:100,default:1e3,label:"Simulations",format:s=>`${s.toLocaleString()}`,description:"Number of Monte Carlo paths to generate"}};function bs(){return{p_win:ht.p_win.default,r_win:ht.r_win.default,risk_pct:ht.risk_pct.default,trades_per_week:ht.trades_per_week.default,weeks:ht.weeks.default,cost_per_trade_usd:ht.cost_per_trade_usd.default,slippage_bps:ht.slippage_bps.default,starting_capital:ht.starting_capital.default,num_simulations:ht.num_simulations.default}}function qf(s){const t=[];return Object.entries(ht).forEach(([e,i])=>{const n=s[e];typeof n=="number"&&(n<i.min||n>i.max)&&t.push(`${i.label} must be between ${i.min} and ${i.max}`)}),s.p_win*s.r_win<1&&t.push("Expected value should typically be positive (Win Rate × R:R Ratio ≥ 1.0)"),t}function Uf(s){return s.p_win*s.r_win-(1-s.p_win)*1}function Xf(s){const e=s.num_simulations/100,i=s.weeks*s.trades_per_week/520;return 1200*e*i}const lo="risk-sandbox-parameters";function Qf(){const[s,t]=R.useState(()=>{const f=localStorage.getItem(lo);if(f)try{return JSON.parse(f)}catch{return bs()}return bs()}),[e,i]=R.useState(null),[n,r]=R.useState([]),o=Sh({mutationFn:$f,onSuccess:f=>{i(f),r([])},onError:f=>{console.error("Simulation error:",f),i(null)}});R.useEffect(()=>{localStorage.setItem(lo,JSON.stringify(s));const f=qf(s);r(f)},[s]);const h=R.useCallback((f,g)=>{t(p=>({...p,[f]:g}))},[]),a=R.useCallback(()=>{t(bs()),i(null)},[]),l=R.useCallback(()=>{n.length>0||o.mutate(s)},[s,n,o]),c=Uf(s),d=Xf(s);return u.jsxs("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[u.jsxs("div",{style:{marginBottom:"2rem"},children:[u.jsx("h1",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-primary)"},children:"Risk Sandbox"}),u.jsx("p",{style:{color:"var(--color-text-muted)",margin:0},children:"Interactive Monte Carlo simulation for trading strategy analysis. Adjust parameters to see how different win rates, risk-reward ratios, and position sizing affect your potential outcomes."})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"400px 1fr",gap:"2rem"},children:[u.jsx("div",{children:u.jsxs("div",{style:{backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"8px",padding:"1.5rem",position:"sticky",top:"2rem"},children:[u.jsx("h3",{style:{margin:"0 0 1.5rem 0",color:"var(--color-text-primary)"},children:"Trading Parameters"}),Object.entries(ht).map(([f,g])=>u.jsx(Fh,{label:g.label,value:s[f],min:g.min,max:g.max,step:g.step,onChange:p=>h(f,p),formatValue:g.format,description:g.description,disabled:o.isPending},f)),n.length>0&&u.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"var(--color-danger-light, #fee)",border:"1px solid var(--color-danger)",borderRadius:"4px"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-danger)"},children:"Parameter Issues:"}),u.jsx("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:n.map((f,g)=>u.jsx("li",{style:{color:"var(--color-danger)",fontSize:"0.85rem"},children:f},g))})]}),u.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"var(--color-background)",borderRadius:"6px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",color:"var(--color-text-secondary)"},children:"Quick Analysis"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{style:{fontSize:"0.85rem"},children:"Expected R:"}),u.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:"bold",color:c>0?"var(--color-success)":"var(--color-danger)"},children:[c>0?"+":"",c.toFixed(3),"R"]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{style:{fontSize:"0.85rem"},children:"Total Trades:"}),u.jsx("span",{style:{fontSize:"0.85rem",fontWeight:"bold"},children:(s.trades_per_week*s.weeks).toLocaleString()})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[u.jsx("span",{style:{fontSize:"0.85rem"},children:"Est. Time:"}),u.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:["~",(d/1e3).toFixed(1),"s"]})]})]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{onClick:l,disabled:o.isPending||n.length>0,style:{flex:1,padding:"0.75rem",backgroundColor:o.isPending||n.length>0?"var(--color-text-muted)":"var(--color-primary)",color:"white",border:"none",borderRadius:"4px",fontSize:"1rem",fontWeight:"bold",cursor:o.isPending||n.length>0?"not-allowed":"pointer",transition:"background-color 0.2s ease"},children:o.isPending?"Running...":"Run Simulation"}),u.jsx("button",{onClick:a,disabled:o.isPending,style:{padding:"0.75rem",backgroundColor:"var(--color-background)",color:"var(--color-text-secondary)",border:"1px solid var(--color-border)",borderRadius:"4px",fontSize:"0.9rem",cursor:o.isPending?"not-allowed":"pointer",opacity:o.isPending?.5:1},title:"Reset to defaults",children:"Reset"})]})]})}),u.jsxs("div",{children:[o.isPending&&u.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px"},children:u.jsx(zi,{size:50,message:`Running ${s.num_simulations.toLocaleString()} simulations...`})}),o.error&&u.jsx("div",{style:{marginBottom:"2rem"},children:u.jsx(Di,{message:"Simulation Failed",details:Hf(o.error),onRetry:l})}),e&&!o.isPending&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"8px",padding:"1.5rem",marginBottom:"2rem"},children:[u.jsx("h3",{style:{margin:"0 0 1rem 0",color:"var(--color-text-primary)"},children:"Simulation Results"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Mean Final Equity"}),u.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"var(--color-primary)"},children:["$",e.mean_final_equity.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Median Final Equity"}),u.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"var(--color-primary)"},children:["$",e.median_final_equity.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Expected Return"}),u.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:e.mean_final_equity>e.parameters.starting_capital?"var(--color-success)":"var(--color-danger)"},children:[((e.mean_final_equity-e.parameters.starting_capital)/e.parameters.starting_capital*100).toFixed(1),"%"]})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Sharpe Ratio"}),u.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:e.risk_metrics.sharpe_ratio>1?"var(--color-success)":"var(--color-info)"},children:e.risk_metrics.sharpe_ratio.toFixed(2)})]})]}),u.jsxs("div",{style:{marginBottom:"2rem"},children:[u.jsx("h4",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"var(--color-text-secondary)",borderBottom:"2px solid var(--color-border)",paddingBottom:"0.5rem"},children:"📊 Probability Analysis"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem"},children:[u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-success-light, #f0f9f0)",borderRadius:"6px",border:"1px solid var(--color-success, #4caf50)"},children:[u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-success)"},children:"P(≥2× Return)"}),u.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--color-success)"},children:[(e.risk_metrics.prob_2x*100).toFixed(1),"%"]})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-success-light, #f0f9f0)",borderRadius:"6px",border:"1px solid var(--color-success, #4caf50)"},children:[u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-success)"},children:"P(≥3× Return)"}),u.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--color-success)"},children:[(e.risk_metrics.prob_3x*100).toFixed(1),"%"]})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-danger-light, #fff5f5)",borderRadius:"6px",border:"1px solid var(--color-danger, #f44336)"},children:[u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-danger)"},children:"P(Loss)"}),u.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--color-danger)"},children:[(e.risk_metrics.prob_loss*100).toFixed(1),"%"]})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-info-light, #f0f8ff)",borderRadius:"6px",border:"1px solid var(--color-info, #2196f3)"},children:[u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-info)"},children:"Win Rate"}),u.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--color-info)"},children:[(e.risk_metrics.win_rate*100).toFixed(1),"%"]})]})]})]}),u.jsxs("div",{style:{marginBottom:"2rem"},children:[u.jsx("h4",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"var(--color-text-secondary)",borderBottom:"2px solid var(--color-border)",paddingBottom:"0.5rem"},children:"⚠️ Risk Analysis"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"P95 Max Drawdown"}),u.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:e.risk_metrics.p95_max_drawdown>.2?"var(--color-danger)":"var(--color-warning, #ff9800)"},children:[(e.risk_metrics.p95_max_drawdown*100).toFixed(1),"%"]})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"VaR 95%"}),u.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"var(--color-danger)"},children:["$",Math.abs(e.risk_metrics.var_95).toLocaleString(void 0,{maximumFractionDigits:0})]})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"CVaR 95%"}),u.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"var(--color-danger)"},children:["$",Math.abs(e.risk_metrics.cvar_95).toLocaleString(void 0,{maximumFractionDigits:0})]})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Profit Factor"}),u.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:e.risk_metrics.profit_factor>1.5?"var(--color-success)":"var(--color-warning, #ff9800)"},children:e.risk_metrics.profit_factor.toFixed(2)})]})]})]}),u.jsxs("div",{style:{marginBottom:"2rem"},children:[u.jsx("h4",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"var(--color-text-secondary)",borderBottom:"2px solid var(--color-border)",paddingBottom:"0.5rem"},children:"🚀 Promotion Gates (Go-Live Readiness)"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",borderRadius:"4px",backgroundColor:e.risk_metrics.prob_2x>.4?"var(--color-success-light, #f0f9f0)":"var(--color-danger-light, #fff5f5)"},children:[u.jsx("span",{style:{fontSize:"1.2rem"},children:e.risk_metrics.prob_2x>.4?"✅":"❌"}),u.jsxs("span",{style:{fontSize:"0.9rem"},children:["Monte Carlo Gate: P(≥2×) > 40%",u.jsxs("strong",{children:["(",(e.risk_metrics.prob_2x*100).toFixed(1),"%)"]})]})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",borderRadius:"4px",backgroundColor:e.risk_metrics.p95_max_drawdown<.2?"var(--color-success-light, #f0f9f0)":"var(--color-danger-light, #fff5f5)"},children:[u.jsx("span",{style:{fontSize:"1.2rem"},children:e.risk_metrics.p95_max_drawdown<.2?"✅":"❌"}),u.jsxs("span",{style:{fontSize:"0.9rem"},children:["Drawdown Gate: P95 Max DD < 20%",u.jsxs("strong",{children:["(",(e.risk_metrics.p95_max_drawdown*100).toFixed(1),"%)"]})]})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",borderRadius:"4px",backgroundColor:"var(--color-warning-light, #fffbf0)"},children:[u.jsx("span",{style:{fontSize:"1.2rem"},children:"⏳"}),u.jsx("span",{style:{fontSize:"0.9rem",color:"var(--color-warning)"},children:"Calibration Gate: Requires live signal history (≥300 trades)"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",borderRadius:"4px",backgroundColor:"var(--color-warning-light, #fffbf0)"},children:[u.jsx("span",{style:{fontSize:"1.2rem"},children:"⏳"}),u.jsx("span",{style:{fontSize:"0.9rem",color:"var(--color-warning)"},children:"Expectancy Gate: Net expected R > +0.1R/trade (out-of-sample)"})]})]})]}),u.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.8rem",color:"var(--color-text-muted)"},children:["Completed in ",e.computation_time_ms.toFixed(0),"ms •",e.total_trades.toLocaleString()," total trades •",e.sample_equity_paths.length," sample paths"]})]}),u.jsx("div",{style:{marginBottom:"2rem"},children:u.jsx(Gl,{simulationResults:{equity_paths:e.sample_equity_paths.map(f=>f.map(g=>g.equity)),final_equity:e.final_equity_distribution,statistics:{mean_final_equity:e.mean_final_equity,median_final_equity:e.median_final_equity,p95_max_drawdown:e.risk_metrics.p95_max_drawdown,prob_2x:e.risk_metrics.prob_2x,prob_3x:e.risk_metrics.prob_3x,sharpe_ratio:e.risk_metrics.sharpe_ratio,profit_factor:e.risk_metrics.profit_factor},params:{weeks:e.parameters.weeks,trades_per_week:e.parameters.trades_per_week}},width:800,height:400,showPaths:Math.min(15,e.sample_equity_paths.length),showStatistics:!0})}),u.jsx("div",{children:u.jsx(Wf,{finalEquityData:e.final_equity_distribution,binCount:30,width:800,height:400,showStatistics:!0})})]}),!e&&!o.isPending&&!o.error&&u.jsxs("div",{style:{backgroundColor:"var(--color-surface)",border:"1px dashed var(--color-border)",borderRadius:"8px",padding:"3rem",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"🎯"}),u.jsx("h3",{style:{margin:"0 0 1rem 0",color:"var(--color-text-secondary)"},children:"Ready to Analyze"}),u.jsx("p",{style:{color:"var(--color-text-muted)",margin:0},children:'Adjust the parameters on the left and click "Run Simulation" to see how your trading strategy might perform.'})]})]})]})]})}function Kf(){const[s,t]=R.useState(0),[e,i]=R.useState(""),{data:n,isLoading:r,error:o,refetch:h}=Fs({queryKey:["opportunities-test",s,e],queryFn:()=>xi.getOpportunities({min_score:s>0?s:void 0,status:e||void 0,limit:10}),refetchInterval:1e4}),a=async()=>{try{const l=await xi.scanPreview({min_score:s>0?s:void 0,limit:5});console.log("Scan preview result:",l),alert(`Scan found ${l.total} opportunities matching criteria`)}catch(l){console.error("Scan preview failed:",l),alert("Scan preview failed - check console for details")}};return r?u.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[u.jsx(zi,{}),u.jsx("p",{children:"Loading opportunities with new API structure..."})]}):o?u.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:u.jsx(Di,{message:"Failed to load opportunities",onRetry:()=>h()})}):u.jsxs("div",{style:{padding:"2rem"},children:[u.jsxs("div",{style:{marginBottom:"2rem"},children:[u.jsx("h1",{style:{color:"var(--color-text-primary)",marginBottom:"1rem"},children:"🧪 API Integration Test"}),u.jsx("p",{style:{color:"var(--color-text-secondary)",marginBottom:"2rem"},children:"Testing the updated frontend integration with new API structure (0-10 score scale, new guardrail statuses)"}),u.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",marginBottom:"2rem",padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"minScore",style:{display:"block",marginBottom:"0.5rem",color:"var(--color-text-secondary)"},children:"Min Score (0-10):"}),u.jsx("input",{id:"minScore",type:"number",min:"0",max:"10",step:"0.1",value:s,onChange:l=>t(parseFloat(l.target.value)||0),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid var(--color-border)",backgroundColor:"var(--color-background)",color:"var(--color-text-primary)",width:"100px"}})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"statusFilter",style:{display:"block",marginBottom:"0.5rem",color:"var(--color-text-secondary)"},children:"Guardrail Status:"}),u.jsxs("select",{id:"statusFilter",value:e,onChange:l=>i(l.target.value),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid var(--color-border)",backgroundColor:"var(--color-background)",color:"var(--color-text-primary)",minWidth:"120px"},children:[u.jsx("option",{value:"",children:"All Statuses"}),u.jsx("option",{value:"approved",children:"Approved"}),u.jsx("option",{value:"review",children:"Review"}),u.jsx("option",{value:"blocked",children:"Blocked"})]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{onClick:()=>h(),style:{padding:"0.5rem 1rem",backgroundColor:"var(--color-primary)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"🔄 Refresh"}),u.jsx("button",{onClick:a,style:{padding:"0.5rem 1rem",backgroundColor:"var(--color-secondary)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"🔍 Test Scan"})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-secondary)"},children:"API Mode"}),u.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--color-info)"},children:"Mock Data ✅"}),u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-muted)"},children:"Using mock API with new structure"})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-secondary)"},children:"Total Found"}),u.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--color-success)"},children:(n==null?void 0:n.total)||0}),u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-muted)"},children:"Opportunities matching filters"})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-secondary)"},children:"Score Scale"}),u.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--color-warning)"},children:"0-10 ✅"}),u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-muted)"},children:"New scoring system active"})]}),u.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--color-text-secondary)"},children:"Guardrail System"}),u.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--color-primary)"},children:"A/R/B ✅"}),u.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-muted)"},children:"Approved/Review/Blocked"})]})]})]}),n&&n.opportunities.length>0?u.jsx(uo,{opportunities:n.opportunities}):u.jsxs("div",{style:{textAlign:"center",padding:"3rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-border)"},children:[u.jsx("h3",{style:{color:"var(--color-text-secondary)"},children:"No opportunities match current filters"}),u.jsx("p",{style:{color:"var(--color-text-muted)"},children:"Try adjusting the minimum score or status filter to see more results."})]}),u.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",backgroundColor:"var(--color-surface)",borderRadius:"8px",border:"1px solid var(--color-success)"},children:[u.jsx("h3",{style:{color:"var(--color-success)",margin:"0 0 1rem 0"},children:"✅ Task 4: Frontend Integration - COMPLETED"}),u.jsxs("ul",{style:{color:"var(--color-text-secondary)",margin:0},children:[u.jsx("li",{children:"✅ Updated TypeScript types to match new API structure (0-10 scoring scale)"}),u.jsx("li",{children:"✅ Updated guardrail status values (approved/review/blocked)"}),u.jsx("li",{children:"✅ Enhanced API service with new endpoints and parameters"}),u.jsx("li",{children:"✅ Updated OpportunityTable component for new data structure"}),u.jsx("li",{children:"✅ Fixed OpportunityDetail component for new guardrail statuses"}),u.jsx("li",{children:"✅ Created mock API service for development testing"}),u.jsx("li",{children:"✅ All TypeScript errors resolved"}),u.jsx("li",{children:"✅ Components render correctly with new data structure"})]})]})]})}const Gf=({children:s})=>{const t=jh(),e=i=>t.pathname===i;return u.jsxs("div",{className:"min-h-screen bg-gray-900",children:[u.jsx("header",{className:"bg-gray-800 border-b border-gray-700",children:u.jsx("div",{className:"container mx-auto px-4 py-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"🎯 Trading Opportunities"}),u.jsx("span",{className:"text-sm text-gray-400 bg-gray-700 px-2 py-1 rounded",children:"Alpha Scanner"})]}),u.jsxs("nav",{className:"flex space-x-6",children:[u.jsx(Wt,{to:"/",className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${e("/")?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"}`,children:"Dashboard"}),u.jsx(Wt,{to:"/opportunities",className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${e("/opportunities")?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"}`,children:"Opportunities"}),u.jsx(Wt,{to:"/risk-sandbox",className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${e("/risk-sandbox")?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"}`,children:"Risk Sandbox"}),u.jsx(Wt,{to:"/api-test",className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${e("/api-test")?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"}`,children:"🧪 API Test"})]})]})})}),u.jsx("main",{className:"container mx-auto px-4 py-8",children:s}),u.jsx("footer",{className:"bg-gray-800 border-t border-gray-700 mt-auto",children:u.jsx("div",{className:"container mx-auto px-4 py-6",children:u.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("span",{children:"© 2025 Trading Opportunities Platform"}),u.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse",title:"API Connected"}),u.jsx("span",{children:"API Connected"})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("span",{children:"Real-time market data"}),u.jsx("span",{className:"text-xs bg-gray-700 px-2 py-1 rounded",children:"v0.1.0"})]})]})})})]})};function Zf(){return u.jsx(Gf,{children:u.jsxs(Rh,{children:[u.jsx(Ve,{path:"/",element:u.jsx(Eh,{})}),u.jsx(Ve,{path:"/opportunity/:symbol",element:u.jsx(Lh,{})}),u.jsx(Ve,{path:"/risk-sandbox",element:u.jsx(Qf,{})}),u.jsx(Ve,{path:"/api-test",element:u.jsx(Kf,{})})]})})}const Jf=new kh({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:1,refetchOnWindowFocus:!1}}}),yh=document.getElementById("root");if(!yh)throw new Error("Root element not found");vs.createRoot(yh).render(u.jsx(Os.StrictMode,{children:u.jsx(Mh,{client:Jf,children:u.jsx(zh,{children:u.jsx(Zf,{})})})}));
//# sourceMappingURL=index-BNtI7ITx.js.map
